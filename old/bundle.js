!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){var t=e.hash.split("?");return t.length>1?l.parse(t[1]):{}}function o(e){0==e.hash.indexOf("#/register")?window.matrixChat.showScreen("register",r(e)):0==e.hash.indexOf("#/login/cas")?window.matrixChat.showScreen("cas_login",r(e)):window.matrixChat.showScreen(e.hash.substring(2))}function i(e){decodeURIComponent(window.location.hash)!=c&&o(window.location)}var s=n(1),a=n(3);a.loadSkin(n(128)),a.loadModule(n(40));var l=n(329),c=null,u=!1,p=null,d=function(e){if(u){var t="#/"+e;c=t,window.location.hash=t}else p=e},h=function(){return window.location.protocol+"//"+window.location.host+window.location.pathname+"#/register"},m=a.getComponent("pages.MatrixChat");window.matrixChat=s.render(s.createElement(m,{onNewScreen:d,registrationUrl:h()}),document.getElementById("matrixchat")),window.addEventListener("hashchange",i),window.onload=function(){o(window.location),u=!0,p&&(d(p),p=null)}},function(e,t,n){e.exports=n(262)},function(e,t,n){(function(t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){var e=Math.floor(16777215*Math.random()).toString(16);return e="W"+"000000".substring(e.length)+e,c&&(e=c.getItem("mx_device_id")||e,c.setItem("mx_device_id",e)),e}function i(e,t,n,r){var i={baseUrl:e,idBaseUrl:t,accessToken:r,userId:n};c&&(i.sessionStore=new a.WebStorageSessionStore(c),i.deviceId=o()),l=a.createClient(i)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(41),l=null,c=window.localStorage;if(c){var u=c.getItem("mx_hs_url"),p=c.getItem("mx_is_url")||"https://matrix.org",d=c.getItem("mx_access_token"),h=c.getItem("mx_user_id");d&&h&&u&&i(u,p,h,d)}var m=function(){function e(){r(this,e)}return s(e,[{key:"get",value:function(){return l}},{key:"unset",value:function(){l=null}},{key:"replaceUsingUrls",value:function(e,t){l=a.createClient({baseUrl:e,idBaseUrl:t})}},{key:"replaceUsingAccessToken",value:function(e,t,n,r){if(c)try{c.clear()}catch(o){console.warn("Error using local storage")}if(i(e,t,n,r),c)try{c.setItem("mx_hs_url",e),c.setItem("mx_is_url",t),c.setItem("mx_user_id",n),c.setItem("mx_access_token",r)}catch(o){console.warn("Error using local storage: can't persist session!")}else console.warn("No local storage available: can't persist session!")}}]),e}();t.mxMatrixClient||(t.mxMatrixClient=new m),e.exports=t.mxMatrixClient}).call(t,function(){return this}())},function(e,t,n){"use strict";var r=n(210),o=n(95);e.exports.loadSkin=function(e){r.load(e)},e.exports.loadModule=function(e){o.loadModule(e)},e.exports.resetSkin=function(){r.reset()},e.exports.getComponent=function(e){return r.getComponent(e)}},function(e,t,n){"use strict";var r=function(e,t,n,r,o,i,s,a){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,o,i,s,a],u=0;l=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return c[u++]}))}throw l.framesToPop=1,l}};e.exports=r},function(e,t,n){(function(t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var o=e,i=t,s=n;a=c=l=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;if(void 0===l)return;return l.call(s)}var c=Object.getPrototypeOf(o);if(null===c)return;e=c,t=i,n=s,r=!0}},a=n(192),l=function(e){function t(){r(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return o(t,e),i(t,[{key:"dispatch",value:function(e,n){n?s(Object.getPrototypeOf(t.prototype),"dispatch",this).call(this,e):setTimeout(s(Object.getPrototypeOf(t.prototype),"dispatch",this).bind(this,e),0)}}]),t}(a.Dispatcher);void 0===t.mxDispatcher&&(t.mxDispatcher=new l),e.exports=t.mxDispatcher}).call(t,function(){return this}())},function(e,t){"use strict";function n(e,t){if(null==e)throw new TypeError("Object.assign target cannot be null or undefined");for(var n=Object(e),r=Object.prototype.hasOwnProperty,o=1;o<arguments.length;o++){var i=arguments[o];if(null!=i){var s=Object(i);for(var a in s)r.call(s,a)&&(n[a]=s[a])}}return n}e.exports=n},function(e,t,n){"use strict";var r=n(68),o=n(18),i=n(6),s=(n(8),{key:!0,ref:!0}),a=function(e,t,n,r,o,i){this.type=e,this.key=t,this.ref=n,this._owner=r,this._context=o,this.props=i};a.prototype={_isReactElement:!0},a.createElement=function(e,t,n){var i,l={},c=null,u=null;if(null!=t){u=void 0===t.ref?null:t.ref,c=void 0===t.key?null:""+t.key;for(i in t)t.hasOwnProperty(i)&&!s.hasOwnProperty(i)&&(l[i]=t[i])}var p=arguments.length-2;if(1===p)l.children=n;else if(p>1){for(var d=Array(p),h=0;p>h;h++)d[h]=arguments[h+2];l.children=d}if(e&&e.defaultProps){var m=e.defaultProps;for(i in m)"undefined"==typeof l[i]&&(l[i]=m[i])}return new a(e,c,u,o.current,r.current,l)},a.createFactory=function(e){var t=a.createElement.bind(null,e);return t.type=e,t},a.cloneAndReplaceProps=function(e,t){var n=new a(e.type,e.key,e.ref,e._owner,e._context,t);return n},a.cloneElement=function(e,t,n){var r,l=i({},e.props),c=e.key,u=e.ref,p=e._owner;if(null!=t){void 0!==t.ref&&(u=t.ref,p=o.current),void 0!==t.key&&(c=""+t.key);for(r in t)t.hasOwnProperty(r)&&!s.hasOwnProperty(r)&&(l[r]=t[r])}var d=arguments.length-2;if(1===d)l.children=n;else if(d>1){for(var h=Array(d),m=0;d>m;m++)h[m]=arguments[m+2];l.children=h}return new a(e.type,c,u,p,e._context,l)},a.isValidElement=function(e){var t=!(!e||!e._isReactElement);return t},e.exports=a},function(e,t,n){"use strict";var r=n(21),o=r;e.exports=o},function(e,t){"use strict";var n=!("undefined"==typeof window||!window.document||!window.document.createElement),r={canUseDOM:n,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:n&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:n&&!!window.screen,isInWorker:!n};e.exports=r},function(e,t,n){var r,o,i;!function(s,a){o=[n(1),n(250)],r=a,i="function"==typeof r?r.apply(t,o):r,!(void 0!==i&&(e.exports=i))}(this,function(e,t){var n=e.createClass({displayName:"Loader",propTypes:{component:e.PropTypes.any,loaded:e.PropTypes.bool,options:e.PropTypes.object,scale:e.PropTypes.number,lines:e.PropTypes.number,length:e.PropTypes.number,width:e.PropTypes.number,radius:e.PropTypes.number,corners:e.PropTypes.number,rotate:e.PropTypes.number,direction:e.PropTypes.oneOf([1,-1]),color:e.PropTypes.string,speed:e.PropTypes.number,trail:e.PropTypes.number,shadow:e.PropTypes.bool,hwaccell:e.PropTypes.bool,className:e.PropTypes.string,zIndex:e.PropTypes.number,top:e.PropTypes.string,left:e.PropTypes.string},getDefaultProps:function(){return{component:"div"}},getInitialState:function(){return{loaded:!1,options:{}}},componentDidMount:function(){this.updateState(this.props)},componentWillReceiveProps:function(e){this.updateState(e)},updateState:function(e){e||(e={});var t=this.state.loaded,n=this.state.options;"loaded"in e&&(t=!!e.loaded);var r=Object.keys(this.constructor.propTypes);r.splice(r.indexOf("loaded"),1),r.splice(r.indexOf("options"),1);var o="options"in e?e.options:e;r.forEach(function(e){e in o&&(n[e]=o[e])}),this.setState({loaded:t,options:n},this.spin)},spin:function(){if(this.isMounted()&&!this.state.loaded){var e=new t(this.state.options),n=this.refs.loader.getDOMNode();n.innerHTML="",e.spin(n)}},render:function(){var t,n;return this.state.loaded?(t={key:"content",className:"loadedContent"},n=this.props.children):t={key:"loader",ref:"loader",className:"loader"},e.createElement(this.props.component,t,n)}});return n})},function(e,t){"use strict";e.exports.encodeParams=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t+="&"+encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.substring(1)},e.exports.encodeUri=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e=e.replace(n,encodeURIComponent(t[n])));return e},e.exports.map=function(e,t){for(var n=new Array(e.length),r=0;r<e.length;r++)n[r]=t(e[r]);return n},e.exports.filter=function(e,t){for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n},e.exports.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},e.exports.values=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},e.exports.forEach=function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)},e.exports.findElement=function(e,t,n){var r;if(n){for(r=e.length-1;r>=0;r--)if(t(e[r],r,e))return e[r]}else for(r=0;r<e.length;r++)if(t(e[r],r,e))return e[r]},e.exports.removeElement=function(e,t,n){var r;if(n){for(r=e.length-1;r>=0;r--)if(t(e[r],r,e))return e.splice(r,1),!0}else for(r=0;r<e.length;r++)if(t(e[r],r,e))return e.splice(r,1),!0;return!1},e.exports.isFunction=function(e){return"[object Function]"==Object.prototype.toString.call(e)},e.exports.isArray=function(e){return Boolean(e&&e.constructor===Array)},e.exports.checkObjectHasKeys=function(e,t){for(var n=0;n<t.length;n++)if(!e.hasOwnProperty(t[n]))throw new Error("Missing required key: "+t[n])},e.exports.checkObjectHasNoAdditionalKeys=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&-1===t.indexOf(n))throw new Error("Unknown key: "+n)},e.exports.deepCopy=function(e){return JSON.parse(JSON.stringify(e))},e.exports.runPolyfills=function(){Array.prototype.filter||(Array.prototype.filter=function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=[],o=arguments.length>=2?arguments[1]:void 0,i=0;n>i;i++)if(i in t){var s=t[i];e.call(o,s,i,t)&&r.push(s)}return r}),Array.prototype.map||(Array.prototype.map=function(e,t){var n,r,o;if(null===this||void 0===this)throw new TypeError(" this is null or not defined");var i=Object(this),s=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),r=new Array(s),o=0;s>o;){var a,l;o in i&&(a=i[o],l=e.call(n,a,o,i),r[o]=l),o++}return r})},e.exports.inherits=function(e,t){"function"!=typeof Object.create&&(Object.create=function(){function e(){}var t=Object.prototype.hasOwnProperty;return function(n){if("object"!=typeof n)throw new TypeError("Object prototype may only be an Object or null");e.prototype=n;var r=new e;if(e.prototype=null,arguments.length>1){var o=Object(arguments[1]);for(var i in o)t.call(o,i)&&(r[i]=o[i])}return r}}()),e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}},function(e,t,n){"use strict";var r=n(39),o=r({bubbled:null,captured:null}),i=r({topBlur:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topReset:null,topScroll:null,topSelectionChange:null,topSubmit:null,topTextInput:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topWheel:null}),s={topLevelTypes:i,PropagationPhases:o};e.exports=s},function(e,t,n){"use strict";function r(e,t){var n=w.hasOwnProperty(t)?w[t]:null;T.hasOwnProperty(t)&&y(n===C.OVERRIDE_BASE),e.hasOwnProperty(t)&&y(n===C.DEFINE_MANY||n===C.DEFINE_MANY_MERGED)}function o(e,t){if(t){y("function"!=typeof t),y(!d.isValidElement(t));var n=e.prototype;t.hasOwnProperty(b)&&S.mixins(e,t.mixins);for(var o in t)if(t.hasOwnProperty(o)&&o!==b){var i=t[o];if(r(n,o),S.hasOwnProperty(o))S[o](e,i);else{var s=w.hasOwnProperty(o),c=n.hasOwnProperty(o),u=i&&i.__reactDontBind,p="function"==typeof i,h=p&&!s&&!c&&!u;if(h)n.__reactAutoBindMap||(n.__reactAutoBindMap={}),n.__reactAutoBindMap[o]=i,n[o]=i;else if(c){var m=w[o];y(s&&(m===C.DEFINE_MANY_MERGED||m===C.DEFINE_MANY)),m===C.DEFINE_MANY_MERGED?n[o]=a(n[o],i):m===C.DEFINE_MANY&&(n[o]=l(n[o],i))}else n[o]=i}}}}function i(e,t){if(t)for(var n in t){var r=t[n];if(t.hasOwnProperty(n)){var o=n in S;y(!o);var i=n in e;y(!i),e[n]=r}}}function s(e,t){y(e&&t&&"object"==typeof e&&"object"==typeof t);for(var n in t)t.hasOwnProperty(n)&&(y(void 0===e[n]),e[n]=t[n]);return e}function a(e,t){return function(){var n=e.apply(this,arguments),r=t.apply(this,arguments);if(null==n)return r;if(null==r)return n;var o={};return s(o,n),s(o,r),o}}function l(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function c(e,t){var n=t.bind(e);return n}function u(e){for(var t in e.__reactAutoBindMap)if(e.__reactAutoBindMap.hasOwnProperty(t)){var n=e.__reactAutoBindMap[t];e[t]=c(e,h.guard(n,e.constructor.displayName+"."+t))}}var p=n(101),d=(n(18),n(7)),h=n(278),m=n(30),f=n(71),g=(n(72),n(47),n(73)),v=n(6),y=n(4),_=n(39),E=n(22),b=(n(8),E({mixins:null})),C=_({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),x=[],w={mixins:C.DEFINE_MANY,statics:C.DEFINE_MANY,propTypes:C.DEFINE_MANY,contextTypes:C.DEFINE_MANY,childContextTypes:C.DEFINE_MANY,getDefaultProps:C.DEFINE_MANY_MERGED,getInitialState:C.DEFINE_MANY_MERGED,getChildContext:C.DEFINE_MANY_MERGED,render:C.DEFINE_ONCE,componentWillMount:C.DEFINE_MANY,componentDidMount:C.DEFINE_MANY,componentWillReceiveProps:C.DEFINE_MANY,shouldComponentUpdate:C.DEFINE_ONCE,componentWillUpdate:C.DEFINE_MANY,componentDidUpdate:C.DEFINE_MANY,componentWillUnmount:C.DEFINE_MANY,updateComponent:C.OVERRIDE_BASE},S={displayName:function(e,t){e.displayName=t},mixins:function(e,t){if(t)for(var n=0;n<t.length;n++)o(e,t[n])},childContextTypes:function(e,t){e.childContextTypes=v({},e.childContextTypes,t)},contextTypes:function(e,t){e.contextTypes=v({},e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps?e.getDefaultProps=a(e.getDefaultProps,t):e.getDefaultProps=t},propTypes:function(e,t){e.propTypes=v({},e.propTypes,t)},statics:function(e,t){i(e,t)}},T={replaceState:function(e,t){g.enqueueReplaceState(this,e),t&&g.enqueueCallback(this,t)},isMounted:function(){var e=m.get(this);return e&&e!==f.currentlyMountingInstance},setProps:function(e,t){g.enqueueSetProps(this,e),t&&g.enqueueCallback(this,t)},replaceProps:function(e,t){g.enqueueReplaceProps(this,e),t&&g.enqueueCallback(this,t)}},R=function(){};v(R.prototype,p.prototype,T);var I={createClass:function(e){var t=function(e,t){this.__reactAutoBindMap&&u(this),this.props=e,this.context=t,this.state=null;var n=this.getInitialState?this.getInitialState():null;y("object"==typeof n&&!Array.isArray(n)),this.state=n};t.prototype=new R,t.prototype.constructor=t,x.forEach(o.bind(null,t)),o(t,e),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),y(t.prototype.render);for(var n in w)t.prototype[n]||(t.prototype[n]=null);return t.type=t,t},injection:{injectMixin:function(e){x.push(e)}}};e.exports=I},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(1);e.exports={DialogContainerId:"mx_Dialog_Container",getOrCreateContainer:function(){var e=document.getElementById(this.DialogContainerId);return e||(e=document.createElement("div"),e.id=this.DialogContainerId,document.body.appendChild(e)),e},createDialogWithElement:function(e,t){var n=this,r=function(){o.unmountComponentAtNode(n.getOrCreateContainer()),t&&t.onFinished&&t.onFinished.apply(null,arguments)},i=o.createElement("div",{className:"mx_Dialog_wrapper"},o.createElement("div",{className:"mx_Dialog"},e),o.createElement("div",{className:"mx_Dialog_background",onClick:r}));return o.render(i,this.getOrCreateContainer()),{close:r}},createDialog:function(e,t){var n=this,i=function(){o.unmountComponentAtNode(n.getOrCreateContainer()),t&&t.onFinished&&t.onFinished.apply(null,arguments)},s=o.createElement("div",{className:"mx_Dialog_wrapper"},o.createElement("div",{className:"mx_Dialog"},o.createElement(e,r({},t,{onFinished:i}))),o.createElement("div",{className:"mx_Dialog_background",onClick:i}));return o.render(s,this.getOrCreateContainer()),{close:i}}}},function(e,t,n){"use strict";function r(){g(T.ReactReconcileTransaction&&E)}function o(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=u.getPooled(),this.reconcileTransaction=T.ReactReconcileTransaction.getPooled()}function i(e,t,n,o,i){r(),E.batchedUpdates(e,t,n,o,i)}function s(e,t){return e._mountOrder-t._mountOrder}function a(e){var t=e.dirtyComponentsLength;g(t===v.length),v.sort(s);for(var n=0;t>n;n++){var r=v[n],o=r._pendingCallbacks;if(r._pendingCallbacks=null,h.performUpdateIfNecessary(r,e.reconcileTransaction),o)for(var i=0;i<o.length;i++)e.callbackQueue.enqueue(o[i],r.getPublicInstance())}}function l(e){return r(),E.isBatchingUpdates?void v.push(e):void E.batchedUpdates(l,e)}function c(e,t){g(E.isBatchingUpdates),y.enqueue(e,t),_=!0}var u=n(62),p=n(16),d=(n(18),n(24)),h=n(31),m=n(49),f=n(6),g=n(4),v=(n(8),[]),y=u.getPooled(),_=!1,E=null,b={initialize:function(){this.dirtyComponentsLength=v.length},close:function(){this.dirtyComponentsLength!==v.length?(v.splice(0,this.dirtyComponentsLength),w()):v.length=0}},C={initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}},x=[b,C];f(o.prototype,m.Mixin,{getTransactionWrappers:function(){return x},destructor:function(){this.dirtyComponentsLength=null,u.release(this.callbackQueue),this.callbackQueue=null,T.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null},perform:function(e,t,n){return m.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,e,t,n)}}),p.addPoolingTo(o);var w=function(){for(;v.length||_;){if(v.length){var e=o.getPooled();e.perform(a,null,e),o.release(e)}if(_){_=!1;var t=y;y=u.getPooled(),t.notifyAll(),u.release(t)}}};w=d.measure("ReactUpdates","flushBatchedUpdates",w);var S={injectReconcileTransaction:function(e){g(e),T.ReactReconcileTransaction=e},injectBatchingStrategy:function(e){g(e),g("function"==typeof e.batchedUpdates),g("boolean"==typeof e.isBatchingUpdates),E=e}},T={ReactReconcileTransaction:null,batchedUpdates:i,enqueueUpdate:l,flushBatchedUpdates:w,injection:S,asap:c};e.exports=T},function(e,t,n){"use strict";var r=n(4),o=function(e){var t=this;if(t.instancePool.length){var n=t.instancePool.pop();return t.call(n,e),n}return new t(e)},i=function(e,t){var n=this;if(n.instancePool.length){var r=n.instancePool.pop();return n.call(r,e,t),r}return new n(e,t)},s=function(e,t,n){var r=this;if(r.instancePool.length){var o=r.instancePool.pop();return r.call(o,e,t,n),o}return new r(e,t,n)},a=function(e,t,n,r,o){var i=this;if(i.instancePool.length){var s=i.instancePool.pop();return i.call(s,e,t,n,r,o),s}return new i(e,t,n,r,o)},l=function(e){var t=this;r(e instanceof t),e.destructor&&e.destructor(),t.instancePool.length<t.poolSize&&t.instancePool.push(e)},c=10,u=o,p=function(e,t){var n=e;return n.instancePool=[],n.getPooled=t||u,n.poolSize||(n.poolSize=c),n.release=l,n},d={addPoolingTo:p,oneArgumentPooler:o,twoArgumentPooler:i,threeArgumentPooler:s,fiveArgumentPooler:a};e.exports=d},function(e,t,n){"use strict";var r=n(112),o={getDOMNode:function(){return r(this)}};e.exports=o},function(e,t){"use strict";var n={current:null};e.exports=n},function(e,t,n){"use strict";function r(e,t){for(var n=Math.min(e.length,t.length),r=0;n>r;r++)if(e.charAt(r)!==t.charAt(r))return r;return e.length===t.length?-1:n}function o(e){var t=k(e);return t&&W.getID(t)}function i(e){var t=s(e);if(t)if(O.hasOwnProperty(t)){var n=O[t];n!==e&&(N(!u(n,t)),O[t]=e)}else O[t]=e;return t}function s(e){return e&&e.getAttribute&&e.getAttribute(U)||""}function a(e,t){var n=s(e);n!==t&&delete O[n],e.setAttribute(U,t),O[t]=e}function l(e){return O.hasOwnProperty(e)&&u(O[e],e)||(O[e]=W.findReactNodeByID(e)),O[e]}function c(e){var t=b.get(e)._rootNodeID;return _.isNullComponentID(t)?null:(O.hasOwnProperty(t)&&u(O[t],t)||(O[t]=W.findReactNodeByID(t)),O[t])}function u(e,t){if(e){N(s(e)===t);var n=W.findReactContainerForID(t);if(n&&I(n,e))return!0}return!1}function p(e){delete O[e]}function d(e){var t=O[e];return t&&u(t,e)?void(H=t):!1}function h(e){H=null,E.traverseAncestors(e,d);var t=H;return H=null,t}function m(e,t,n,r,o){var i=w.mountComponent(e,t,r,R);e._isTopLevel=!0,W._mountImageIntoNode(i,n,o)}function f(e,t,n,r){var o=T.ReactReconcileTransaction.getPooled();o.perform(m,null,e,t,n,o,r),T.ReactReconcileTransaction.release(o)}var g=n(27),v=n(28),y=(n(18),n(7)),_=(n(37),n(70)),E=n(29),b=n(30),C=n(105),x=n(24),w=n(31),S=n(73),T=n(15),R=n(50),I=n(111),k=n(310),M=n(79),N=n(4),D=n(81),A=n(82),P=(n(8),E.SEPARATOR),U=g.ID_ATTRIBUTE_NAME,O={},L=1,F=9,B={},V={},j=[],H=null,W={_instancesByReactRootID:B,scrollMonitor:function(e,t){t()},_updateRootComponent:function(e,t,n,r){return W.scrollMonitor(n,function(){S.enqueueElementInternal(e,t),r&&S.enqueueCallbackInternal(e,r)}),e},_registerComponent:function(e,t){N(t&&(t.nodeType===L||t.nodeType===F)),v.ensureScrollValueMonitoring();var n=W.registerContainer(t);return B[n]=e,n},_renderNewRootComponent:function(e,t,n){var r=M(e,null),o=W._registerComponent(r,t);return T.batchedUpdates(f,r,o,t,n),r},render:function(e,t,n){N(y.isValidElement(e));var r=B[o(t)];if(r){var i=r._currentElement;if(A(i,e))return W._updateRootComponent(r,e,t,n).getPublicInstance();W.unmountComponentAtNode(t)}var s=k(t),a=s&&W.isRenderedByReact(s),l=a&&!r,c=W._renderNewRootComponent(e,t,l).getPublicInstance();return n&&n.call(c),c},constructAndRenderComponent:function(e,t,n){var r=y.createElement(e,t);return W.render(r,n)},constructAndRenderComponentByID:function(e,t,n){var r=document.getElementById(n);return N(r),W.constructAndRenderComponent(e,t,r)},registerContainer:function(e){var t=o(e);return t&&(t=E.getReactRootIDFromNodeID(t)),t||(t=E.createReactRootID()),V[t]=e,t},unmountComponentAtNode:function(e){N(e&&(e.nodeType===L||e.nodeType===F));var t=o(e),n=B[t];return n?(W.unmountComponentFromNode(n,e),delete B[t],delete V[t],!0):!1},unmountComponentFromNode:function(e,t){for(w.unmountComponent(e),t.nodeType===F&&(t=t.documentElement);t.lastChild;)t.removeChild(t.lastChild)},findReactContainerForID:function(e){var t=E.getReactRootIDFromNodeID(e),n=V[t];return n},findReactNodeByID:function(e){var t=W.findReactContainerForID(e);return W.findComponentRoot(t,e)},isRenderedByReact:function(e){if(1!==e.nodeType)return!1;var t=W.getID(e);return t?t.charAt(0)===P:!1},getFirstReactDOM:function(e){for(var t=e;t&&t.parentNode!==t;){if(W.isRenderedByReact(t))return t;t=t.parentNode}return null},findComponentRoot:function(e,t){var n=j,r=0,o=h(t)||e;for(n[0]=o.firstChild,n.length=1;r<n.length;){for(var i,s=n[r++];s;){var a=W.getID(s);a?t===a?i=s:E.isAncestorIDOf(a,t)&&(n.length=r=0,n.push(s.firstChild)):n.push(s.firstChild),s=s.nextSibling}if(i)return n.length=0,i}n.length=0,N(!1)},_mountImageIntoNode:function(e,t,n){if(N(t&&(t.nodeType===L||t.nodeType===F)),n){var o=k(t);if(C.canReuseMarkup(e,o))return;var i=o.getAttribute(C.CHECKSUM_ATTR_NAME);o.removeAttribute(C.CHECKSUM_ATTR_NAME);var s=o.outerHTML;o.setAttribute(C.CHECKSUM_ATTR_NAME,i);var a=r(e,s);" (client) "+e.substring(a-20,a+20)+"\n (server) "+s.substring(a-20,a+20);N(t.nodeType!==F)}N(t.nodeType!==F),D(t,e)},getReactRootID:o,getID:i,setID:a,getNode:l,getNodeFromInstance:c,purgeID:p};x.measureMethods(W,"ReactMount",{_renderNewRootComponent:"_renderNewRootComponent",_mountImageIntoNode:"_mountImageIntoNode"}),e.exports=W},function(e,t,n){(function(t,n){/*!
	 *
	 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
	 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
	 *
	 * With parts by Tyler Close
	 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
	 * at http://www.opensource.org/licenses/mit-license.html
	 * Forked at ref_send.js version: 2009-05-11
	 *
	 * With parts by Mark Miller
	 * Copyright (C) 2011 Google Inc.
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software
	 * distributed under the License is distributed on an "AS IS" BASIS,
	 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	 * See the License for the specific language governing permissions and
	 * limitations under the License.
	 *
	 */
!function(t){"use strict";if("function"==typeof bootstrap)bootstrap("promise",t);else{e.exports=t()}}(function(){"use strict";function e(e){return function(){return Q.apply(e,arguments)}}function r(e){return e===Object(e)}function o(e){return"[object StopIteration]"===oe(e)||e instanceof z}function i(e,t){if(W&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(ie)){for(var n=[],r=t;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(e.stack);var o=n.join("\n"+ie+"\n");e.stack=s(o)}}function s(e){for(var t=e.split("\n"),n=[],r=0;r<t.length;++r){var o=t[r];c(o)||a(o)||!o||n.push(o)}return n.join("\n")}function a(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function l(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);return r?[r[1],Number(r[2])]:void 0}function c(e){var t=l(e);if(!t)return!1;var n=t[0],r=t[1];return n===K&&r>=$&&ue>=r}function u(){if(W)try{throw new Error}catch(e){var t=e.stack.split("\n"),n=t[0].indexOf("@")>0?t[1]:t[2],r=l(n);if(!r)return;return K=r[0],r[1]}}function p(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",new Error("").stack),e.apply(e,arguments)}}function d(e){return e instanceof g?e:E(e)?k(e):I(e)}function h(){function e(e){t=e,i.source=e,X(n,function(t,n){d.nextTick(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,r=void 0}var t,n=[],r=[],o=te(h.prototype),i=te(g.prototype);if(i.promiseDispatch=function(e,o,i){var s=J(arguments);n?(n.push(s),"when"===o&&i[1]&&r.push(i[1])):d.nextTick(function(){t.promiseDispatch.apply(t,s)})},i.valueOf=function(){if(n)return i;var e=y(t);return _(e)&&(t=e),e},i.inspect=function(){return t?t.inspect():{state:"pending"}},d.longStackSupport&&W)try{throw new Error}catch(s){i.stack=s.stack.substring(s.stack.indexOf("\n")+1)}return o.promise=i,o.resolve=function(n){t||e(d(n))},o.fulfill=function(n){t||e(I(n))},o.reject=function(n){t||e(R(n))},o.notify=function(e){t||X(r,function(t,n){d.nextTick(function(){n(e)})},void 0)},o}function m(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=h();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function f(e){return m(function(t,n){for(var r=0,o=e.length;o>r;r++)d(e[r]).then(t,n)})}function g(e,t,n){void 0===t&&(t=function(e){return R(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=te(g.prototype);if(r.promiseDispatch=function(n,o,i){var s;try{s=e[o]?e[o].apply(r,i):t.call(r,o,i)}catch(a){s=R(a)}n&&n(s)},r.inspect=n,n){var o=n();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?r:e.value}}return r}function v(e,t,n,r){return d(e).then(t,n,r)}function y(e){if(_(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function _(e){return e instanceof g}function E(e){return r(e)&&"function"==typeof e.then}function b(e){return _(e)&&"pending"===e.inspect().state}function C(e){return!_(e)||"fulfilled"===e.inspect().state}function x(e){return _(e)&&"rejected"===e.inspect().state}function w(){se.length=0,ae.length=0,ce||(ce=!0)}function S(e,n){ce&&("object"==typeof t&&"function"==typeof t.emit&&d.nextTick.runAfter(function(){-1!==Z(ae,e)&&(t.emit("unhandledRejection",n,e),le.push(e))}),ae.push(e),n&&"undefined"!=typeof n.stack?se.push(n.stack):se.push("(no stack) "+n))}function T(e){if(ce){var n=Z(ae,e);-1!==n&&("object"==typeof t&&"function"==typeof t.emit&&d.nextTick.runAfter(function(){var r=Z(le,e);-1!==r&&(t.emit("rejectionHandled",se[n],e),le.splice(r,1))}),ae.splice(n,1),se.splice(n,1))}}function R(e){var t=g({when:function(t){return t&&T(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return S(t,e),t}function I(e){return g({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return re(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function k(e){var t=h();return d.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function M(e){return g({isDef:function(){}},function(t,n){return O(e,t,n)},function(){return d(e).inspect()})}function N(e,t,n){return d(e).spread(t,n)}function D(e){return function(){function t(e,t){var s;if("undefined"==typeof StopIteration){try{s=n[e](t)}catch(a){return R(a)}return s.done?d(s.value):v(s.value,r,i)}try{s=n[e](t)}catch(a){return o(a)?d(a.value):R(a)}return v(s,r,i)}var n=e.apply(this,arguments),r=t.bind(t,"next"),i=t.bind(t,"throw");return r()}}function A(e){d.done(d.async(e)())}function P(e){throw new z(e)}function U(e){return function(){return N([this,L(arguments)],function(t,n){return e.apply(t,n)})}}function O(e,t,n){return d(e).dispatch(t,n)}function L(e){return v(e,function(e){var t=0,n=h();return X(e,function(r,o,i){var s;_(o)&&"fulfilled"===(s=o.inspect()).state?e[i]=s.value:(++t,v(o,function(r){e[i]=r,0===--t&&n.resolve(e)},n.reject,function(e){n.notify({index:i,value:e})}))},void 0),0===t&&n.resolve(e),n.promise})}function F(e){if(0===e.length)return d.resolve();var t=d.defer(),n=0;return X(e,function(r,o,i){function s(e){t.resolve(e)}function a(){n--,0===n&&t.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function l(e){t.notify({index:i,value:e})}var c=e[i];n++,v(c,s,a,l)},void 0),t.promise}function B(e){return v(e,function(e){return e=ee(e,d),v(L(ee(e,function(e){return v(e,Y,Y)})),function(){return e})})}function V(e){return d(e).allSettled()}function j(e,t){return d(e).then(void 0,void 0,t)}function H(e,t){return d(e).nodeify(t)}var W=!1;try{throw new Error}catch(q){W=!!q.stack}var K,z,$=u(),Y=function(){},G=function(){function e(){for(var e,t;o.next;)o=o.next,e=o.task,o.task=void 0,t=o.domain,t&&(o.domain=void 0,t.enter()),r(e,t);for(;c.length;)e=c.pop(),r(e);s=!1}function r(t,n){try{t()}catch(r){if(l)throw n&&n.exit(),setTimeout(e,0),n&&n.enter(),r;setTimeout(function(){throw r},0)}n&&n.exit()}var o={task:void 0,next:null},i=o,s=!1,a=void 0,l=!1,c=[];if(G=function(e){i=i.next={task:e,domain:l&&t.domain,next:null},s||(s=!0,a())},"object"==typeof t&&"[object process]"===t.toString()&&t.nextTick)l=!0,a=function(){t.nextTick(e)};else if("function"==typeof n)a="undefined"!=typeof window?n.bind(window,e):function(){n(e)};else if("undefined"!=typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=function(){a=p,u.port1.onmessage=e,e()};var p=function(){u.port2.postMessage(0)};a=function(){setTimeout(e,0),p()}}else a=function(){setTimeout(e,0)};return G.runAfter=function(e){c.push(e),s||(s=!0,a())},G}(),Q=Function.call,J=e(Array.prototype.slice),X=e(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}for(;r>n;n++)n in this&&(t=e(t,this[n],n));return t}),Z=e(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),ee=e(Array.prototype.map||function(e,t){var n=this,r=[];return X(n,function(o,i,s){r.push(e.call(t,i,s,n))},void 0),r}),te=Object.create||function(e){function t(){}return t.prototype=e,new t},ne=e(Object.prototype.hasOwnProperty),re=Object.keys||function(e){var t=[];for(var n in e)ne(e,n)&&t.push(n);return t},oe=e(Object.prototype.toString);z="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var ie="From previous event:";d.resolve=d,d.nextTick=G,d.longStackSupport=!1,"object"==typeof t&&t&&{NODE_ENV:"production"}.Q_DEBUG&&(d.longStackSupport=!0),d.defer=h,h.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(J(arguments,1)):e.resolve(n)}},d.Promise=m,d.promise=m,m.race=f,m.all=L,m.reject=R,m.resolve=d,d.passByCopy=function(e){return e},g.prototype.passByCopy=function(){return this},d.join=function(e,t){return d(e).join(t)},g.prototype.join=function(e){return d([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)})},d.race=f,g.prototype.race=function(){return this.then(d.race)},d.makePromise=g,g.prototype.toString=function(){return"[object Promise]"},g.prototype.then=function(e,t,n){function r(t){try{return"function"==typeof e?e(t):t}catch(n){return R(n)}}function o(e){if("function"==typeof t){i(e,a);try{return t(e)}catch(n){return R(n)}}return R(e)}function s(e){return"function"==typeof n?n(e):e}var a=this,l=h(),c=!1;return d.nextTick(function(){a.promiseDispatch(function(e){c||(c=!0,l.resolve(r(e)))},"when",[function(e){c||(c=!0,l.resolve(o(e)))}])}),a.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=s(e)}catch(r){if(n=!0,!d.onerror)throw r;d.onerror(r)}n||l.notify(t)}]),l.promise},d.tap=function(e,t){return d(e).tap(t)},g.prototype.tap=function(e){return e=d(e),this.then(function(t){return e.fcall(t).thenResolve(t)})},d.when=v,g.prototype.thenResolve=function(e){return this.then(function(){return e})},d.thenResolve=function(e,t){return d(e).thenResolve(t)},g.prototype.thenReject=function(e){return this.then(function(){throw e})},d.thenReject=function(e,t){return d(e).thenReject(t)},d.nearer=y,d.isPromise=_,d.isPromiseAlike=E,d.isPending=b,g.prototype.isPending=function(){return"pending"===this.inspect().state},d.isFulfilled=C,g.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},d.isRejected=x,g.prototype.isRejected=function(){return"rejected"===this.inspect().state};var se=[],ae=[],le=[],ce=!0;d.resetUnhandledRejections=w,d.getUnhandledReasons=function(){return se.slice()},d.stopUnhandledRejectionTracking=function(){w(),ce=!1},w(),d.reject=R,d.fulfill=I,d.master=M,d.spread=N,g.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},d.async=D,d.spawn=A,d["return"]=P,d.promised=U,d.dispatch=O,g.prototype.dispatch=function(e,t){var n=this,r=h();return d.nextTick(function(){n.promiseDispatch(r.resolve,e,t)}),r.promise},d.get=function(e,t){return d(e).dispatch("get",[t])},g.prototype.get=function(e){return this.dispatch("get",[e])},d.set=function(e,t,n){return d(e).dispatch("set",[t,n])},g.prototype.set=function(e,t){return this.dispatch("set",[e,t])},d.del=d["delete"]=function(e,t){return d(e).dispatch("delete",[t])},g.prototype.del=g.prototype["delete"]=function(e){return this.dispatch("delete",[e])},d.mapply=d.post=function(e,t,n){return d(e).dispatch("post",[t,n])},g.prototype.mapply=g.prototype.post=function(e,t){return this.dispatch("post",[e,t])},d.send=d.mcall=d.invoke=function(e,t){return d(e).dispatch("post",[t,J(arguments,2)])},g.prototype.send=g.prototype.mcall=g.prototype.invoke=function(e){return this.dispatch("post",[e,J(arguments,1)])},d.fapply=function(e,t){return d(e).dispatch("apply",[void 0,t])},g.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},d["try"]=d.fcall=function(e){return d(e).dispatch("apply",[void 0,J(arguments,1)])},g.prototype.fcall=function(){return this.dispatch("apply",[void 0,J(arguments)])},d.fbind=function(e){var t=d(e),n=J(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(J(arguments))])}},g.prototype.fbind=function(){var e=this,t=J(arguments);return function(){return e.dispatch("apply",[this,t.concat(J(arguments))])}},d.keys=function(e){return d(e).dispatch("keys",[])},g.prototype.keys=function(){return this.dispatch("keys",[])},d.all=L,g.prototype.all=function(){return L(this)},d.any=F,g.prototype.any=function(){return F(this)},d.allResolved=p(B,"allResolved","allSettled"),g.prototype.allResolved=function(){return B(this)},d.allSettled=V,g.prototype.allSettled=function(){return this.then(function(e){return L(ee(e,function(e){function t(){return e.inspect()}return e=d(e),e.then(t,t)}))})},d.fail=d["catch"]=function(e,t){return d(e).then(void 0,t)},g.prototype.fail=g.prototype["catch"]=function(e){return this.then(void 0,e)},d.progress=j,g.prototype.progress=function(e){return this.then(void 0,void 0,e)},d.fin=d["finally"]=function(e,t){return d(e)["finally"](t)},g.prototype.fin=g.prototype["finally"]=function(e){return e=d(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},d.done=function(e,t,n,r){return d(e).done(t,n,r)},g.prototype.done=function(e,n,r){var o=function(e){d.nextTick(function(){if(i(e,s),!d.onerror)throw e;d.onerror(e)})},s=e||n||r?this.then(e,n,r):this;"object"==typeof t&&t&&t.domain&&(o=t.domain.bind(o)),s.then(void 0,o)},d.timeout=function(e,t,n){return d(e).timeout(t,n)},g.prototype.timeout=function(e,t){var n=h(),r=setTimeout(function(){t&&"string"!=typeof t||(t=new Error(t||"Timed out after "+e+" ms"),t.code="ETIMEDOUT"),n.reject(t)},e);return this.then(function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)},n.notify),n.promise},d.delay=function(e,t){return void 0===t&&(t=e,e=void 0),d(e).delay(t)},g.prototype.delay=function(e){return this.then(function(t){var n=h();return setTimeout(function(){n.resolve(t)},e),n.promise})},d.nfapply=function(e,t){return d(e).nfapply(t)},g.prototype.nfapply=function(e){var t=h(),n=J(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},d.nfcall=function(e){var t=J(arguments,1);return d(e).nfapply(t)},g.prototype.nfcall=function(){var e=J(arguments),t=h();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},d.nfbind=d.denodeify=function(e){var t=J(arguments,1);return function(){var n=t.concat(J(arguments)),r=h();return n.push(r.makeNodeResolver()),d(e).fapply(n).fail(r.reject),r.promise}},g.prototype.nfbind=g.prototype.denodeify=function(){var e=J(arguments);return e.unshift(this),d.denodeify.apply(void 0,e)},d.nbind=function(e,t){var n=J(arguments,2);return function(){function r(){return e.apply(t,arguments)}var o=n.concat(J(arguments)),i=h();return o.push(i.makeNodeResolver()),d(r).fapply(o).fail(i.reject),i.promise}},g.prototype.nbind=function(){var e=J(arguments,0);return e.unshift(this),d.nbind.apply(void 0,e)},d.nmapply=d.npost=function(e,t,n){return d(e).npost(t,n)},g.prototype.nmapply=g.prototype.npost=function(e,t){var n=J(t||[]),r=h();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},d.nsend=d.nmcall=d.ninvoke=function(e,t){var n=J(arguments,2),r=h();return n.push(r.makeNodeResolver()),d(e).dispatch("post",[t,n]).fail(r.reject),r.promise},g.prototype.nsend=g.prototype.nmcall=g.prototype.ninvoke=function(e){var t=J(arguments,1),n=h();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},d.nodeify=H,g.prototype.nodeify=function(e){return e?void this.then(function(t){d.nextTick(function(){e(null,t)})},function(t){d.nextTick(function(){e(t)})}):this},d.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var ue=u();return d})}).call(t,n(122),n(83).setImmediate)},function(e,t){function n(e){return function(){return e}}function r(){}r.thatReturns=n,r.thatReturnsFalse=n(!1),r.thatReturnsTrue=n(!0),r.thatReturnsNull=n(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(e){return e},e.exports=r},function(e,t){var n=function(e){var t;for(t in e)if(e.hasOwnProperty(t))return t;return null};e.exports=n},function(e,t,n){(function(t){"use strict";function r(e){var t=document.getElementById(e);t&&(t.load(),t.play())}function o(e){var t=document.getElementById(e);t&&t.pause()}function i(e){e.on("error",function(t){console.error("Call error: %s",t),console.error(t.stack),e.hangup(),s(void 0,e.roomId,"ended")}),e.on("hangup",function(){s(void 0,e.roomId,"ended")}),e.on("state",function(t,n){if("ringing"===t)s(e,e.roomId,"ringing"),o("ringbackAudio");else if("invite_sent"===t)s(e,e.roomId,"ringback"),r("ringbackAudio");else if("ended"===t&&"connected"===n)s(void 0,e.roomId,"ended"),o("ringbackAudio"),r("callendAudio");else if("ended"===t&&"invite_sent"===n&&("remote"===e.hangupParty||"local"===e.hangupParty&&"invite_timeout"===e.hangupReason)){s(e,e.roomId,"busy"),o("ringbackAudio"),r("busyAudio");var i=u.getComponent("organisms.ErrorDialog");c.createDialog(i,{title:"Call Timeout",description:"The remote side failed to pick up."})}else"invite_sent"===n?(s(e,e.roomId,"stop_ringback"),o("ringbackAudio")):"ringing"===n?(s(e,e.roomId,"stop_ringing"),o("ringbackAudio")):"connected"===t&&(s(e,e.roomId,"connected"),o("ringbackAudio"))})}function s(e,t,n){console.log("Call state in %s changed to %s (%s)",t,n,e?e.state:"-"),m[t]=e,e&&(e.call_state=n),d.dispatch({action:"call_state",room_id:t})}function a(t){function n(e){i(e),s(e,e.roomId,"ringback"),"voice"===t.type?e.placeVoiceCall():"video"===t.type?e.placeVideoCall(t.remote_element,t.local_element):"screensharing"===t.type?e.placeScreenSharingCall(t.remote_element,t.local_element):console.error("Unknown conf call type: %s",t.type)}switch(t.action){case"place_call":if(e.exports.getAnyActiveCall()){var r=u.getComponent("organisms.ErrorDialog");return void c.createDialog(r,{title:"Existing Call",description:"You are already in a call."})}var o=l.get().getRoom(t.room_id);if(!o)return void console.error("Room %s does not exist.",t.room_id);var a=o.getJoinedMembers();if(a.length<=1){var r=u.getComponent("organisms.ErrorDialog");return void c.createDialog(r,{description:"You cannot place a call with yourself."})}if(2===a.length){console.log("Place %s call in %s",t.type,t.room_id);var f=p.createNewMatrixCall(l.get(),t.room_id);n(f)}else d.dispatch({action:"place_conference_call",room_id:t.room_id,type:t.type,remote_element:t.remote_element,local_element:t.local_element});break;case"place_conference_call":if(console.log("Place conference call in %s",t.room_id),h.hasConferenceHandler()){var g=h.getConferenceHandler();g.createNewMatrixCall(l.get(),t.room_id).done(function(e){n(e)},function(e){console.error("Failed to setup conference call: %s",e)})}else{var r=u.getComponent("organisms.ErrorDialog");c.createDialog(r,{description:"Conference calls are not supported in this client"})}break;case"incoming_call":if(e.exports.getAnyActiveCall())return void t.call.hangup("busy");var f=t.call;i(f),s(f,f.roomId,"ringing");break;case"hangup":if(!m[t.room_id])return;m[t.room_id].hangup(),s(null,t.room_id,"ended");break;case"answer":if(!m[t.room_id])return;m[t.room_id].answer(),s(m[t.room_id],t.room_id,"connected"),d.dispatch({action:"view_room",room_id:t.room_id})}}var l=n(2),c=n(14),u=n(3),p=n(41),d=n(5),h=n(95);t.mxCalls={};var m=t.mxCalls;t.mxCallHandler||d.register(a);var f={getCallForRoom:function(t){var n=e.exports.getCall(t);if(n)return n;if(h.hasConferenceHandler()){var r=h.getConferenceHandler();n=r.getConferenceCallForRoom(t)}return n?n:null},getCall:function(e){return m[e]||null},getAnyActiveCall:function(){for(var e=Object.keys(m),t=0;t<e.length;t++)if(m[e[t]]&&"ended"!==m[e[t]].call_state)return m[e[t]];return null}};void 0===t.mxCallHandler&&(t.mxCallHandler=f),e.exports=t.mxCallHandler}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e,t,n){return n}var o={enableMeasure:!1,storedMeasure:r,measureMethods:function(e,t,n){},measure:function(e,t,n){return n},injection:{injectMeasure:function(e){o.storedMeasure=e}}};e.exports=o},function(e,t,n){"use strict";function r(e,t,n){this.dispatchConfig=e,this.dispatchMarker=t,this.nativeEvent=n;var r=this.constructor.Interface;for(var o in r)if(r.hasOwnProperty(o)){var i=r[o];i?this[o]=i(n):this[o]=n[o]}var a=null!=n.defaultPrevented?n.defaultPrevented:n.returnValue===!1;a?this.isDefaultPrevented=s.thatReturnsTrue:this.isDefaultPrevented=s.thatReturnsFalse,this.isPropagationStopped=s.thatReturnsFalse}var o=n(16),i=n(6),s=n(21),a=n(78),l={type:null,target:a,currentTarget:s.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};i(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e.preventDefault?e.preventDefault():e.returnValue=!1,this.isDefaultPrevented=s.thatReturnsTrue},stopPropagation:function(){var e=this.nativeEvent;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.isPropagationStopped=s.thatReturnsTrue},persist:function(){this.isPersistent=s.thatReturnsTrue},isPersistent:s.thatReturnsFalse,destructor:function(){var e=this.constructor.Interface;for(var t in e)this[t]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),r.Interface=l,r.augmentClass=function(e,t){var n=this,r=Object.create(n.prototype);i(r,e.prototype),e.prototype=r,e.prototype.constructor=e,e.Interface=i({},n.Interface,t),e.augmentClass=n.augmentClass,o.addPoolingTo(e,o.threeArgumentPooler)},o.addPoolingTo(r,o.threeArgumentPooler),e.exports=r},function(e,t){"use strict";e.exports.EventStatus={NOT_SENT:"not_sent",SENDING:"sending",QUEUED:"queued"},e.exports.MatrixEvent=function(e,t){this.event=e||{},this.sender=null,this.target=null,this.status=null,this.forwardLooking=!0,this.encrypted=Boolean(t)},e.exports.MatrixEvent.prototype={getId:function(){return this.event.event_id},getSender:function(){return this.event.user_id},getType:function(){return this.event.type},getWireType:function(){return this.encryptedType||this.event.type},getRoomId:function(){return this.event.room_id},getTs:function(){return this.event.origin_server_ts},getContent:function(){return this.event.content||{}},getWireContent:function(){return this.encryptedContent||this.event.content||{}},getPrevContent:function(){return this.event.prev_content||{}},getDirectionalContent:function(){return this.forwardLooking?this.getContent():this.getPrevContent()},getAge:function(){return this.event.age},getStateKey:function(){return this.event.state_key},isState:function(){return void 0!==this.event.state_key},isEncrypted:function(){return this.encrypted}}},function(e,t,n){"use strict";function r(e,t){return(e&t)===t}var o=n(4),i={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_NUMERIC_VALUE:16,HAS_POSITIVE_NUMERIC_VALUE:48,HAS_OVERLOADED_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(e){var t=e.Properties||{},n=e.DOMAttributeNames||{},s=e.DOMPropertyNames||{},l=e.DOMMutationMethods||{};e.isCustomAttribute&&a._isCustomAttributeFunctions.push(e.isCustomAttribute);for(var c in t){o(!a.isStandardName.hasOwnProperty(c)),a.isStandardName[c]=!0;var u=c.toLowerCase();if(a.getPossibleStandardName[u]=c,n.hasOwnProperty(c)){var p=n[c];a.getPossibleStandardName[p]=c,a.getAttributeName[c]=p}else a.getAttributeName[c]=u;a.getPropertyName[c]=s.hasOwnProperty(c)?s[c]:c,l.hasOwnProperty(c)?a.getMutationMethod[c]=l[c]:a.getMutationMethod[c]=null;var d=t[c];a.mustUseAttribute[c]=r(d,i.MUST_USE_ATTRIBUTE),a.mustUseProperty[c]=r(d,i.MUST_USE_PROPERTY),a.hasSideEffects[c]=r(d,i.HAS_SIDE_EFFECTS),a.hasBooleanValue[c]=r(d,i.HAS_BOOLEAN_VALUE),a.hasNumericValue[c]=r(d,i.HAS_NUMERIC_VALUE),a.hasPositiveNumericValue[c]=r(d,i.HAS_POSITIVE_NUMERIC_VALUE),a.hasOverloadedBooleanValue[c]=r(d,i.HAS_OVERLOADED_BOOLEAN_VALUE),o(!a.mustUseAttribute[c]||!a.mustUseProperty[c]),o(a.mustUseProperty[c]||!a.hasSideEffects[c]),o(!!a.hasBooleanValue[c]+!!a.hasNumericValue[c]+!!a.hasOverloadedBooleanValue[c]<=1)}}},s={},a={ID_ATTRIBUTE_NAME:"data-reactid",isStandardName:{},getPossibleStandardName:{},getAttributeName:{},getPropertyName:{},getMutationMethod:{},mustUseAttribute:{},mustUseProperty:{},hasSideEffects:{},hasBooleanValue:{},hasNumericValue:{},hasPositiveNumericValue:{},hasOverloadedBooleanValue:{},_isCustomAttributeFunctions:[],isCustomAttribute:function(e){for(var t=0;t<a._isCustomAttributeFunctions.length;t++){var n=a._isCustomAttributeFunctions[t];if(n(e))return!0}return!1},getDefaultValueForProperty:function(e,t){var n,r=s[e];return r||(s[e]=r={}),t in r||(n=document.createElement(e),r[t]=n[t]),r[t]},injection:i};e.exports=a},function(e,t,n){"use strict";function r(e){return Object.prototype.hasOwnProperty.call(e,f)||(e[f]=h++,p[e[f]]={}),p[e[f]]}var o=n(12),i=n(35),s=n(100),a=n(279),l=n(110),c=n(6),u=n(80),p={},d=!1,h=0,m={topBlur:"blur",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTextInput:"textInput",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topWheel:"wheel"},f="_reactListenersID"+String(Math.random()).slice(2),g=c({},a,{ReactEventListener:null,injection:{injectReactEventListener:function(e){e.setHandleTopLevel(g.handleTopLevel),g.ReactEventListener=e}},setEnabled:function(e){g.ReactEventListener&&g.ReactEventListener.setEnabled(e)},isEnabled:function(){return!(!g.ReactEventListener||!g.ReactEventListener.isEnabled())},listenTo:function(e,t){for(var n=t,i=r(n),a=s.registrationNameDependencies[e],l=o.topLevelTypes,c=0,p=a.length;p>c;c++){var d=a[c];i.hasOwnProperty(d)&&i[d]||(d===l.topWheel?u("wheel")?g.ReactEventListener.trapBubbledEvent(l.topWheel,"wheel",n):u("mousewheel")?g.ReactEventListener.trapBubbledEvent(l.topWheel,"mousewheel",n):g.ReactEventListener.trapBubbledEvent(l.topWheel,"DOMMouseScroll",n):d===l.topScroll?u("scroll",!0)?g.ReactEventListener.trapCapturedEvent(l.topScroll,"scroll",n):g.ReactEventListener.trapBubbledEvent(l.topScroll,"scroll",g.ReactEventListener.WINDOW_HANDLE):d===l.topFocus||d===l.topBlur?(u("focus",!0)?(g.ReactEventListener.trapCapturedEvent(l.topFocus,"focus",n),g.ReactEventListener.trapCapturedEvent(l.topBlur,"blur",n)):u("focusin")&&(g.ReactEventListener.trapBubbledEvent(l.topFocus,"focusin",n),g.ReactEventListener.trapBubbledEvent(l.topBlur,"focusout",n)),i[l.topBlur]=!0,i[l.topFocus]=!0):m.hasOwnProperty(d)&&g.ReactEventListener.trapBubbledEvent(d,m[d],n),i[d]=!0)}},trapBubbledEvent:function(e,t,n){return g.ReactEventListener.trapBubbledEvent(e,t,n)},trapCapturedEvent:function(e,t,n){return g.ReactEventListener.trapCapturedEvent(e,t,n)},ensureScrollValueMonitoring:function(){if(!d){var e=l.refreshScrollValues;g.ReactEventListener.monitorScrollValue(e),d=!0}},eventNameDispatchConfigs:i.eventNameDispatchConfigs,registrationNameModules:i.registrationNameModules,putListener:i.putListener,getListener:i.getListener,deleteListener:i.deleteListener,deleteAllListeners:i.deleteAllListeners});e.exports=g},function(e,t,n){"use strict";function r(e){return h+e.toString(36)}function o(e,t){return e.charAt(t)===h||t===e.length}function i(e){return""===e||e.charAt(0)===h&&e.charAt(e.length-1)!==h}function s(e,t){return 0===t.indexOf(e)&&o(t,e.length)}function a(e){return e?e.substr(0,e.lastIndexOf(h)):""}function l(e,t){if(d(i(e)&&i(t)),d(s(e,t)),e===t)return e;var n,r=e.length+m;for(n=r;n<t.length&&!o(t,n);n++);return t.substr(0,n)}function c(e,t){var n=Math.min(e.length,t.length);if(0===n)return"";for(var r=0,s=0;n>=s;s++)if(o(e,s)&&o(t,s))r=s;else if(e.charAt(s)!==t.charAt(s))break;var a=e.substr(0,r);return d(i(a)),a}function u(e,t,n,r,o,i){e=e||"",t=t||"",d(e!==t);var c=s(t,e);d(c||s(e,t));for(var u=0,p=c?a:l,h=e;;h=p(h,t)){var m;if(o&&h===e||i&&h===t||(m=n(h,c,r)),m===!1||h===t)break;d(u++<f)}}var p=n(109),d=n(4),h=".",m=h.length,f=100,g={createReactRootID:function(){return r(p.createReactRootIndex())},createReactID:function(e,t){return e+t},getReactRootIDFromNodeID:function(e){if(e&&e.charAt(0)===h&&e.length>1){var t=e.indexOf(h,1);return t>-1?e.substr(0,t):e}return null},traverseEnterLeave:function(e,t,n,r,o){var i=c(e,t);i!==e&&u(e,i,n,r,!1,!0),i!==t&&u(i,t,n,o,!0,!1)},traverseTwoPhase:function(e,t,n){e&&(u("",e,t,n,!0,!1),u(e,"",t,n,!1,!0))},traverseAncestors:function(e,t,n){u("",e,t,n,!0,!1)},_getFirstCommonAncestorID:c,_getNextDescendantID:l,isAncestorIDOf:s,SEPARATOR:h};e.exports=g},function(e,t){"use strict";var n={remove:function(e){e._reactInternalInstance=void 0},get:function(e){return e._reactInternalInstance},has:function(e){return void 0!==e._reactInternalInstance},set:function(e,t){e._reactInternalInstance=t}};e.exports=n},function(e,t,n){"use strict";function r(){o.attachRefs(this,this._currentElement)}var o=n(285),i=(n(37),{mountComponent:function(e,t,n,o){var i=e.mountComponent(t,n,o);return n.getReactMountReady().enqueue(r,e),i},unmountComponent:function(e){o.detachRefs(e,e._currentElement),e.unmountComponent()},receiveComponent:function(e,t,n,i){var s=e._currentElement;if(t!==s||null==t._owner){var a=o.shouldUpdateRefs(s,t);a&&o.detachRefs(e,s),e.receiveComponent(t,n,i),a&&n.getReactMountReady().enqueue(r,e)}},performUpdateIfNecessary:function(e,t){e.performUpdateIfNecessary(t)}});e.exports=i},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,a,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(i(n))for(a=Array.prototype.slice.call(arguments,1),c=n.slice(),o=c.length,l=0;o>l;l++)c[l].apply(this,a);return!0},n.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(o=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,o,s,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){
o=a;break}if(0>o)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){var r,o;/*!
	  Copyright (c) 2015 Jed Watson.
	  Licensed under the MIT License (MIT), see
	  http://jedwatson.github.io/classnames
	*/
!function(){"use strict";function n(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e+=" "+r;else if(Array.isArray(r))e+=" "+n.apply(null,r);else if("object"===o)for(var s in r)i.call(r,s)&&r[s]&&(e+=" "+s)}}return e.substr(1)}var i={}.hasOwnProperty;"undefined"!=typeof e&&e.exports?e.exports=n:(r=[],o=function(){return n}.apply(t,r),!(void 0!==o&&(e.exports=o)))}()},function(e,t,n){"use strict";function r(e,t){return null==t||o.hasBooleanValue[e]&&!t||o.hasNumericValue[e]&&isNaN(t)||o.hasPositiveNumericValue[e]&&1>t||o.hasOverloadedBooleanValue[e]&&t===!1}var o=n(27),i=n(318),s=(n(8),{createMarkupForID:function(e){return o.ID_ATTRIBUTE_NAME+"="+i(e)},createMarkupForProperty:function(e,t){if(o.isStandardName.hasOwnProperty(e)&&o.isStandardName[e]){if(r(e,t))return"";var n=o.getAttributeName[e];return o.hasBooleanValue[e]||o.hasOverloadedBooleanValue[e]&&t===!0?n:n+"="+i(t)}return o.isCustomAttribute(e)?null==t?"":e+"="+i(t):null},setValueForProperty:function(e,t,n){if(o.isStandardName.hasOwnProperty(t)&&o.isStandardName[t]){var i=o.getMutationMethod[t];if(i)i(e,n);else if(r(t,n))this.deleteValueForProperty(e,t);else if(o.mustUseAttribute[t])e.setAttribute(o.getAttributeName[t],""+n);else{var s=o.getPropertyName[t];o.hasSideEffects[t]&&""+e[s]==""+n||(e[s]=n)}}else o.isCustomAttribute(t)&&(null==n?e.removeAttribute(t):e.setAttribute(t,""+n))},deleteValueForProperty:function(e,t){if(o.isStandardName.hasOwnProperty(t)&&o.isStandardName[t]){var n=o.getMutationMethod[t];if(n)n(e,void 0);else if(o.mustUseAttribute[t])e.removeAttribute(o.getAttributeName[t]);else{var r=o.getPropertyName[t],i=o.getDefaultValueForProperty(e.nodeName,r);o.hasSideEffects[t]&&""+e[r]===i||(e[r]=i)}}else o.isCustomAttribute(t)&&e.removeAttribute(t)}});e.exports=s},function(e,t,n){"use strict";var r=n(100),o=n(63),i=n(74),s=n(75),a=n(4),l={},c=null,u=function(e){if(e){var t=o.executeDispatch,n=r.getPluginModuleForEvent(e);n&&n.executeDispatch&&(t=n.executeDispatch),o.executeDispatchesInOrder(e,t),e.isPersistent()||e.constructor.release(e)}},p=null,d={injection:{injectMount:o.injection.injectMount,injectInstanceHandle:function(e){p=e},getInstanceHandle:function(){return p},injectEventPluginOrder:r.injectEventPluginOrder,injectEventPluginsByName:r.injectEventPluginsByName},eventNameDispatchConfigs:r.eventNameDispatchConfigs,registrationNameModules:r.registrationNameModules,putListener:function(e,t,n){a(!n||"function"==typeof n);var r=l[t]||(l[t]={});r[e]=n},getListener:function(e,t){var n=l[t];return n&&n[e]},deleteListener:function(e,t){var n=l[t];n&&delete n[e]},deleteAllListeners:function(e){for(var t in l)delete l[t][e]},extractEvents:function(e,t,n,o){for(var s,a=r.plugins,l=0,c=a.length;c>l;l++){var u=a[l];if(u){var p=u.extractEvents(e,t,n,o);p&&(s=i(s,p))}}return s},enqueueEvents:function(e){e&&(c=i(c,e))},processEventQueue:function(){var e=c;c=null,s(e,u),a(!c)},__purge:function(){l={}},__getListenerBank:function(){return l}};e.exports=d},function(e,t,n){"use strict";function r(e,t,n){var r=t.dispatchConfig.phasedRegistrationNames[n];return g(e,r)}function o(e,t,n){var o=t?f.bubbled:f.captured,i=r(e,n,o);i&&(n._dispatchListeners=h(n._dispatchListeners,i),n._dispatchIDs=h(n._dispatchIDs,e))}function i(e){e&&e.dispatchConfig.phasedRegistrationNames&&d.injection.getInstanceHandle().traverseTwoPhase(e.dispatchMarker,o,e)}function s(e,t,n){if(n&&n.dispatchConfig.registrationName){var r=n.dispatchConfig.registrationName,o=g(e,r);o&&(n._dispatchListeners=h(n._dispatchListeners,o),n._dispatchIDs=h(n._dispatchIDs,e))}}function a(e){e&&e.dispatchConfig.registrationName&&s(e.dispatchMarker,null,e)}function l(e){m(e,i)}function c(e,t,n,r){d.injection.getInstanceHandle().traverseEnterLeave(n,r,s,e,t)}function u(e){m(e,a)}var p=n(12),d=n(35),h=n(74),m=n(75),f=p.PropagationPhases,g=d.getListener,v={accumulateTwoPhaseDispatches:l,accumulateDirectDispatches:u,accumulateEnterLeaveDispatches:c};e.exports=v},function(e,t,n){"use strict";function r(){if(y.current){var e=y.current.getName();if(e)return" Check the render method of `"+e+"`."}return""}function o(e){var t=e&&e.getPublicInstance();if(t){var n=t.constructor;if(n)return n.displayName||n.name||void 0}}function i(){var e=y.current;return e&&o(e)||void 0}function s(e,t){e._store.validated||null!=e.key||(e._store.validated=!0,l('Each child in an array or iterator should have a unique "key" prop.',e,t))}function a(e,t,n){w.test(e)&&l("Child objects should have non-numeric keys so ordering is preserved.",t,n)}function l(e,t,n){var r=i(),s="string"==typeof n?n:n.displayName||n.name,a=r||s,l=C[e]||(C[e]={});if(!l.hasOwnProperty(a)){l[a]=!0;var c="";if(t&&t._owner&&t._owner!==y.current){var u=o(t._owner);c=" It was passed a child from "+u+"."}}}function c(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++){var r=e[n];f.isValidElement(r)&&s(r,t)}else if(f.isValidElement(e))e._store.validated=!0;else if(e){var o=E(e);if(o){if(o!==e.entries)for(var i,l=o.call(e);!(i=l.next()).done;)f.isValidElement(i.value)&&s(i.value,t)}else if("object"==typeof e){var c=g.extractIfFragment(e);for(var u in c)c.hasOwnProperty(u)&&a(u,c[u],t)}}}function u(e,t,n,o){for(var i in t)if(t.hasOwnProperty(i)){var s;try{b("function"==typeof t[i]),s=t[i](n,i,e,o)}catch(a){s=a}if(s instanceof Error&&!(s.message in x)){x[s.message]=!0;r(this)}}}function p(e,t){var n=t.type,r="string"==typeof n?n:n.displayName,o=t._owner?t._owner.getPublicInstance().constructor.displayName:null,i=e+"|"+r+"|"+o;if(!S.hasOwnProperty(i)){S[i]=!0;var s="";r&&(s=" <"+r+" />");var a="";o&&(a=" The element was created by "+o+".")}}function d(e,t){return e!==e?t!==t:0===e&&0===t?1/e===1/t:e===t}function h(e){if(e._store){var t=e._store.originalProps,n=e.props;for(var r in n)n.hasOwnProperty(r)&&(t.hasOwnProperty(r)&&d(t[r],n[r])||(p(r,e),t[r]=n[r]))}}function m(e){if(null!=e.type){var t=_.getComponentClassForElement(e),n=t.displayName||t.name;t.propTypes&&u(n,t.propTypes,e.props,v.prop),"function"==typeof t.getDefaultProps}}var f=n(7),g=n(45),v=n(72),y=(n(47),n(18)),_=n(46),E=n(115),b=n(4),C=(n(8),{}),x={},w=/^\d+$/,S={},T={checkAndWarnForMutatedProps:h,createElement:function(e,t,n){var r=f.createElement.apply(this,arguments);if(null==r)return r;for(var o=2;o<arguments.length;o++)c(arguments[o],e);return m(r),r},createFactory:function(e){var t=T.createElement.bind(null,e);return t.type=e,t},cloneElement:function(e,t,n){for(var r=f.cloneElement.apply(this,arguments),o=2;o<arguments.length;o++)c(arguments[o],r.type);return m(r),r}};e.exports=T},function(e,t,n){"use strict";function r(e,t,n){o.call(this,e,t,n)}var o=n(25),i=n(78),s={view:function(e){if(e.view)return e.view;var t=i(e);if(null!=t&&t.window===t)return t;var n=t.ownerDocument;return n?n.defaultView||n.parentWindow:window},detail:function(e){return e.detail||0}};o.augmentClass(r,s),e.exports=r},function(e,t,n){"use strict";var r=n(4),o=function(e){var t,n={};r(e instanceof Object&&!Array.isArray(e));for(t in e)e.hasOwnProperty(t)&&(n[t]=t);return n};e.exports=o},function(e,t,n){(function(t){"use strict";function r(t,n){this.client=t,this.groupRoomId=n,this.confUserId=e.exports.getConferenceUserIdForRoom(this.groupRoomId)}var o=n(20),i=n(41),s=i.Room,a=n(23),l="fs_",c="matrix.org";r.prototype.setup=function(){var e=this;return this._joinConferenceUser().then(function(){return e._getConferenceUserRoom()}).then(function(t){var n=i.createNewMatrixCall(e.client,t.roomId);return n.confUserId=e.confUserId,n})},r.prototype._joinConferenceUser=function(){var e=this.client.getRoom(this.groupRoomId);if(!e)return o.reject("Bad group room ID");var t=e.getMember(this.confUserId);return t&&"join"===t.membership?o():this.client.invite(this.groupRoomId,this.confUserId)},r.prototype._getConferenceUserRoom=function(){for(var e=this.client.getRooms(),t=null,n=0;n<e.length;n++){var r=e[n].getMember(this.confUserId);if(r&&"join"===r.membership&&2===e[n].getJoinedMembers().length){t=e[n];break}}return t?o(t):this.client.createRoom({preset:"private_chat",invite:[this.confUserId]}).then(function(e){return new s(e.room_id)})},e.exports.isConferenceUser=function(e){if(0!==e.userId.indexOf("@"+l))return!1;var n=e.userId.split(":")[0].substring(1+l.length);if(n){var r=new t(n,"base64").toString();return/^!.+:.+/.test(r)}return!1},e.exports.getConferenceUserIdForRoom=function(e){var n=new t(e).toString("base64").replace(/=/g,"");return"@"+l+n+":"+c},e.exports.createNewMatrixCall=function(e,t){var n=new r(e,t);return n.setup()},e.exports.getConferenceCallForRoom=function(t){var n=a.getAnyActiveCall();if(n&&n.confUserId){var r=e.exports.getConferenceUserIdForRoom(t);if(r===n.confUserId)return n}return null},e.exports.ConferenceCall=r,e.exports.slot="conference"}).call(t,n(121).Buffer)},function(e,t,n){(function(t){var r=n(199);r.request(n(207)),e.exports=r,t.matrixcs=r}).call(t,function(){return this}())},function(e,t,n){var r=n(11);e.exports={getHttpUriForMxc:function(e,t,n,o,i){if("string"!=typeof t||!t)return t;if(0!==t.indexOf("mxc://"))return t;var s=t.slice(6),a="/_matrix/media/v1/download/",l={};n&&(l.width=n),o&&(l.height=o),i&&(l.method=i),r.keys(l).length>0&&(a="/_matrix/media/v1/thumbnail/");var c=s.indexOf("#"),u="";return c>=0&&(u=s.substr(c),s=s.substr(0,c)),e+a+s+(0===r.keys(l).length?"":"?"+r.encodeParams(l))+u},getIdenticonUri:function(e,t,n,o){if(!t)return null;n||(n=96),o||(o=96);var i={width:n,height:o},s=r.encodeUri("/_matrix/media/v1/identicon/$ident",{$ident:t});return e+s+(0===r.keys(i).length?"":"?"+r.encodeParams(i))}}},function(e,t){"use strict";function n(e){var t=e.scanner.TOKENS,n=e.parser.TOKENS,r=n.Base,o=e.parser.start,i=function(e){r.call(this,e),this.type="roomalias",this.isLink=!0};i.prototype=new r;var s=new e.parser.State,a=new e.parser.State,l=new e.parser.State,c=new e.parser.State,u=new e.parser.State,p=new e.parser.State(i),d=[t.DOT,t.PLUS,t.NUM,t.DOMAIN,t.TLD];o.on(t.POUND,s),s.on(d,a),a.on(d,a),a.on(t.DOMAIN,a),a.on(t.COLON,l),l.on(t.DOMAIN,c),c.on(t.DOT,u),u.on(t.DOMAIN,c),u.on(t.TLD,p);var h=function(e){r.call(this,e),this.type="userid",this.isLink=!0};h.prototype=new r;var m=new e.parser.State,f=new e.parser.State,g=new e.parser.State,v=new e.parser.State,y=new e.parser.State,_=new e.parser.State(h),E=[t.DOT,t.PLUS,t.NUM,t.DOMAIN,t.TLD];o.on(t.AT,m),m.on(E,f),f.on(E,f),f.on(t.DOMAIN,f),f.on(t.COLON,g),g.on(t.DOMAIN,v),v.on(t.DOT,y),y.on(t.DOMAIN,v),y.on(t.TLD,_)}n.onUserClick=function(e,t){e.preventDefault()},n.onAliasClick=function(e,t){e.preventDefault()},n.options={events:function(e,t){switch(t){case"userid":return{click:function(t){n.onUserClick(t,e)}};case"roomalias":return{click:function(t){n.onAliasClick(t,e)}}}}},e.exports=n},function(e,t,n){"use strict";var r=n(113),o={componentDidMount:function(){this.props.autoFocus&&r(this.getDOMNode())}};e.exports=o},function(e,t,n){"use strict";var r=(n(7),n(8),{create:function(e){return e},extract:function(e){return e},extractIfFragment:function(e){return e}});e.exports=r},function(e,t,n){"use strict";function r(e){if("function"==typeof e.type)return e.type;var t=e.type,n=p[t];return null==n&&(p[t]=n=c(t)),n}function o(e){return l(u),new u(e.type,e.props)}function i(e){return new d(e)}function s(e){return e instanceof d}var a=n(6),l=n(4),c=null,u=null,p={},d=null,h={injectGenericComponentClass:function(e){u=e},injectTextComponentClass:function(e){d=e},injectComponentClasses:function(e){a(p,e)},injectAutoWrapper:function(e){c=e}},m={getComponentClassForElement:r,createInternalComponent:o,createInstanceForText:i,isTextComponent:s,injection:h};e.exports=m},function(e,t,n){"use strict";var r={};e.exports=r},function(e,t,n){"use strict";function r(e,t,n){o.call(this,e,t,n)}var o=n(38),i=n(110),s=n(77),a={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:s,button:function(e){var t=e.button;return"which"in e?t:2===t?2:4===t?1:0},buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},pageX:function(e){return"pageX"in e?e.pageX:e.clientX+i.currentScrollLeft},pageY:function(e){return"pageY"in e?e.pageY:e.clientY+i.currentScrollTop}};o.augmentClass(r,a),e.exports=r},function(e,t,n){"use strict";var r=n(4),o={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(e,t,n,o,i,s,a,l){r(!this.isInTransaction());var c,u;try{this._isInTransaction=!0,c=!0,this.initializeAll(0),u=e.call(t,n,o,i,s,a,l),c=!1}finally{try{if(c)try{this.closeAll(0)}catch(p){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return u},initializeAll:function(e){for(var t=this.transactionWrappers,n=e;n<t.length;n++){var r=t[n];try{this.wrapperInitData[n]=i.OBSERVED_ERROR,this.wrapperInitData[n]=r.initialize?r.initialize.call(this):null}finally{if(this.wrapperInitData[n]===i.OBSERVED_ERROR)try{this.initializeAll(n+1)}catch(o){}}}},closeAll:function(e){r(this.isInTransaction());for(var t=this.transactionWrappers,n=e;n<t.length;n++){var o,s=t[n],a=this.wrapperInitData[n];try{o=!0,a!==i.OBSERVED_ERROR&&s.close&&s.close.call(this,a),o=!1}finally{if(o)try{this.closeAll(n+1)}catch(l){}}}this.wrapperInitData.length=0}},i={Mixin:o,OBSERVED_ERROR:{}};e.exports=i},function(e,t,n){"use strict";var r={};e.exports=r},function(e,t){"use strict";function n(e){return o[e]}function r(e){return(""+e).replace(i,n)}var o={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},i=/[&><"']/g;e.exports=r},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(1);e.exports={ContextualMenuContainerId:"mx_ContextualMenu_Container",getOrCreateContainer:function(){var e=document.getElementById(this.ContextualMenuContainerId);return e||(e=document.createElement("div"),e.id=this.ContextualMenuContainerId,document.body.appendChild(e)),e},createMenu:function(e,t){var n=this,i=function(){o.unmountComponentAtNode(n.getOrCreateContainer()),t&&t.onFinished&&t.onFinished.apply(null,arguments)},s={top:t.top-20},a=null;t.left?(a=o.createElement("img",{className:"mx_ContextualMenu_chevron_left",src:"img/chevron-left.png",width:"9",height:"16"}),s.left=t.left+8):(a=o.createElement("img",{className:"mx_ContextualMenu_chevron_right",src:"img/chevron-right.png",width:"9",height:"16"}),s.right=t.right+8);var l="mx_ContextualMenu_wrapper",c=o.createElement("div",{className:l},o.createElement("div",{className:"mx_ContextualMenu",style:s},a,o.createElement(e,r({},t,{onFinished:i}))),o.createElement("div",{className:"mx_ContextualMenu_background",onClick:i}));return o.render(c,this.getOrCreateContainer()),{close:i}}}},function(e,t,n){(function(t){/**
	 * filesize
	 *
	 * @author Jason Mulligan <jason.mulligan@avoidwork.com>
	 * @copyright 2015 Jason Mulligan <jason.mulligan@avoidwork.com>
	 * @license BSD-3-Clause
	 * @link http://filesizejs.com
	 * @module filesize
	 * @version 3.1.4
	 */
"use strict";!function(t){var n=/b$/,r={bits:["B","kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","kB","MB","GB","TB","PB","EB","ZB","YB"]},o=function(e){var t=void 0===arguments[1]?{}:arguments[1],o=[],i=!1,s=0,a=void 0,l=void 0,c=void 0,u=void 0,p=void 0,d=void 0,h=void 0,m=void 0,f=void 0,g=void 0,v=void 0;if(isNaN(e))throw new Error("Invalid arguments");return c=t.bits===!0,f=t.unix===!0,l=void 0!==t.base?t.base:2,m=void 0!==t.round?t.round:f?1:2,g=void 0!==t.spacer?t.spacer:f?"":" ",v=void 0!==t.suffixes?t.suffixes:{},h=void 0!==t.output?t.output:"string",a=void 0!==t.exponent?t.exponent:-1,d=Number(e),p=0>d,u=l>2?1e3:1024,p&&(d=-d),0===d?(o[0]=0,f?o[1]="":o[1]="B"):((-1===a||isNaN(a))&&(a=Math.floor(Math.log(d)/Math.log(u))),a>8&&(s*=1e3*(a-8),a=8),s=2===l?d/Math.pow(2,10*a):d/Math.pow(1e3,a),c&&(s=8*s,s>u&&(s/=u,a++)),o[0]=Number(s.toFixed(a>0?m:0)),o[1]=r[c?"bits":"bytes"][a],!i&&f&&(c&&n.test(o[1])&&(o[1]=o[1].toLowerCase()),o[1]=o[1].charAt(0),"B"===o[1]?(o[0]=Math.floor(o[0]),o[1]=""):c||"k"!==o[1]||(o[1]="K"))),p&&(o[0]=-o[0]),o[1]=v[o[1]]||o[1],"array"===h?o:"exponent"===h?a:"object"===h?{value:o[0],suffix:o[1]}:o.join(g)};e.exports=o}("undefined"!=typeof t?t:window)}).call(t,function(){return this}())},function(e,t,n){e.exports=n(195)},function(e,t,n){e.exports=n(86)},function(e,t,n){(function(t){"use strict";var r=n(20),o=n(11);e.exports.PREFIX_V1="/_matrix/client/api/v1",e.exports.PREFIX_V2_ALPHA="/_matrix/client/v2_alpha",e.exports.PREFIX_IDENTITY_V1="/_matrix/identity/api/v1",e.exports.MatrixHttpApi=function(e){o.checkObjectHasKeys(e,["baseUrl","request","prefix"]),e.onlyData=e.onlyData||!1,this.opts=e},e.exports.MatrixHttpApi.prototype={getContentUri:function(){var e={access_token:this.opts.accessToken};return{base:this.opts.baseUrl,path:"/_matrix/media/v1/upload",params:e}},uploadContent:function(e,n){if(void 0!==n&&!o.isFunction(n))throw Error("Expected callback to be a function but got "+typeof n);var s=r.defer(),a=this.opts.baseUrl+"/_matrix/media/v1/upload";if(t.XMLHttpRequest){var l=new t.XMLHttpRequest,c=i(s,n,this.opts.onlyData),u=function(){l.abort(),c(new Error("Timeout"))};l.timeout_timer=setTimeout(u,3e4),l.onreadystatechange=function(){switch(l.readyState){case t.XMLHttpRequest.DONE:if(clearTimeout(l.timeout_timer),!l.responseText)return void c(new Error("No response body."));var e=JSON.parse(l.responseText);if(void 0===e.content_uri)return void c(new Error("Bad response"));c(void 0,l,e.content_uri)}},l.upload.addEventListener("progress",function(e){clearTimeout(l.timeout_timer),l.timeout_timer=setTimeout(u,3e4),s.notify(e)}),a+="?access_token="+encodeURIComponent(this.opts.accessToken),a+="&filename="+encodeURIComponent(e.name),l.open("POST",a),e.type?l.setRequestHeader("Content-Type",e.type):l.setRequestHeader("Content-Type","application/octet-stream"),l.send(e)}else{var p={filename:e.name,access_token:this.opts.accessToken};e.stream.pipe(this.opts.request({uri:a,qs:p,method:"POST"},i(s,n,this.opts.onlyData)))}return s.promise},idServerRequest:function(e,t,n,s,a){var l=this.opts.idBaseUrl+a+n;if(void 0!==e&&!o.isFunction(e))throw Error("Expected callback to be a function but got "+typeof e);var c={uri:l,method:t,withCredentials:!1,json:!1,_matrix_opts:this.opts};"GET"==t?c.qs=s:c.form=s;var u=r.defer();return this.opts.request(c,i(u,e,this.opts.onlyData)),u.promise},authedRequest:function(e,t,n,r,o){return r||(r={}),r.access_token=this.opts.accessToken,this.request(e,t,n,r,o)},request:function(e,t,n,r,o){return this.requestWithPrefix(e,t,n,r,o,this.opts.prefix)},authedRequestWithPrefix:function(e,t,n,r,o,i){var s=this.opts.baseUrl+i+n;return r||(r={}),r.access_token=this.opts.accessToken,this._request(e,t,s,r,o)},requestWithPrefix:function(e,t,n,r,o,i){var s=this.opts.baseUrl+i+n;return r||(r={}),this._request(e,t,s,r,o)},_request:function(e,t,n,s,a){if(void 0!==e&&!o.isFunction(e))throw Error("Expected callback to be a function but got "+typeof e);if(s||(s={}),this.opts.extraParams)for(var l in this.opts.extraParams)this.opts.extraParams.hasOwnProperty(l)&&(s[l]=this.opts.extraParams[l]);var c=r.defer();try{this.opts.request({uri:n,method:t,withCredentials:!1,qs:s,body:a,json:!0,_matrix_opts:this.opts},i(c,e,this.opts.onlyData))}catch(u){c.reject(u),e&&e(u)}return c.promise}};var i=function(t,n,r){return n=n||function(){},function(o,i,s){if(!o&&i.statusCode>=400&&(o=new e.exports.MatrixError(s),o.httpStatus=i.statusCode),o)t.reject(o),n(o);else{var a={code:i.statusCode,headers:i.headers,data:s};t.resolve(r?s:a),n(null,r?s:a)}}};e.exports.MatrixError=function(e){this.errcode=e.errcode,this.name=e.errcode||"Unknown error code",this.message=e.error||"Unknown message",this.data=e},e.exports.MatrixError.prototype=Object.create(Error.prototype),e.exports.MatrixError.prototype.constructor=e.exports.MatrixError}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e,t){this.roomId=e,this.name=e,this.timeline=[],this.oldState=new a(e),this.currentState=new a(e),this.summary=null,this.storageToken=t,this._redactions=[],this._receipts={},this._receiptCacheByEventId={}}function o(e,t,n){e.sender=t.getSentinelMember(e.getSender()),"m.room.member"===e.getType()&&(e.target=t.getSentinelMember(e.getStateKey())),e.isState()&&n&&(e.forwardLooking=!1)}function i(e,t){var n,r=e.currentState.getStateEvents("m.room.canonical_alias","");if(r&&(n=r.getContent().alias),!n){var o=e.currentState.getStateEvents("m.room.aliases")[0];o&&u.isArray(o.getContent().aliases)&&(n=o.getContent().aliases[0])}var i=e.currentState.getStateEvents("m.room.name","");if(i)return i.getContent().name+"";if(n)return n;var s=u.filter(e.currentState.getMembers(),function(e){return e.userId!==t&&"leave"!==e.membership});if(0===s.length){var a=u.filter(e.currentState.getMembers(),function(e){return"leave"!==e.membership});return 1===a.length?"invite"===a[0].membership?a[0].events.member?"Invite from "+a[0].events.member.getSender():"Room Invite":t:"?"}return 1===s.length?s[0].name:2===s.length?s[0].name+" and "+s[1].name:s[0].name+" and "+(s.length-1)+" others"}var s=n(32).EventEmitter,a=n(91),l=n(200),c=n(26).MatrixEvent,u=n(11),p=n(42);u.inherits(r,s),r.prototype.getAvatarUrl=function(e,t,n,r,o){var i=this.currentState.getStateEvents("m.room.avatar","");if(void 0===o&&(o=!0),!i&&!o)return null;var s=i?i.getContent().url:null;return s?p.getHttpUriForMxc(e,s,t,n,r):o?p.getIdenticonUri(e,this.roomId,t,n):null},r.prototype.getMember=function(e){var t=this.currentState.members[e];return t?t:null},r.prototype.getJoinedMembers=function(){return this.getMembersWithMembership("join")},r.prototype.getMembersWithMembership=function(e){return u.filter(this.currentState.getMembers(),function(t){return t.membership===e})},r.prototype.hasMembershipState=function(e,t){return u.filter(this.currentState.getMembers(),function(n){return n.membership===t&&n.userId===e}).length>0},r.prototype.addEventsToTimeline=function(e,t){function n(e){return function(t){return t.getId()===e.event.redacts}}for(var r=t?this.oldState:this.currentState,i=0;i<e.length;i++)if(!(t&&this._redactions.indexOf(e[i].getId())>=0)){if(o(e[i],r,t),e[i].isState()&&(r.setStateEvents([e[i]]),e[i].sender||o(e[i],r,t)),"m.room.redaction"===e[i].getType()){var s=u.removeElement(this.timeline,n(e[i]));!s&&t&&this._redactions.push(e[i].event.redacts)}t?this.timeline.unshift(e[i]):this.timeline.push(e[i]),this.emit("Room.timeline",e[i],this,Boolean(t))}},r.prototype.addEvents=function(e,t){if(t&&-1===["replace","ignore"].indexOf(t))throw new Error("duplicateStrategy MUST be either 'replace' or 'ignore'");for(var n=0;n<e.length;n++)if("m.typing"===e[n].getType())this.currentState.setTypingEvent(e[n]);else if("m.receipt"===e[n].getType())this.addReceipt(e[n]);else{if(t){for(var r=!1,i=0;i<this.timeline.length;i++)if(this.timeline[i].getId()===e[n].getId())if("replace"===t)o(e[n],this.currentState,!1),this.timeline[i].encryptedType||(this.timeline[i]=e[n]),r=!0;else if("ignore"===t){r=!0;break}if(r)continue}this.addEventsToTimeline([e[n]])}},r.prototype.recalculate=function(e){var t=this,n=this.currentState.getStateEvents("m.room.member",e);if(n&&"invite"===n.getContent().membership){var r=n.event.invite_room_state||[];u.forEach(r,function(n){var r=t.currentState.getStateEvents(n.type,n.state_key);r||t.currentState.setStateEvents([new c({type:n.type,state_key:n.state_key,content:n.content,event_id:"$fake"+Date.now(),room_id:t.roomId,user_id:e})])})}var o=this.name;this.name=i(this,e),this.summary=new l(this.roomId,{title:this.name}),o!==this.name&&this.emit("Room.name",this)},r.prototype.getUsersReadUpTo=function(e){return this.getReceiptsForEvent(e).filter(function(e){return"m.read"===e.type}).map(function(e){return e.userId})},r.prototype.getReceiptsForEvent=function(e){return this._receiptCacheByEventId[e.getId()]||[]},r.prototype.addReceipt=function(e){var t=this;u.keys(e.getContent()).forEach(function(n){u.keys(e.getContent()[n]).forEach(function(r){u.keys(e.getContent()[n][r]).forEach(function(o){var i=e.getContent()[n][r][o];t._receipts[r]||(t._receipts[r]={}),t._receipts[r][o]||(t._receipts[r][o]={}),t._receipts[r][o]={eventId:n,data:i}})})}),t._receiptCacheByEventId={},u.keys(t._receipts).forEach(function(e){u.keys(t._receipts[e]).forEach(function(n){var r=t._receipts[e][n];t._receiptCacheByEventId[r.eventId]||(t._receiptCacheByEventId[r.eventId]=[]),t._receiptCacheByEventId[r.eventId].push({userId:n,type:e,data:r.data})})})},e.exports=r},function(e,t,n){"use strict";function r(e){this.userId=e,this.presence="offline",this.displayName=e,this.avatarUrl=null,this.lastActiveAgo=0,this.events={presence:null,profile:null},this._updateModifiedTime()}var o=n(32).EventEmitter,i=n(11);i.inherits(r,o),r.prototype.setPresenceEvent=function(e){if("m.presence"===e.getType()){var t=null===this.events.presence;this.events.presence=e;var n=[];(e.getContent().presence!==this.presence||t)&&n.push("User.presence"),e.getContent().avatar_url!==this.avatarUrl&&n.push("User.avatarUrl"),e.getContent().displayname!==this.displayName&&n.push("User.displayName"),this.presence=e.getContent().presence,this.displayName=e.getContent().displayname,this.avatarUrl=e.getContent().avatar_url,this.lastActiveAgo=e.getContent().last_active_ago,n.length>0&&this._updateModifiedTime();for(var r=0;r<n.length;r++)this.emit(n[r],e,this)}},r.prototype._updateModifiedTime=function(){this._modified=Date.now()},r.prototype.getLastModifiedTime=function(){return this._modified},e.exports=r},function(e,t){"use strict";function n(e){var t=e.sender?e.sender.name:e.getSender(),n=e.target?e.target.name:e.getStateKey(),r=e.getContent().reason?" Reason: "+e.getContent().reason:"";switch(e.getContent().membership){case"invite":return t+" invited "+n+".";case"ban":return t+" banned "+n+"."+r;case"join":return e.getPrevContent()&&"join"==e.getPrevContent().membership?e.getPrevContent().displayname&&e.getContent().displayname&&e.getPrevContent().displayname!=e.getContent().displayname?e.getSender()+" changed their display name from "+e.getPrevContent().displayname+" to "+e.getContent().displayname:!e.getPrevContent().displayname&&e.getContent().displayname?e.getSender()+" set their display name to "+e.getContent().displayname:e.getPrevContent().displayname&&!e.getContent().displayname?e.getSender()+" removed their display name":e.getPrevContent().avatar_url&&!e.getContent().avatar_url?e.getSender()+" removed their profile picture":e.getPrevContent().avatar_url&&e.getContent().avatar_url&&e.getPrevContent().avatar_url!=e.getContent().avatar_url?e.getSender()+" changed their profile picture":!e.getPrevContent().avatar_url&&e.getContent().avatar_url?e.getSender()+" set a profile picture":"":(e.target||console.warn("Join message has no target! -- "+e.getContent().state_key),n+" joined the room.");case"leave":return e.getSender()===e.getStateKey()?n+" left the room.":"ban"===e.getPrevContent().membership?t+" unbanned "+n+".":"join"===e.getPrevContent().membership?t+" kicked "+n+"."+r:"invite"===e.getPrevContent().membership?t+" withdrew "+n+"'s invitation."+r:n+" left the room."}}function r(e){var t=e.sender&&e.sender.name?e.sender.name:e.getSender();return t+' changed the topic to, "'+e.getContent().topic+'"'}function o(e){var t=e.sender&&e.sender.name?e.sender.name:e.getSender(),n=t+": "+e.getContent().body;return"m.emote"===e.getContent().msgtype?n="* "+t+" "+n:"m.image"===e.getContent().msgtype&&(n=t+" sent an image."),n}function i(e){var t=e.sender?e.sender.name:"Someone";return t+" answered the call."}function s(e){var t=e.sender?e.sender.name:"Someone";return t+" ended the call."}function a(e){var t=e.sender?e.sender.name:"Someone",n="voice";return e.getContent().offer&&e.getContent().offer.sdp&&-1!==e.getContent().offer.sdp.indexOf("m=video")&&(n="video"),t+" placed a "+n+" call."}var l={"m.room.message":o,"m.room.topic":r,"m.room.member":n,"m.call.invite":a,"m.call.answer":i,"m.call.hangup":s};e.exports={textForEvent:function(e){var t=l[e.getType()];return t?t(e):""}}},function(e,t,n){"use strict";var r=n(1),o={PrivateChat:"private_chat",PublicChat:"public_chat",Custom:"custom"};e.exports={propTypes:{onChange:r.PropTypes.func,preset:r.PropTypes.string},Presets:o,getDefaultProps:function(){return{onChange:function(){}}}}},function(e,t){"use strict";e.exports=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}},function(e,t,n){"use strict";function r(){this._callbacks=null,this._contexts=null}var o=n(16),i=n(6),s=n(4);i(r.prototype,{enqueue:function(e,t){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(e),this._contexts.push(t)},notifyAll:function(){var e=this._callbacks,t=this._contexts;if(e){s(e.length===t.length),this._callbacks=null,this._contexts=null;for(var n=0,r=e.length;r>n;n++)e[n].call(t[n]);e.length=0,t.length=0}},reset:function(){this._callbacks=null,this._contexts=null},destructor:function(){this.reset()}}),o.addPoolingTo(r),e.exports=r},function(e,t,n){"use strict";function r(e){return e===g.topMouseUp||e===g.topTouchEnd||e===g.topTouchCancel}function o(e){return e===g.topMouseMove||e===g.topTouchMove}function i(e){return e===g.topMouseDown||e===g.topTouchStart}function s(e,t){var n=e._dispatchListeners,r=e._dispatchIDs;if(Array.isArray(n))for(var o=0;o<n.length&&!e.isPropagationStopped();o++)t(e,n[o],r[o]);else n&&t(e,n,r)}function a(e,t,n){e.currentTarget=f.Mount.getNode(n);var r=t(e,n);return e.currentTarget=null,r}function l(e,t){s(e,t),e._dispatchListeners=null,e._dispatchIDs=null}function c(e){var t=e._dispatchListeners,n=e._dispatchIDs;if(Array.isArray(t)){for(var r=0;r<t.length&&!e.isPropagationStopped();r++)if(t[r](e,n[r]))return n[r]}else if(t&&t(e,n))return n;return null}function u(e){var t=c(e);return e._dispatchIDs=null,e._dispatchListeners=null,t}function p(e){var t=e._dispatchListeners,n=e._dispatchIDs;m(!Array.isArray(t));var r=t?t(e,n):null;return e._dispatchListeners=null,e._dispatchIDs=null,r}function d(e){return!!e._dispatchListeners}var h=n(12),m=n(4),f={Mount:null,injectMount:function(e){f.Mount=e}},g=h.topLevelTypes,v={isEndish:r,isMoveish:o,isStartish:i,executeDirectDispatch:p,executeDispatch:a,executeDispatchesInOrder:l,executeDispatchesInOrderStopAtTrue:u,hasDispatches:d,injection:f,useTouchEvents:!1};e.exports=v},function(e,t,n){"use strict";function r(e){c(null==e.props.checkedLink||null==e.props.valueLink)}function o(e){r(e),c(null==e.props.value&&null==e.props.onChange)}function i(e){r(e),c(null==e.props.checked&&null==e.props.onChange)}function s(e){this.props.valueLink.requestChange(e.target.value)}function a(e){this.props.checkedLink.requestChange(e.target.checked)}var l=n(107),c=n(4),u={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0},p={Mixin:{propTypes:{value:function(e,t,n){return!e[t]||u[e.type]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(e,t,n){return!e[t]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:l.func}},getValue:function(e){return e.props.valueLink?(o(e),e.props.valueLink.value):e.props.value},getChecked:function(e){return e.props.checkedLink?(i(e),e.props.checkedLink.value):e.props.checked},getOnChange:function(e){return e.props.valueLink?(o(e),s):e.props.checkedLink?(i(e),a):e.props.onChange}};e.exports=p},function(e,t,n){"use strict";function r(e){e.remove()}var o=n(28),i=n(74),s=n(75),a=n(4),l={trapBubbledEvent:function(e,t){a(this.isMounted());var n=this.getDOMNode();a(n);var r=o.trapBubbledEvent(e,t,n);this._localEventListeners=i(this._localEventListeners,r)},componentWillUnmount:function(){this._localEventListeners&&s(this._localEventListeners,r)}};e.exports=l},function(e,t,n){"use strict";var r=n(102),o=n(19),i={processChildrenUpdates:r.dangerouslyProcessChildrenUpdates,replaceNodeWithMarkupByID:r.dangerouslyReplaceNodeWithMarkupByID,unmountIDFromEnvironment:function(e){o.purgeID(e)}};e.exports=i},function(e,t,n){"use strict";var r=n(4),o=!1,i={unmountIDFromEnvironment:null,replaceNodeWithMarkupByID:null,processChildrenUpdates:null,injection:{injectEnvironment:function(e){r(!o),i.unmountIDFromEnvironment=e.unmountIDFromEnvironment,i.replaceNodeWithMarkupByID=e.replaceNodeWithMarkupByID,i.processChildrenUpdates=e.processChildrenUpdates,o=!0}}};e.exports=i},function(e,t,n){"use strict";var r=n(6),o=n(50),i=(n(8),{current:o,withContext:function(e,t){var n,o=i.current;i.current=r({},o,e);try{n=t()}finally{i.current=o}return n}});e.exports=i},function(e,t,n){"use strict";function r(e){e&&(null!=e.dangerouslySetInnerHTML&&(v(null==e.children),v("object"==typeof e.dangerouslySetInnerHTML&&"__html"in e.dangerouslySetInnerHTML)),v(null==e.style||"object"==typeof e.style))}function o(e,t,n,r){var o=d.findReactContainerForID(e);if(o){var i=o.nodeType===w?o.ownerDocument:o;E(t,i)}r.getPutListenerQueue().enqueuePutListener(e,t,n)}function i(e){k.call(I,e)||(v(R.test(e)),I[e]=!0)}function s(e){i(e),this._tag=e,this._renderedChildren=null,this._previousStyleCopy=null,this._rootNodeID=null}var a=n(99),l=n(27),c=n(34),u=n(28),p=n(66),d=n(19),h=n(282),m=n(24),f=n(6),g=n(51),v=n(4),y=(n(80),n(22)),_=(n(8),u.deleteListener),E=u.listenTo,b=u.registrationNameModules,C={string:!0,number:!0},x=y({style:null}),w=1,S=null,T={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},R=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,I={},k={}.hasOwnProperty;s.displayName="ReactDOMComponent",s.Mixin={construct:function(e){this._currentElement=e},mountComponent:function(e,t,n){this._rootNodeID=e,r(this._currentElement.props);var o=T[this._tag]?"":"</"+this._tag+">";return this._createOpenTagMarkupAndPutListeners(t)+this._createContentMarkup(t,n)+o},_createOpenTagMarkupAndPutListeners:function(e){var t=this._currentElement.props,n="<"+this._tag;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];if(null!=i)if(b.hasOwnProperty(r))o(this._rootNodeID,r,i,e);else{r===x&&(i&&(i=this._previousStyleCopy=f({},t.style)),i=a.createMarkupForStyles(i));var s=c.createMarkupForProperty(r,i);s&&(n+=" "+s)}}if(e.renderToStaticMarkup)return n+">";var l=c.createMarkupForID(this._rootNodeID);return n+" "+l+">"},_createContentMarkup:function(e,t){var n="";("listing"===this._tag||"pre"===this._tag||"textarea"===this._tag)&&(n="\n");var r=this._currentElement.props,o=r.dangerouslySetInnerHTML;if(null!=o){if(null!=o.__html)return n+o.__html}else{var i=C[typeof r.children]?r.children:null,s=null!=i?null:r.children;if(null!=i)return n+g(i);if(null!=s){var a=this.mountChildren(s,e,t);return n+a.join("")}}return n},receiveComponent:function(e,t,n){var r=this._currentElement;this._currentElement=e,this.updateComponent(t,r,e,n)},updateComponent:function(e,t,n,o){r(this._currentElement.props),this._updateDOMProperties(t.props,e),this._updateDOMChildren(t.props,e,o)},_updateDOMProperties:function(e,t){var n,r,i,s=this._currentElement.props;for(n in e)if(!s.hasOwnProperty(n)&&e.hasOwnProperty(n))if(n===x){var a=this._previousStyleCopy;for(r in a)a.hasOwnProperty(r)&&(i=i||{},i[r]="");this._previousStyleCopy=null}else b.hasOwnProperty(n)?_(this._rootNodeID,n):(l.isStandardName[n]||l.isCustomAttribute(n))&&S.deletePropertyByID(this._rootNodeID,n);for(n in s){var c=s[n],u=n===x?this._previousStyleCopy:e[n];if(s.hasOwnProperty(n)&&c!==u)if(n===x)if(c?c=this._previousStyleCopy=f({},c):this._previousStyleCopy=null,u){for(r in u)!u.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(i=i||{},i[r]="");for(r in c)c.hasOwnProperty(r)&&u[r]!==c[r]&&(i=i||{},i[r]=c[r])}else i=c;else b.hasOwnProperty(n)?o(this._rootNodeID,n,c,t):(l.isStandardName[n]||l.isCustomAttribute(n))&&S.updatePropertyByID(this._rootNodeID,n,c)}i&&S.updateStylesByID(this._rootNodeID,i)},_updateDOMChildren:function(e,t,n){var r=this._currentElement.props,o=C[typeof e.children]?e.children:null,i=C[typeof r.children]?r.children:null,s=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,a=r.dangerouslySetInnerHTML&&r.dangerouslySetInnerHTML.__html,l=null!=o?null:e.children,c=null!=i?null:r.children,u=null!=o||null!=s,p=null!=i||null!=a;null!=l&&null==c?this.updateChildren(null,t,n):u&&!p&&this.updateTextContent(""),null!=i?o!==i&&this.updateTextContent(""+i):null!=a?s!==a&&S.updateInnerHTMLByID(this._rootNodeID,a):null!=c&&this.updateChildren(c,t,n)},unmountComponent:function(){this.unmountChildren(),u.deleteAllListeners(this._rootNodeID),p.unmountIDFromEnvironment(this._rootNodeID),this._rootNodeID=null}},m.measureMethods(s,"ReactDOMComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent"}),f(s.prototype,s.Mixin,h.Mixin),s.injection={injectIDOperations:function(e){s.BackendIDOperations=S=e}},e.exports=s},function(e,t,n){"use strict";function r(e){u[e]=!0}function o(e){delete u[e]}function i(e){return!!u[e]}var s,a=n(7),l=n(30),c=n(4),u={},p={injectEmptyComponent:function(e){s=a.createFactory(e)}},d=function(){};d.prototype.componentDidMount=function(){var e=l.get(this);e&&r(e._rootNodeID)},d.prototype.componentWillUnmount=function(){var e=l.get(this);e&&o(e._rootNodeID)},d.prototype.render=function(){return c(s),s()};var h=a.createElement(d),m={emptyElement:h,injection:p,isNullComponentID:i};e.exports=m},function(e,t){"use strict";var n={currentlyMountingInstance:null,currentlyUnmountingInstance:null};e.exports=n},function(e,t,n){"use strict";var r=n(39),o=r({prop:null,context:null,childContext:null});e.exports=o},function(e,t,n){"use strict";function r(e){e!==i.currentlyMountingInstance&&c.enqueueUpdate(e)}function o(e,t){p(null==s.current);var n=l.get(e);return n?n===i.currentlyUnmountingInstance?null:n:null}var i=n(71),s=n(18),a=n(7),l=n(30),c=n(15),u=n(6),p=n(4),d=(n(8),{enqueueCallback:function(e,t){p("function"==typeof t);var n=o(e);return n&&n!==i.currentlyMountingInstance?(n._pendingCallbacks?n._pendingCallbacks.push(t):n._pendingCallbacks=[t],void r(n)):null},enqueueCallbackInternal:function(e,t){p("function"==typeof t),e._pendingCallbacks?e._pendingCallbacks.push(t):e._pendingCallbacks=[t],r(e)},enqueueForceUpdate:function(e){var t=o(e,"forceUpdate");t&&(t._pendingForceUpdate=!0,r(t))},enqueueReplaceState:function(e,t){var n=o(e,"replaceState");n&&(n._pendingStateQueue=[t],n._pendingReplaceState=!0,r(n))},enqueueSetState:function(e,t){var n=o(e,"setState");if(n){var i=n._pendingStateQueue||(n._pendingStateQueue=[]);i.push(t),r(n)}},enqueueSetProps:function(e,t){var n=o(e,"setProps");if(n){p(n._isTopLevel);var i=n._pendingElement||n._currentElement,s=u({},i.props,t);n._pendingElement=a.cloneAndReplaceProps(i,s),r(n)}},enqueueReplaceProps:function(e,t){var n=o(e,"replaceProps");if(n){p(n._isTopLevel);var i=n._pendingElement||n._currentElement;n._pendingElement=a.cloneAndReplaceProps(i,t),r(n)}},enqueueElementInternal:function(e,t){e._pendingElement=t,r(e)}});e.exports=d},function(e,t,n){"use strict";function r(e,t){if(o(null!=t),null==e)return t;var n=Array.isArray(e),r=Array.isArray(t);return n&&r?(e.push.apply(e,t),e):n?(e.push(t),e):r?[e].concat(t):[e,t]}var o=n(4);e.exports=r},function(e,t){"use strict";var n=function(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)};e.exports=n},function(e,t){"use strict";function n(e){var t,n=e.keyCode;return"charCode"in e?(t=e.charCode,0===t&&13===n&&(t=13)):t=n,t>=32||13===t?t:0}e.exports=n},function(e,t){"use strict";function n(e){var t=this,n=t.nativeEvent;if(n.getModifierState)return n.getModifierState(e);var r=o[e];return r?!!n[r]:!1}function r(e){return n}var o={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};e.exports=r},function(e,t){"use strict";function n(e){var t=e.target||e.srcElement||window;return 3===t.nodeType?t.parentNode:t}e.exports=n},function(e,t,n){"use strict";function r(e){return"function"==typeof e&&"undefined"!=typeof e.prototype&&"function"==typeof e.prototype.mountComponent&&"function"==typeof e.prototype.receiveComponent}function o(e,t){var n;if((null===e||e===!1)&&(e=s.emptyElement),"object"==typeof e){var o=e;n=t===o.type&&"string"==typeof o.type?a.createInternalComponent(o):r(o.type)?new o.type(o):new u}else"string"==typeof e||"number"==typeof e?n=a.createInstanceForText(e):c(!1);return n.construct(e),n._mountIndex=0,n._mountImage=null,n}var i=n(265),s=n(70),a=n(46),l=n(6),c=n(4),u=(n(8),function(){});l(u.prototype,i.Mixin,{_instantiateReactComponent:o}),e.exports=o},function(e,t,n){"use strict";/**
	 * Checks if an event is supported in the current execution environment.
	 *
	 * NOTE: This will not work correctly for non-generic events such as `change`,
	 * `reset`, `load`, `error`, and `select`.
	 *
	 * Borrows from Modernizr.
	 *
	 * @param {string} eventNameSuffix Event name, e.g. "click".
	 * @param {?boolean} capture Check if the capture phase is supported.
	 * @return {boolean} True if the event is supported.
	 * @internal
	 * @license Modernizr 3.0.0pre (Custom Build) | MIT
	 */
function r(e,t){if(!i.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,r=n in document;if(!r){var s=document.createElement("div");s.setAttribute(n,"return;"),r="function"==typeof s[n]}return!r&&o&&"wheel"===e&&(r=document.implementation.hasFeature("Events.wheel","3.0")),r}var o,i=n(9);i.canUseDOM&&(o=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0),e.exports=r},function(e,t,n){"use strict";var r=n(9),o=/^[ \r\n\t\f]/,i=/<(!--|link|noscript|meta|script|style)[ \r\n\t\f\/>]/,s=function(e,t){e.innerHTML=t};if("undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction&&(s=function(e,t){MSApp.execUnsafeLocalFunction(function(){e.innerHTML=t})}),r.canUseDOM){var a=document.createElement("div");a.innerHTML=" ",""===a.innerHTML&&(s=function(e,t){if(e.parentNode&&e.parentNode.replaceChild(e,e),o.test(t)||"<"===t[0]&&i.test(t)){e.innerHTML="\ufeff"+t;var n=e.firstChild;1===n.data.length?e.removeChild(n):n.deleteData(0,1)}else e.innerHTML=t})}e.exports=s},function(e,t,n){"use strict";function r(e,t){if(null!=e&&null!=t){var n=typeof e,r=typeof t;if("string"===n||"number"===n)return"string"===r||"number"===r;if("object"===r&&e.type===t.type&&e.key===t.key){var o=e._owner===t._owner;return o}}return!1}n(8);e.exports=r},function(e,t,n){(function(e,r){function o(e,t){this._id=e,this._clearFn=t}var i=n(122).nextTick,s=Function.prototype.apply,a=Array.prototype.slice,l={},c=0;t.setTimeout=function(){return new o(s.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new o(s.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var n=c++,r=arguments.length<2?!1:a.call(arguments,1);return l[n]=!0,i(function(){l[n]&&(r?e.apply(null,r):e.call(null),t.clearImmediate(n))}),n},t.clearImmediate="function"==typeof r?r:function(e){delete l[e]}}).call(t,n(83).setImmediate,n(83).clearImmediate)},function(e,t){e.exports={default_hs_url:"https://matrix.org",default_is_url:"https://vector.im"}},function(e,t,n){"use strict";var r=n(2);e.exports={avatarUrlForMember:function(e,t,n,o){var i=e.getAvatarUrl(r.get().getHomeserverUrl(),t,n,o);return i||(i=this.defaultAvatarUrlForString(e?e.userId:"")),i},defaultAvatarUrlForString:function(e){for(var t=0,n=0;n<e.length;++n)t+=e.charCodeAt(n);switch(t%3){case 0:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADRJREFUeNrszQENADAIACB9QjNbxSKP4eagAFnTseHFErFYLBaLxWKxWCwWi8Vi8cX4CzAABSwCRWJw31gAAAAASUVORK5CYII=";case 1:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADRJREFUeNrszQENADAIACB9chOaxgCP4eagAFk9seHFErFYLBaLxWKxWCwWi8Vi8cX4CzAAtKMCks/JG8MAAAAASUVORK5CYII=";case 2:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADRJREFUeNrszQENADAIACB9YzNayQCP4eagADldseHFErFYLBaLxWKxWCwWi8Vi8cX4CzAAyiACeHwPiu4AAAAASUVORK5CYII="}}}},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}t.__esModule=!0;var o=n(198),i=r(o),s=n(197),a=r(s),l=n(196),c=r(l);Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var u=function(e){return c.run(a.run(e))},p=function(e){for(var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=u(e),r=[],o=0;o<n.length;o++)!n[o].isLink||t&&n[o].type!==t||r.push(n[o].toObject());return r},d=function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=u(e);return 1===n.length&&n[0].isLink&&(!t||n[0].type===t)};t.find=p,t.options=i,t.parser=c,t.scanner=a,t.test=d,t.tokenize=u},function(e,t){"use strict";function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n,r){for(var o=0,i=e.length,a=t,l=[],c=void 0;i>o&&(c=a.next(e[o]));)a=c,o++;if(o>=i)return[];for(;i-1>o;)c=new s(r),l.push(c),a.on(e[o],c),a=c,o++;return c=new s(n),l.push(c),a.on(e[i-1],c),l}t.__esModule=!0;var i=function(){function e(t){r(this,e),this.j=[],this.T=t||null}return e.prototype.on=function(e,t){if(e instanceof Array)for(var n=0;n<e.length;n++)this.j.push([e[n],t]);else this.j.push([e,t])},e.prototype.next=function(e){for(var t=0;t<this.j.length;t++){var n=this.j[t],r=n[0],o=n[1];if(this.test(e,r))return o}return!1},e.prototype.accepts=function(){return!!this.T},e.prototype.test=function(e,t){return e===t},e.prototype.emit=function(){return this.T},e}(),s=function(e){function t(){r(this,t),e.apply(this,arguments)}return n(t,e),t.prototype.test=function(e,t){return e===t||t instanceof RegExp&&t.test(e)},t}(i),a=function(e){function t(){r(this,t),e.apply(this,arguments)}return n(t,e),t.prototype.test=function(e,t){return e instanceof t},t}(i);t.CharacterState=s,t.TokenState=a,t.stateify=o},function(e,t){"use strict";function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return e instanceof s||e instanceof E}t.__esModule=!0;var i=function(){function e(t){r(this,e),this.v=t}return e.prototype.toString=function(){return this.v+""},e}(),s=function(e){function t(){r(this,t),e.apply(this,arguments)}return n(t,e),t}(i),a=function(e){function t(){r(this,t),e.call(this,"@")}return n(t,e),t}(i),l=function(e){function t(){r(this,t),e.call(this,":")}return n(t,e),t}(i),c=function(e){function t(){r(this,t),e.call(this,".")}return n(t,e),t}(i),u=function(e){function t(){r(this,t),e.apply(this,arguments)}return n(t,e),t}(i),p=function(e){function t(){r(this,t),e.apply(this,arguments)}return n(t,e),t}(i),d=function(e){function t(){r(this,t),e.call(this,"\n")}return n(t,e),t}(i),h=function(e){function t(){r(this,t),e.apply(this,arguments)}return n(t,e),t}(i),m=function(e){function t(){r(this,t),e.call(this,"+")}return n(t,e),t}(i),f=function(e){function t(){r(this,t),e.call(this,"#")}return n(t,e),t}(i),g=function(e){function t(){r(this,t),e.apply(this,arguments)}return n(t,e),t}(i),v=function(e){function t(){r(this,t),e.call(this,"?")}return n(t,e),t}(i),y=function(e){function t(){r(this,t),e.call(this,"/")}return n(t,e),t}(i),_=function(e){function t(){r(this,t),e.apply(this,arguments)}return n(t,e),t}(i),E=function(e){function t(){r(this,t),e.apply(this,arguments)}return n(t,e),t}(i),b=function(e){function t(){r(this,t),e.apply(this,arguments)}return n(t,e),t}(i),C={Base:i,DOMAIN:s,AT:a,COLON:l,DOT:c,PUNCTUATION:u,LOCALHOST:p,NL:d,NUM:h,PLUS:m,POUND:f,QUERY:v,PROTOCOL:g,SLASH:y,SYM:_,TLD:E,WS:b},x=function(){function e(t){r(this,e),this.v=t,this.type="token",this.isLink=!1}return e.prototype.toString=function(){for(var e=[],t=0;t<this.v.length;t++)e.push(this.v[t].toString());return e.join("")},e.prototype.toHref=function(){return this.toString()},e.prototype.toObject=function(){var e=arguments.length<=0||void 0===arguments[0]?"http":arguments[0];return{type:this.type,value:this.toString(),href:this.toHref(e)}},e}(),w=function(e){function t(n){r(this,t),e.call(this,n),this.type="email",this.isLink=!0}return n(t,e),t.prototype.toHref=function(){return"mailto:"+this.toString()},t}(x),S=function(e){function t(n){r(this,t),e.call(this,n),this.type="text"}return n(t,e),t}(x),T=function(e){function t(n){r(this,t),e.call(this,n),this.type="nl"}return n(t,e),t}(x),R=function(e){function t(n){r(this,t),e.call(this,n),this.type="url",this.isLink=!0}return n(t,e),t.prototype.toHref=function(){for(var e=arguments.length<=0||void 0===arguments[0]?"http":arguments[0],t=!1,n=!1,r=this.v,i=[],s=0;r[s]instanceof g;)t=!0,i.push(r[s].toString().toLowerCase()),s++;for(;r[s]instanceof y;)n=!0,i.push(r[s].toString()),s++;for(;o(r[s]);)i.push(r[s].toString().toLowerCase()),s++;for(;s<r.length;s++)i.push(r[s].toString());return i=i.join(""),t||n||(i=e+"://"+i),i},t.prototype.hasProtocol=function(){return this.v[0]instanceof g},t}(x),I={Base:x,EMAIL:w,NL:T,TEXT:S,URL:R};t.text=C,t.multi=I},function(e,t,n){"use strict";function r(e){if(P.checkObjectHasKeys(e,["baseUrl","request"]),this.baseUrl=e.baseUrl,this.idBaseUrl=e.idBaseUrl,this.store=e.store||new M,this.sessionStore=e.sessionStore||null,this.accountKey="DEFAULT_KEY",this.deviceId=e.deviceId,O&&null!==this.sessionStore){var t=this.sessionStore.getEndToEndAccount(),n=new L.Account;try{null===t?n.create():n.unpickle(this.accountKey,t);var r=JSON.parse(n.identity_keys()),o='{"algorithms":["'+B+'"]';o+=',"device_id":"'+this.deviceId+'"',o+=',"keys":',o+='{"ed25519:'+this.deviceId+'":',o+=JSON.stringify(r.ed25519),o+=',"curve25519:'+this.deviceId+'":',o+=JSON.stringify(r.curve25519),o+="}",o+=',"user_id":'+JSON.stringify(e.userId),o+="}";var i=n.sign(o);this.deviceKeys=JSON.parse(o);var s={};s[e.userId]={},s[e.userId]["ed25519:"+this.deviceId]=i,this.deviceKeys.signatures=s,this.deviceCurve25519Key=r.curve25519;var a=n.pickle(this.accountKey);this.sessionStore.storeEndToEndAccount(a);var c=this.sessionStore.getEndToEndDevicesForUser(e.userId)||{};c[e.deviceId]=this.deviceKeys,this.sessionStore.storeEndToEndDevicesForUser(e.userId,c)}finally{n.free()}}if(this.scheduler=e.scheduler,this.scheduler){var u=this;this.scheduler.setProcessFunction(function(e){return e.status=k.SENDING,l(u,e)})}this.clientRunning=!1;var p={baseUrl:e.baseUrl,idBaseUrl:e.idBaseUrl,accessToken:e.accessToken,request:e.request,prefix:R.PREFIX_V1,onlyData:!0,extraParams:e.queryParams};this.credentials={userId:e.userId||null},this._http=new R.MatrixHttpApi(p),this._syncingRooms={},this.callList={},this._config={};var d=A.createNewMatrixCall(this);this._supportsVoip=!1,d&&(v(this),this._supportsVoip=!0)}function o(e,t,n,r,o,i,s){if(!e.sessionStore)throw new Error("Client must have an end-to-end session store to encrypt messages");if(n.algorithm===B){for(var a=[],l=0;l<n.members.length;++l){var c=n.members[l],u=e.sessionStore.getEndToEndDevicesForUser(c);for(var p in u)if(u.hasOwnProperty(p)){var d=u[p];for(var h in d.keys)0===h.indexOf("curve25519:")&&a.push(d.keys[h])}}a.sort();var m="",f={room_id:t,type:r,fingerprint:m,sender_device:e.deviceId,content:o},g={},v=JSON.stringify(f);for(l=0;l<a.length;++l){var y=a[l];if(y!=e.deviceCurve25519Key){var _=e.sessionStore.getEndToEndSessions(y),E=[];for(var b in _)_.hasOwnProperty(b)&&E.push(b);if(E.sort(),0!==E.length){b=E[0];var C=new L.Session;try{C.unpickle(e.accountKey,_[b]),g[y]=C.encrypt(v);var x=C.pickle(e.accountKey);e.sessionStore.storeEndToEndSession(y,b,x)}finally{C.free()}}}}var w={algorithm:n.algorithm,sender_key:e.deviceCurve25519Key,ciphertext:g};return w}throw new Error("Unknown end-to-end algorithm: "+n.algorithm)}function i(e,t){if(null===e.sessionStore||!O)return s(t,"**Encryption not enabled**");var n=t.getContent();if(n.algorithm===B){var r=n.sender_key,o=n.ciphertext;if(!o)return s(t,"**Missing ciphertext**");if(!(e.deviceCurve25519Key in n.ciphertext))return s(t,"**Not included in recipients**");var i,a=n.ciphertext[e.deviceCurve25519Key],l=e.sessionStore.getEndToEndSessions(r),c=null,u=!1;for(var p in l)if(l.hasOwnProperty(p)){i=new L.Session;try{i.unpickle(e.accountKey,l[p]),0===a.type&&i.matches_inbound(a.body)&&(u=!0),c=i.decrypt(a.type,a.body);var d=i.pickle(e.accountKey);e.sessionStore.storeEndToEndSession(r,p,d)}catch(h){console.log("Failed to decrypt with an existing session: "+h.message)}finally{i.free()}}if(0===a.type&&!u&&null===c){var m=new L.Account;i=new L.Session;try{var f=e.sessionStore.getEndToEndAccount();m.unpickle(e.accountKey,f),i.create_inbound_from(m,r,a.body),c=i.decrypt(a.type,a.body),m.remove_one_time_keys(i);var g=i.pickle(e.accountKey),v=m.pickle(e.accountKey);p=i.session_id(),e.sessionStore.storeEndToEndSession(r,p,g),e.sessionStore.storeEndToEndAccount(v)}catch(h){}finally{i.free(),m.free()}}if(null!==c){var y=JSON.parse(c);return new I({origin_server_ts:t.getTs(),room_id:y.room_id,user_id:t.getSender(),event_id:t.getId(),type:y.type,content:y.content},"encrypted")}return s(t,"**Bad Encrypted Message**")}}function s(e,t){return new I({type:"m.room.message",origin_server_ts:e.getTs(),room_id:e.getRoomId(),user_id:e.getSender(),event_id:e.getId(),content:{msgtype:"m.bad.encrypted",body:t,content:e.getContent()}})}function a(e,t,n,r){var o,i=T.defer();return e.scheduler&&(o=e.scheduler.queueEvent(n),o&&e.scheduler.getQueueForEvent(n).length>1&&(n.status=k.QUEUED)),o||(o=l(e,n)),o.done(function(e){if(t){var o=e.event_id,s=P.findElement(t.timeline,function(e){return e.getId()===o},!0);s?(n.encryptedType&&(s.event.content=n.event.content,s.event.type=n.event.type),P.removeElement(t.timeline,function(e){return e.getId()===n.getId()},!0)):(n.event.event_id=e.event_id,n.status=null)}C(r,i,e)},function(e){n.status=k.NOT_SENT,b(r,i,e)}),i.promise}function l(e,t){var n,r={$roomId:t.getRoomId(),$eventType:t.getWireType(),$stateKey:t.getStateKey(),$txnId:t._txnId?t._txnId:(new Date).getTime()};if(t.isState()){var o="/rooms/$roomId/state/$eventType";t.getStateKey()&&t.getStateKey().length>0&&(o="/rooms/$roomId/state/$eventType/$stateKey"),n=P.encodeUri(o,r)}else n=P.encodeUri("/rooms/$roomId/send/$eventType/$txnId",r);return e._http.authedRequest(void 0,"PUT",n,void 0,t.getWireContent())}function c(e,t,n,r,o,i){P.isFunction(o)&&(i=o,o=void 0);var s=P.encodeUri("/rooms/$roomId/state/m.room.member/$userId",{$roomId:t,$userId:n});return e._http.authedRequest(i,"PUT",s,void 0,{membership:r,reason:o})}function u(e,t,n,r,o,i){P.isFunction(o)&&(i=o,o=void 0);var s=P.encodeUri("/rooms/$room_id/$membership",{$room_id:t,$membership:r});return e._http.authedRequest(i,"POST",s,void 0,{user_id:n,reason:o})}function p(e,t,n){var r={limit:t};n&&(r.archived=!0),e._http.authedRequest(void 0,"GET","/initialSync",r).done(function(t){var n,r;if(!(e.store instanceof M)){P.forEach(P.map(t.presence,x(e)),function(t){var n=_(e,t.getContent().user_id);n.setPresenceEvent(t),e.store.storeUser(n)});var o={};for(t.receipts=t.receipts||[],P.forEach(t.receipts.map(x(e)),function(e){o[e.getRoomId()]||(o[e.getRoomId()]=[]),o[e.getRoomId()].push(e)}),n=0;n<t.rooms.length;n++){var i=E(e,t.rooms[n].room_id);if(t.rooms[n].state||(t.rooms[n].state=[]),"invite"===t.rooms[n].membership){var s=t.rooms[n].invite;s||(s={event_id:"$fake_"+i.roomId,content:{membership:"invite"},state_key:e.credentials.userId,user_id:t.rooms[n].inviter,room_id:i.roomId,type:"m.room.member"}),t.rooms[n].state.push(s)}m(e,i,t.rooms[n].state,t.rooms[n].messages);var a=o[i.roomId]||[];for(r=0;r<a.length;r++)i.addReceipt(a[r]);i.recalculate(e.credentials.userId),e.store.storeRoom(i),e.emit("Room",i)}}if(t){e.store.setSyncToken(t.end);var l=[];for(n=0;n<t.presence.length;n++)l.push(new I(t.presence[n]));for(n=0;n<t.rooms.length;n++){if(t.rooms[n].state)for(r=0;r<t.rooms[n].state.length;r++)l.push(new I(t.rooms[n].state[r]));if(t.rooms[n].messages)for(r=0;r<t.rooms[n].messages.chunk.length;r++)l.push(new I(t.rooms[n].messages.chunk[r]))}P.forEach(l,function(t){e.emit("event",t)})}e.clientRunning=!0,e.emit("syncComplete"),d(e)},function(t){console.error("/initialSync error: %s",t),e.emit("syncError",t)})}function d(e){var t=e;if(e.clientRunning){var n=!1,r=setTimeout(function(){n=!0,console.error("/events request timed out."),d(e)},4e4);e._http.authedRequest(void 0,"GET","/events",{from:e.store.getSyncToken(),timeout:3e4}).done(function(e){if(!n){clearTimeout(r);var o=[];if(e&&(o=P.map(e.chunk,x(t))),!(t.store instanceof M)){var i={},s=0,a={};for(s=0;s<o.length;s++){var l=o[s].getRoomId();if(l)a[l]||(a[l]=[]),a[l].push(o[s]),"m.room.member"===o[s].getType()&&"invite"===o[s].getContent().membership&&(i[l]=!0);else if("m.presence"===o[s].getType()){var c=t.store.getUser(o[s].getContent().user_id);c?c.setPresenceEvent(o[s]):(c=_(t,o[s].getContent().user_id),c.setPresenceEvent(o[s]),t.store.storeUser(c))}}var u=P.keys(a);P.forEach(u,function(e){var n=t.store.getRoom(e),r=!1;n||(n=E(t,e),r=!0);var o=n.hasMembershipState(t.credentials.userId,"join");n.addEvents(a[e],"replace"),n.recalculate(t.credentials.userId),r&&(t.store.storeRoom(n),t.emit("Room",n));var i=n.hasMembershipState(t.credentials.userId,"join");!o&&i&&h(t,n)}),Object.keys(i).forEach(function(e){g(t,t.store.getRoom(e))})}e&&(t.store.setSyncToken(e.end),P.forEach(o,function(e){t.emit("event",e)})),d(t)}},function(e){console.error("/events error: %s",JSON.stringify(e)),n||(clearTimeout(r),t.emit("syncError",e),setTimeout(function(){d(t)},2e3))})}}function h(e,t){if(e._syncingRooms[t.roomId])return e._syncingRooms[t.roomId];var n=T.defer();return e._syncingRooms[t.roomId]=n.promise,e.roomInitialSync(t.roomId,8).done(function(r){t.timeline=[],m(e,t,r.state,r.messages),t.recalculate(e.credentials.userId),e.store.storeRoom(t),e.emit("Room",t),n.resolve(t),e._syncingRooms[t.roomId]=void 0},function(r){n.reject(r),e._syncingRooms[t.roomId]=void 0}),n.promise}function m(e,t,n,r){var o=P.map(P.deepCopy(n),x(e)),i=P.map(n,x(e));t.oldState.setStateEvents(o),t.currentState.setStateEvents(i),g(e,t),t.addEventsToTimeline(P.map(r?r.chunk:[],x(e)).reverse(),!0),r&&(t.oldState.paginationToken=r.start)}function f(e,t,n){P.forEach(n,function(n){t.on(n,function(){for(var t=[n],r=0;r<arguments.length;r++)t.push(arguments[r]);e.emit.apply(e,t)})})}function g(e,t){t&&e._config.resolveInvitesToProfiles&&t.getMembersWithMembership("invite").forEach(function(n){if(!n._requestedProfileInfo){n._requestedProfileInfo=!0;var r,o=e.getUser(n.userId);r=o?T({avatar_url:o.avatarUrl,displayname:o.displayName}):e.getProfileInfo(n.userId),r.done(function(e){var r=n.events.member;"invite"===r.getContent().membership&&(r.getContent().avatar_url=e.avatar_url,r.getContent().displayname=e.displayname,n.setMembershipEvent(r,t.currentState))},function(e){})}})}function v(e){var t={};e.on("event",function(n){if(0===n.getType().indexOf("m.call.")){var r,o=n.getContent(),i=o.call_id?e.callList[o.call_id]:void 0;if("m.call.invite"===n.getType()){if(n.getSender()===e.credentials.userId)return;if(n.getAge()>o.lifetime)return;if(i&&"ended"===i.state)return;if(i&&console.log("WARN: Already have a MatrixCall with id %s but got an invite. Clobbering.",o.call_id),i=A.createNewMatrixCall(e,n.getRoomId()),!i)return void console.log("Incoming call ID "+o.call_id+" but this client doesn't support WebRTC");if(i.callId=o.call_id,i._initWithInvite(n),e.callList[i.callId]=i,t[i.callId])for(r=0;r<t[i.callId].length;r++)i._gotRemoteIceCandidate(t[i.callId][r]);var s,a=P.values(e.callList);for(r=0;r<a.length;++r){var l=a[r];if(i.room_id===l.room_id&&"outbound"===l.direction&&-1!==["wait_local_media","create_offer","invite_sent"].indexOf(l.state)){s=l;break}}s?"wait_local_media"===s.state||"create_offer"===s.state||s.callId>i.callId?(console.log("Glare detected: answering incoming call "+i.callId+" and canceling outgoing call "+s.callId),s._replacedBy(i),i.answer()):(console.log("Glare detected: rejecting incoming call "+i.callId+" and keeping outgoing call "+s.callId),i.hangup()):e.emit("Call.incoming",i)}else if("m.call.answer"===n.getType()){if(!i)return;n.getSender()===e.credentials.userId?"ringing"===i.state&&i._onAnsweredElsewhere(o):i._receivedAnswer(o)}else if("m.call.candidates"===n.getType()){if(n.getSender()===e.credentials.userId)return;if(i)for(r=0;r<o.candidates.length;r++)i._gotRemoteIceCandidate(o.candidates[r]);else t[o.call_id]||(t[o.call_id]=[]),t[o.call_id]=t[o.call_id].concat(o.candidates)}else"m.call.hangup"===n.getType()&&(i?"ended"!==i.state&&(i._onHangupReceived(o),delete e.callList[o.call_id]):(i=A.createNewMatrixCall(e,n.getRoomId()),i&&(i.callId=o.call_id,i._initWithHangup(n),e.callList[o.call_id]=i)))}})}function y(e){e._supportsVoip&&e.turnServer().done(function(t){if(t.uris){console.log("Got TURN URIs: "+t.uris+" refresh in "+t.ttl+" secs");var n={urls:t.uris,username:t.username,credential:t.password};e._turnServers=[n],setTimeout(function(){y(e)},1e3*(t.ttl||3600)*.9)}},function(t){console.error("Failed to get TURN URIs"),setTimeout(function(){y(e)},6e4)})}function _(e,t){var n=new D(t);return f(e,n,["User.avatarUrl","User.displayName","User.presence"]),n}function E(e,t){var n=new N(t);return f(e,n,["Room.name","Room.timeline"]),f(e,n.currentState,["RoomState.events","RoomState.members","RoomState.newMember"]),n.currentState.on("RoomState.newMember",function(t,n,r){r.user=e.getUser(r.userId),f(e,r,["RoomMember.name","RoomMember.typing","RoomMember.powerLevel","RoomMember.membership"])}),n}function b(e,t,n){e&&e(n),t.reject(n)}function C(e,t,n){e&&e(null,n),t.resolve(n)}function x(e){function t(t){var n=new I(t);return"m.room.encrypted"===n.getType()?i(e,n):n}return t}var w=n(201),S=n(32).EventEmitter,T=n(20),R=n(56),I=n(26).MatrixEvent,k=n(26).EventStatus,M=n(205),N=n(57),D=n(58),A=n(92),P=n(11),U=n(42),O=!1;try{var L=n(!function(){var e=new Error('Cannot find module "olm"');throw e.code="MODULE_NOT_FOUND",e}());L.Account&&L.Session&&(O=!0)}catch(F){}var B="m.olm.v1.curve25519-aes-sha2";P.inherits(r,S),r.prototype.getHomeserverUrl=function(){return this.baseUrl},r.prototype.getIdentityServerUrl=function(){return this.idBaseUrl},r.prototype.isCryptoEnabled=function(){return O&&null!==this.sessionStore},r.prototype.uploadKeys=function(e,t){if(!O||null===this.sessionStore)return T.reject(new Error("End-to-end encryption disabled"));var n=void 0===t;t=t||T.defer();var r="/keys/upload/"+this.deviceId,o=this.sessionStore.getEndToEndAccount();if(!o)return T.reject(new Error("End-to-end account not found"));var i,s=new L.Account;try{s.unpickle(this.accountKey,o),i=JSON.parse(s.one_time_keys());var a=s.max_number_of_one_time_keys()}finally{s.free()}var l={};for(var c in i.curve25519)i.curve25519.hasOwnProperty(c)&&(l["curve25519:"+c]=i.curve25519[c]);var u={device_keys:this.deviceKeys,one_time_keys:l},p=this;return this._http.authedRequestWithPrefix(void 0,"POST",r,void 0,u,R.PREFIX_V2_ALPHA).then(function(r){var o=Math.floor(a/2),i=r.one_time_key_counts.curve25519||0,s=o>i,l=p.sessionStore.getEndToEndAccount(),c=new L.Account;try{if(c.unpickle(p.accountKey,l),c.mark_keys_as_published(),s){var u=o-i;e&&(u=Math.min(u,e)),c.generate_one_time_keys(u)}l=c.pickle(p.accountKey),p.sessionStore.storeEndToEndAccount(l)}finally{c.free()}s&&n?p.uploadKeys(e,t):t.resolve()}),t.promise},r.prototype.downloadKeys=function(e,t){if(!O||null===this.sessionStore)return T.reject(new Error("End-to-end encryption disabled"));for(var n={},r={},o=!1,i=0;i<e.length;++i){var s=e[i];if(!t){var a=this.sessionStore.getEndToEndDevicesForUser(s);if(a){n[s]=a;continue}}o=!0,r[s]={}}var l=T.defer();if(o){var c="/keys/query",u={device_keys:r},p=this;this._http.authedRequestWithPrefix(void 0,"POST",c,void 0,u,R.PREFIX_V2_ALPHA).then(function(e){for(var t in e.device_keys)t in r&&(p.sessionStore.storeEndToEndDevicesForUser(t,e.device_keys[t]),n[t]=e.device_keys[t]);l.resolve(n)})}else l.resolve(n);return l.promise},r.prototype.listDeviceKeys=function(e){if(!O)return[];var t=this.sessionStore.getEndToEndDevicesForUser(e),n=[];if(t){var r,o=[];for(r in t)t.hasOwnProperty(r)&&o.push(r);o.sort();for(var i=0;i<o.length;++i){r=o[i];var s=t[r],a=s.keys["ed25519:"+r];a&&n.push({id:r,key:a})}}return n},r.prototype.setRoomEncryption=function(e,t){if(!this.sessionStore||!O)return T.reject(new Error("End-to-End encryption disabled"));if(t.algorithm===B){if(!t.members)throw new Error("Config must include a 'members' list with a list of userIds");for(var n=[],r=[],o=0;o<t.members.length;++o){var i=t.members[o],s=this.sessionStore.getEndToEndDevicesForUser(i);if(s){for(var a in s)if(s.hasOwnProperty(a)){var l=s[a],c=l.keys["curve25519:"+a];if(c==this.deviceCurve25519Key)continue;this.sessionStore.getEndToEndSessions(c)||n.push([i,a,c])}}else r.push(i)}var u=T.defer();if(n.length>0){var p={};for(o=0;o<n.length;++o){var d=n[o],h=p[d[0]]||{};p[d[0]]=h,h[d[1]]="curve25519"}var m="/keys/claim",f={one_time_keys:p},g=this;this._http.authedRequestWithPrefix(void 0,"POST",m,void 0,f,R.PREFIX_V2_ALPHA).done(function(e){var t={};for(o=0;o<n.length;++o){var i,s=n[o],a=e.one_time_keys[s[0]]||{},l=a[s[1]];for(var c in l)0===c.indexOf("curve25519:")&&(i=l[c]);if(i){var p=new L.Session,d=new L.Account;try{var h=g.sessionStore.getEndToEndAccount();d.unpickle(g.accountKey,h),p.create_outbound(d,s[2],i);var m=p.session_id();h=p.pickle(g.accountKey),g.sessionStore.storeEndToEndSession(s[2],m,h)}finally{p.free(),d.free()}}else t[s[0]]=t[s[0]]||[],t[s[0]].push([s[1]])}u.resolve({missingUsers:r,missingDevices:t})})}else u.resolve({missingUsers:r,missingDevices:[]});return this.sessionStore.storeEndToEndRoom(e,t),u.promise}throw new Error("Unknown algorithm: "+t.algorithm)},r.prototype.disableRoomEncryption=function(e){null!==this.sessionStore&&this.sessionStore.storeEndToEndRoom(e,null)},r.prototype.isRoomEncrypted=function(e){return O&&null!==this.sessionStore?this.sessionStore.getEndToEndRoom(e)&&!0||!1:!1},r.prototype.getRoom=function(e){return this.store.getRoom(e)},r.prototype.getRooms=function(){return this.store.getRooms()},r.prototype.getUser=function(e){return this.store.getUser(e)},r.prototype.createRoom=function(e,t){return this._http.authedRequest(t,"POST","/createRoom",void 0,e)},r.prototype.joinRoom=function(e,t,n){if(P.isFunction(t))throw new Error("Expected 'opts' object, got function.");t=t||{syncRoom:!0};var r=this.getRoom(e);if(r&&r.hasMembershipState(this.credentials.userId,"join"))return T(r);var o=P.encodeUri("/join/$roomid",{$roomid:e}),i=T.defer(),s=this;return this._http.authedRequest(void 0,"POST",o,void 0,{}).then(function(e){var n=e.room_id,r=E(s,n);return t.syncRoom?h(s,r):T(r)},function(e){b(n,i,e)}).done(function(e){C(n,i,e)},function(e){b(n,i,e)}),i.promise},r.prototype.resendEvent=function(e,t){return e.status=k.SENDING,a(this,t,e)},r.prototype.setRoomName=function(e,t,n){return this.sendStateEvent(e,"m.room.name",{name:t},void 0,n)},r.prototype.setRoomTopic=function(e,t,n){return this.sendStateEvent(e,"m.room.topic",{topic:t},void 0,n)},r.prototype.setPowerLevel=function(e,t,n,r,o){var i={users:{}};r&&"m.room.power_levels"===r.getType()&&(i=P.deepCopy(r.getContent())),i.users[t]=n;var s=P.encodeUri("/rooms/$roomId/state/m.room.power_levels",{$roomId:e});return this._http.authedRequest(o,"PUT",s,void 0,i)},r.prototype.getStateEvent=function(e,t,n,r){var o={$roomId:e,$eventType:t,$stateKey:n},i=P.encodeUri("/rooms/$roomId/state/$eventType",o);return void 0!==n&&(i=P.encodeUri(i+"/$stateKey",o)),this._http.authedRequest(r,"GET",i)},r.prototype.sendStateEvent=function(e,t,n,r,o){var i={$roomId:e,$eventType:t,$stateKey:r},s=P.encodeUri("/rooms/$roomId/state/$eventType",i);return void 0!==r&&(s=P.encodeUri(s+"/$stateKey",i)),this._http.authedRequest(o,"PUT",s,void 0,n)},r.prototype.sendEvent=function(e,t,n,r,i){P.isFunction(r)&&(i=r,r=void 0),r||(r="m"+(new Date).getTime());var s=this.getRoom(e),l=new I({event_id:"~"+e+":"+r,user_id:this.credentials.userId,room_id:e,type:t,origin_server_ts:(new Date).getTime(),content:n});if(l._txnId=r,s&&(l.status=k.SENDING,s.addEventsToTimeline([l])),"m.room.message"===t&&this.sessionStore&&O){var c=this.sessionStore.getEndToEndRoom(e);if(c){var u=o(this,e,c,t,n,r,i);l.encryptedType="m.room.encrypted",l.encryptedContent=u}l.encrypted=!0}return a(this,s,l,i)},r.prototype.sendMessage=function(e,t,n,r){return P.isFunction(n)&&(r=n,n=void 0),this.sendEvent(e,"m.room.message",t,n,r)},r.prototype.sendTextMessage=function(e,t,n,r){var o={msgtype:"m.text",body:t};return this.sendMessage(e,o,n,r)},r.prototype.sendNotice=function(e,t,n,r){var o={msgtype:"m.notice",body:t};return this.sendMessage(e,o,n,r)},r.prototype.sendEmoteMessage=function(e,t,n,r){var o={msgtype:"m.emote",body:t};return this.sendMessage(e,o,n,r)},r.prototype.sendImageMessage=function(e,t,n,r,o){P.isFunction(r)&&(o=r,r=void 0),r||(r="Image");var i={msgtype:"m.image",url:t,info:n,body:r};return this.sendMessage(e,i,o)},r.prototype.sendHtmlMessage=function(e,t,n,r){var o={msgtype:"m.text",format:"org.matrix.custom.html",body:t,formatted_body:n};return this.sendMessage(e,o,r)},r.prototype.sendHtmlNotice=function(e,t,n,r){var o={msgtype:"m.notice",format:"org.matrix.custom.html",body:t,formatted_body:n};return this.sendMessage(e,o,r)},r.prototype.sendReceipt=function(e,t,n){var r=P.encodeUri("/rooms/$roomId/receipt/$receiptType/$eventId",{$roomId:e.getRoomId(),$receiptType:t,$eventId:e.getId()});return this._http.authedRequestWithPrefix(n,"POST",r,void 0,{},R.PREFIX_V2_ALPHA)},r.prototype.sendReadReceipt=function(e,t){return this.sendReceipt(e,"m.read",t)},r.prototype.uploadContent=function(e,t){return this._http.uploadContent(e,t)},r.prototype.sendTyping=function(e,t,n,r){var o=P.encodeUri("/rooms/$roomId/typing/$userId",{$roomId:e,$userId:this.credentials.userId}),i={typing:t};return t&&(i.timeout=n?n:2e4),this._http.authedRequest(r,"PUT",o,void 0,i)},r.prototype.createAlias=function(e,t,n){var r=P.encodeUri("/directory/room/$alias",{$alias:e}),o={room_id:t};return this._http.authedRequest(n,"PUT",r,void 0,o)},r.prototype.getRoomIdForAlias=function(e,t){var n=P.encodeUri("/directory/room/$alias",{$alias:e});return this._http.authedRequest(t,"GET",n)},r.prototype.redactEvent=function(e,t,n){var r=P.encodeUri("/rooms/$roomId/redact/$eventId",{$roomId:e,$eventId:t});return this._http.authedRequest(n,"POST",r,void 0,{})},r.prototype.invite=function(e,t,n){return u(this,e,t,"invite",void 0,n)},r.prototype.leave=function(e,t){return u(this,e,void 0,"leave",void 0,t)},r.prototype.ban=function(e,t,n,r){return u(this,e,t,"ban",n,r)},r.prototype.unban=function(e,t,n){return c(this,e,t,"leave",void 0,n)},r.prototype.kick=function(e,t,n,r){return c(this,e,t,"leave",n,r)},r.prototype.getPushActionsForEvent=function(e){if(void 0===e._pushActions){var t=new w(this);e._pushActions=t.actionsForEvent(e.event)}return e._pushActions},r.prototype.getProfileInfo=function(e,t,n){P.isFunction(t)&&(n=t,t=void 0);var r=t?P.encodeUri("/profile/$userId/$info",{$userId:e,$info:t}):P.encodeUri("/profile/$userId",{$userId:e});return this._http.authedRequest(n,"GET",r)},r.prototype.setProfileInfo=function(e,t,n){var r=P.encodeUri("/profile/$userId/$info",{$userId:this.credentials.userId,$info:e});return this._http.authedRequest(n,"PUT",r,void 0,t)},r.prototype.setDisplayName=function(e,t){return this.setProfileInfo("displayname",{displayname:e},t)},r.prototype.setAvatarUrl=function(e,t){return this.setProfileInfo("avatar_url",{avatar_url:e},t)},r.prototype.mxcUrlToHttp=function(e,t,n,r){return U.getHttpUriForMxc(this.baseUrl,e,t,n,r)},r.prototype.getThreePids=function(e){var t="/account/3pid";return this._http.authedRequestWithPrefix(e,"GET",t,void 0,void 0,R.PREFIX_V2_ALPHA)},r.prototype.addThreePid=function(e,t,n){var r="/account/3pid",o={threePidCreds:e,bind:t};return this._http.authedRequestWithPrefix(n,"POST",r,null,o,R.PREFIX_V2_ALPHA)},r.prototype.setPassword=function(e,t,n){var r="/account/password",o={
auth:e,new_password:t};return this._http.authedRequestWithPrefix(n,"POST",r,null,o,R.PREFIX_V2_ALPHA)},r.prototype.setPresence=function(e,t){var n=P.encodeUri("/presence/$userId/status",{$userId:this.credentials.userId}),r=["offline","online","unavailable"];if(-1==r.indexOf(e))throw new Error("Bad presence value: "+e);var o={presence:e};return this._http.authedRequest(t,"PUT",n,void 0,o)},r.prototype.publicRooms=function(e){return this._http.request(e,"GET","/publicRooms")},r.prototype.loginFlows=function(e){return this._http.request(e,"GET","/login")},r.prototype.resolveRoomAlias=function(e,t){var n=P.encodeUri("/directory/room/$alias",{$alias:e});return this._http.request(t,"GET",n)},r.prototype.roomInitialSync=function(e,t,n){P.isFunction(t)&&(n=t,t=void 0);var r=P.encodeUri("/rooms/$roomId/initialSync",{$roomId:e});return t||(t=30),this._http.authedRequest(n,"GET",r,{limit:t})},r.prototype.roomState=function(e,t){var n=P.encodeUri("/rooms/$roomId/state",{$roomId:e});return this._http.authedRequest(t,"GET",n)},r.prototype.scrollback=function(e,t,n){if(P.isFunction(t)&&(n=t,t=void 0),t=t||30,null===e.oldState.paginationToken)return T(e);var r=this.store.scrollback(e,t).length;if(r===t)return T(e);t-=r;var o=P.encodeUri("/rooms/$roomId/messages",{$roomId:e.roomId}),i={from:e.oldState.paginationToken,limit:t,dir:"b"},s=T.defer(),a=this;return this._http.authedRequest(n,"GET",o,i).done(function(r){var o=P.map(r.chunk,x(a));e.addEventsToTimeline(o,!0),e.oldState.paginationToken=r.end,r.chunk.length<t&&(e.oldState.paginationToken=null),a.store.storeEvents(e,o,r.end,!0),C(n,s,e)},function(e){b(n,s,e)}),s.promise},r.prototype.login=function(e,t,n){return t.type=e,this._http.authedRequest(n,"POST","/login",void 0,t)},r.prototype.register=function(e,t,n,r,o){void 0===r&&(r={}),n&&(r.session=n);var i={auth:r};return void 0!==e&&(i.username=e),void 0!==t&&(i.password=t),this._http.requestWithPrefix(o,"POST","/register",void 0,i,R.PREFIX_V2_ALPHA)},r.prototype.loginWithPassword=function(e,t,n){return this.login("m.login.password",{user:e,password:t},n)},r.prototype.loginWithSAML2=function(e,t){return this.login("m.login.saml2",{relay_state:e},t)},r.prototype.getCasServer=function(e){return this._http.request(e,"GET","/login/cas",void 0,void 0)},r.prototype.loginWithCas=function(e,t,n){return this.login("m.login.cas",{ticket:e,service:t},n)},r.prototype.pushRules=function(e){return this._http.authedRequest(e,"GET","/pushrules/")},r.prototype.addPushRule=function(e,t,n,r,o){var i=P.encodeUri("/pushrules/"+e+"/$kind/$ruleId",{$kind:t,$ruleId:n});return this._http.authedRequest(o,"PUT",i,void 0,r)},r.prototype.deletePushRule=function(e,t,n,r){var o=P.encodeUri("/pushrules/"+e+"/$kind/$ruleId",{$kind:t,$ruleId:n});return this._http.authedRequest(r,"DELETE",o)},r.prototype.searchMessageText=function(e,t){return this.search({body:{search_categories:{room_events:{keys:e.keys,search_term:e.query}}}},t)},r.prototype.search=function(e,t){return this._http.authedRequest(t,"POST","/search",void 0,e.body)},r.prototype.turnServer=function(e){return this._http.authedRequest(e,"GET","/voip/turnServer")},r.prototype.getTurnServers=function(){return this._turnServers||[]},r.prototype.isLoggedIn=function(){return void 0!==this._http.opts.accessToken},r.prototype.startClient=function(e){if(!this.clientRunning){if("number"==typeof e&&(e={initialSyncLimit:e}),e=e||{},e.initialSyncLimit=e.initialSyncLimit||8,e.includeArchivedRooms=e.includeArchivedRooms||!1,e.resolveInvitesToProfiles=e.resolveInvitesToProfiles||!1,this._config=e,O&&null!==this.sessionStore&&this.uploadKeys(5),this.store.getSyncToken())return void d(this);y(this);var t=this;this.pushRules().done(function(n){t.pushRules=n,p(t,e.initialSyncLimit,e.includeArchivedRooms)},function(e){t.emit("syncError",e)})}},r.prototype.stopClient=function(){this.clientRunning=!1},r.prototype.requestEmailToken=function(e,t,n,r,o){var i={client_secret:t,email:e,send_attempt:n,next_link:r};return this._http.idServerRequest(o,"POST","/validate/email/requestToken",i,R.PREFIX_IDENTITY_V1)},r.prototype.generateClientSecret=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;32>n;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},e.exports.MatrixClient=r,e.exports.CRYPTO_ENABLED=O},function(e,t,n){"use strict";function r(e,t){this.roomId=e,this.userId=t,this.typing=!1,this.name=t,this.powerLevel=0,this.powerLevelNorm=0,this.user=null,this.membership=null,this.events={member:null},this._updateModifiedTime()}function o(e,t,n){var r=t.getDirectionalContent().displayname,o=e.userId;if(!r)return o;if(!n)return r;var i=n.getUserIdsWithDisplayName(r),s=i.filter(function(e){return e!==o});return s.length>0?r+" ("+o+")":r}var i=n(32).EventEmitter,s=n(42),a=n(11);a.inherits(r,i),r.prototype.setMembershipEvent=function(e,t){if("m.room.member"===e.getType()){this.events.member=e;var n=this.membership;this.membership=e.getDirectionalContent().membership;var r=this.name;this.name=o(this,e,t),n!==this.membership&&(this._updateModifiedTime(),this.emit("RoomMember.membership",e,this)),r!==this.name&&(this._updateModifiedTime(),this.emit("RoomMember.name",e,this))}},r.prototype.setPowerLevelEvent=function(e){if("m.room.power_levels"===e.getType()){var t=e.getContent().users_default||0;a.forEach(a.values(e.getContent().users),function(e){t=Math.max(t,e)});var n=this.powerLevel,r=this.powerLevelNorm;this.powerLevel=e.getContent().users[this.userId]||e.getContent().users_default||0,this.powerLevelNorm=0,t>0&&(this.powerLevelNorm=100*this.powerLevel/t),(n!==this.powerLevel||r!==this.powerLevelNorm)&&(this._updateModifiedTime(),this.emit("RoomMember.powerLevel",e,this))}},r.prototype.setTypingEvent=function(e){if("m.typing"===e.getType()){var t=this.typing;this.typing=!1;var n=e.getContent().user_ids;a.isArray(n)&&(-1!==n.indexOf(this.userId)&&(this.typing=!0),t!==this.typing&&(this._updateModifiedTime(),this.emit("RoomMember.typing",e,this)))}},r.prototype._updateModifiedTime=function(){this._modified=Date.now()},r.prototype.getLastModifiedTime=function(){return this._modified},r.prototype.getAvatarUrl=function(e,t,n,r,o){if(void 0===o&&(o=!0),!this.events.member&&!o)return null;var i=this.events.member?this.events.member.getContent().avatar_url:null;return i?s.getHttpUriForMxc(e,i,t,n,r):o?s.getIdenticonUri(e,this.userId,t,n):null},e.exports=r},function(e,t,n){"use strict";function r(e){this.roomId=e,this.members={},this.events={},this.paginationToken=null,this._sentinels={},this._updateModifiedTime(),this._displayNameToUserIds={},this._userIdsToDisplayNames={}}function o(e,t,n){var r=e._userIdsToDisplayNames[t];if(delete e._userIdsToDisplayNames[t],r){for(var o=e._displayNameToUserIds[r]||[],i=0;i<o.length;i++)o[i]===t&&(o.splice(i,1),i--);e._displayNameToUserIds[r]=o}e._userIdsToDisplayNames[t]=n,e._displayNameToUserIds[n]||(e._displayNameToUserIds[n]=[]),e._displayNameToUserIds[n].push(t)}var i=n(32).EventEmitter,s=n(11),a=n(90);s.inherits(r,i),r.prototype.getMembers=function(){return s.values(this.members)},r.prototype.getMember=function(e){return this.members[e]||null},r.prototype.getSentinelMember=function(e){return this._sentinels[e]||null},r.prototype.getStateEvents=function(e,t){if(!this.events[e])return void 0===t?[]:null;if(void 0===t)return s.values(this.events[e]);var n=this.events[e][t];return n?n:null},r.prototype.setStateEvents=function(e){var t=this;this._updateModifiedTime(),s.forEach(e,function(e){e.getRoomId()===t.roomId&&e.isState()&&(void 0===t.events[e.getType()]&&(t.events[e.getType()]={}),t.events[e.getType()][e.getStateKey()]=e,"m.room.member"===e.getType()&&o(t,e.getStateKey(),e.getContent().displayname),t.emit("RoomState.events",e,t))}),s.forEach(e,function(e){if(e.getRoomId()===t.roomId&&e.isState())if("m.room.member"===e.getType()){var n=e.getStateKey(),r=t.members[n];r||(r=new a(e.getRoomId(),n),t.emit("RoomState.newMember",e,t,r));var o=new a(e.getRoomId(),n);s.forEach([r,o],function(n){n.setMembershipEvent(e,t);var r=t.getStateEvents("m.room.power_levels","");r&&n.setPowerLevelEvent(r)}),t._sentinels[n]=o,t.members[n]=r,t.emit("RoomState.members",e,t,r)}else if("m.room.power_levels"===e.getType()){var i=s.values(t.members);s.forEach(i,function(t){t.setPowerLevelEvent(e)})}})},r.prototype.setTypingEvent=function(e){s.forEach(s.values(this.members),function(t){t.setTypingEvent(e)})},r.prototype._updateModifiedTime=function(){this._modified=Date.now()},r.prototype.getLastModifiedTime=function(){return this._modified},r.prototype.getUserIdsWithDisplayName=function(e){return this._displayNameToUserIds[e]||[]},e.exports=r},function(e,t,n){(function(t){"use strict";function r(e){this.roomId=e.roomId,this.client=e.client,this.webRtc=e.webRtc,this.URL=e.URL,this.turnServers=e.turnServers||[],0===this.turnServers.length&&this.turnServers.push({urls:[r.FALLBACK_STUN_SERVER]}),o.forEach(this.turnServers,function(e){o.checkObjectHasKeys(e,["urls"])}),this.callId="c"+(new Date).getTime(),this.state="fledgling",this.didConnect=!1,this.candidateSendQueue=[],this.candidateSendTries=0,this.screenSharingStream=null}var o=n(11),i=n(32).EventEmitter,s=!0;r.CALL_TIMEOUT_MS=6e4,r.FALLBACK_STUN_SERVER="stun:stun.l.google.com:19302",r.ERR_LOCAL_OFFER_FAILED="local_offer_failed",r.ERR_NO_USER_MEDIA="no_user_media",o.inherits(r,i),r.prototype.placeVoiceCall=function(){y("placeVoiceCall"),g(this),E(this,x("voice")),this.type="voice"},r.prototype.placeVideoCall=function(e,t){y("placeVideoCall"),g(this),this.localVideoElement=t,this.remoteVideoElement=e,E(this,x("video")),this.type="video",m(this)},r.prototype.placeScreenSharingCall=function(e,t){y("placeScreenSharingCall"),g(this);var n=C(this);if(n){this.localVideoElement=t,this.remoteVideoElement=e;var o=this;this.webRtc.getUserMedia(n,function(e){o.screenSharingStream=e,y("Got screen stream, requesting audio stream...");var t=x("voice");E(o,t)},function(e){o.emit("error",v(r.ERR_NO_USER_MEDIA,"Failed to get screen-sharing stream: "+e))}),this.type="video",m(this)}},r.prototype.getLocalVideoElement=function(){return this.localVideoElement},r.prototype.getRemoteVideoElement=function(){return this.remoteVideoElement},r.prototype.getRemoteAudioElement=function(){return this.remoteAudioElement},r.prototype.setLocalVideoElement=function(e){if(this.localVideoElement=e,e&&this.localAVStream&&"video"===this.type){e.autoplay=!0,e.src=this.URL.createObjectURL(this.localAVStream),e.muted=!0;var t=this;setTimeout(function(){var e=t.getLocalVideoElement();e.play&&e.play()},0)}},r.prototype.setRemoteVideoElement=function(e){this.remoteVideoElement=e,m(this)},r.prototype.setRemoteAudioElement=function(e){this.remoteAudioElement=e,f(this)},r.prototype._initWithInvite=function(e){this.msg=e.getContent(),this.peerConn=b(this);var t=this;this.peerConn&&this.peerConn.setRemoteDescription(new this.webRtc.RtcSessionDescription(this.msg.offer),w(t,t._onSetRemoteDescriptionSuccess),w(t,t._onSetRemoteDescriptionError)),c(this,"ringing"),this.direction="inbound",this.msg.offer&&this.msg.offer.sdp&&this.msg.offer.sdp.indexOf("m=video")>-1?this.type="video":this.type="voice",e.getAge()&&setTimeout(function(){"ringing"==t.state&&(y("Call invite has expired. Hanging up."),t.hangupParty="remote",c(t,"ended"),h(t),"closed"!=t.peerConn.signalingState&&t.peerConn.close(),t.emit("hangup",t))},this.msg.lifetime-e.getAge())},r.prototype._initWithHangup=function(e){this.msg=e.getContent(),c(this,"ended")},r.prototype.answer=function(){y("Answering call %s of type %s",this.callId,this.type);var e=this;this.localAVStream||this.waitForLocalAVStream?this.localAVStream?this._gotUserMediaForAnswer(this.localAVStream):this.waitForLocalAVStream&&c(this,"wait_local_media"):(this.webRtc.getUserMedia(x(this.type),w(e,e._gotUserMediaForAnswer),w(e,e._getUserMediaFailed)),c(this,"wait_local_media"))},r.prototype._replacedBy=function(e){y(this.callId+" being replaced by "+e.callId),"wait_local_media"==this.state?(y("Telling new call to wait for local media"),e.waitForLocalAVStream=!0):"create_offer"==this.state?(y("Handing local stream to new call"),e._gotUserMediaForAnswer(this.localAVStream),delete this.localAVStream):"invite_sent"==this.state&&(y("Handing local stream to new call"),e._gotUserMediaForAnswer(this.localAVStream),delete this.localAVStream),e.localVideoElement=this.localVideoElement,e.remoteVideoElement=this.remoteVideoElement,e.remoteAudioElement=this.remoteAudioElement,this.successor=e,this.emit("replaced",e),this.hangup(!0)},r.prototype.hangup=function(e,t){y("Ending call "+this.callId),d(this,"local",e,!t);var n={version:0,call_id:this.callId,reason:e};u(this,"m.call.hangup",n)},r.prototype.setLocalVideoMuted=function(e){this.localAVStream&&a(this.localAVStream.getVideoTracks(),!e)},r.prototype.isLocalVideoMuted=function(){return this.localAVStream?!l(this.localAVStream.getVideoTracks()):!1},r.prototype.setMicrophoneMuted=function(e){this.localAVStream&&a(this.localAVStream.getAudioTracks(),!e)},r.prototype.isMicrophoneMuted=function(){return this.localAVStream?!l(this.localAVStream.getAudioTracks()):!1},r.prototype._gotUserMediaForInvite=function(e){if(this.successor)return void this.successor._gotUserMediaForAnswer(e);if("ended"!=this.state){y("_gotUserMediaForInvite -> "+this.type);var t=this,n=this.getLocalVideoElement();n&&"video"==this.type&&(n.autoplay=!0,this.screenSharingStream?(y("Setting screen sharing stream to the local video element"),n.src=this.URL.createObjectURL(this.screenSharingStream)):n.src=this.URL.createObjectURL(e),n.muted=!0,setTimeout(function(){var e=t.getLocalVideoElement();e.play&&e.play()},0)),this.localAVStream=e,a(e.getAudioTracks(),!0),this.peerConn=b(this),this.peerConn.addStream(e),this.screenSharingStream&&(console.log("Adding screen-sharing stream to peer connection"),this.peerConn.addStream(this.screenSharingStream),this.localAVStream=this.screenSharingStream),this.peerConn.createOffer(w(t,t._gotLocalOffer),w(t,t._getLocalOfferFailed)),c(t,"create_offer")}},r.prototype._gotUserMediaForAnswer=function(e){var t=this;if("ended"!=t.state){var n=t.getLocalVideoElement();n&&"video"==t.type&&(n.autoplay=!0,n.src=t.URL.createObjectURL(e),n.muted=!0,setTimeout(function(){var e=t.getLocalVideoElement();e.play&&e.play()},0)),t.localAVStream=e,a(e.getAudioTracks(),!0),t.peerConn.addStream(e);var r={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:"video"==t.type}};t.peerConn.createAnswer(function(e){y("Created answer: "+e),t.peerConn.setLocalDescription(e,function(){var e={version:0,call_id:t.callId,answer:{sdp:t.peerConn.localDescription.sdp,type:t.peerConn.localDescription.type}};u(t,"m.call.answer",e),c(t,"connecting")},function(){y("Error setting local description!")},r)},function(e){y("Failed to create answer: "+e)}),c(t,"create_answer")}},r.prototype._gotLocalIceCandidate=function(e){if(e.candidate){y("Got local ICE "+e.candidate.sdpMid+" candidate: "+e.candidate.candidate);var t={candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex};p(this,t)}},r.prototype._gotRemoteIceCandidate=function(e){"ended"!=this.state&&(y("Got remote ICE "+e.sdpMid+" candidate: "+e.candidate),this.peerConn.addIceCandidate(new this.webRtc.RtcIceCandidate(e),function(){},function(e){}))},r.prototype._receivedAnswer=function(e){if("ended"!=this.state){var t=this;this.peerConn.setRemoteDescription(new this.webRtc.RtcSessionDescription(e.answer),w(t,t._onSetRemoteDescriptionSuccess),w(t,t._onSetRemoteDescriptionError)),c(t,"connecting")}},r.prototype._gotLocalOffer=function(e){var t=this;return y("Created offer: "+e),"ended"==t.state?void y("Ignoring newly created offer on call ID "+t.callId+" because the call has ended"):void t.peerConn.setLocalDescription(e,function(){var e={version:0,call_id:t.callId,offer:{sdp:t.peerConn.localDescription.sdp,type:t.peerConn.localDescription.type},lifetime:r.CALL_TIMEOUT_MS};u(t,"m.call.invite",e),setTimeout(function(){"invite_sent"==t.state&&t.hangup("invite_timeout")},r.CALL_TIMEOUT_MS),c(t,"invite_sent")},function(){y("Error setting local description!")})},r.prototype._getLocalOfferFailed=function(e){this.emit("error",v(r.ERR_LOCAL_OFFER_FAILED,"Failed to start audio for call!"))},r.prototype._getUserMediaFailed=function(e){this.emit("error",v(r.ERR_NO_USER_MEDIA,"Couldn't start capturing media! Is your microphone set up and does this app have permission?")),this.hangup("user_media_failed")},r.prototype._onIceConnectionStateChanged=function(){"ended"!=this.state&&(y("Ice connection state changed to: "+this.peerConn.iceConnectionState),"completed"==this.peerConn.iceConnectionState||"connected"==this.peerConn.iceConnectionState?(c(this,"connected"),this.didConnect=!0):"failed"==this.peerConn.iceConnectionState&&this.hangup("ice_failed"))},r.prototype._onSignallingStateChanged=function(){y("call "+this.callId+": Signalling state changed to: "+this.peerConn.signalingState)},r.prototype._onSetRemoteDescriptionSuccess=function(){y("Set remote description")},r.prototype._onSetRemoteDescriptionError=function(e){y("Failed to set remote description"+e)},r.prototype._onAddStream=function(e){y("Stream id "+e.stream.id+" added");var t=e.stream;t.getVideoTracks().length>0?(this.type="video",this.remoteAVStream=t):(this.type="voice",this.remoteAStream=t);var n=this;R(t,function(e){y("Track id "+e.id+" added"),e.onstarted=w(n,n._onRemoteStreamTrackStarted)}),e.stream.onended=w(n,n._onRemoteStreamEnded),e.stream.onstarted=w(n,n._onRemoteStreamStarted),"video"===this.type?m(this):f(this)},r.prototype._onRemoteStreamStarted=function(e){c(this,"connected")},r.prototype._onRemoteStreamEnded=function(e){y("Remote stream ended"),this.hangupParty="remote",c(this,"ended"),h(this),"closed"!=this.peerConn.signalingState&&this.peerConn.close(),this.emit("hangup",this)},r.prototype._onRemoteStreamTrackStarted=function(e){c(this,"connected")},r.prototype._onHangupReceived=function(e){y("Hangup received"),d(this,"remote",e.reason,!0)},r.prototype._onAnsweredElsewhere=function(e){y("Answered elsewhere"),d(this,"remote","answered_elsewhere",!0)};var a=function(e,t){for(var n=0;n<e.length;n++)e[n].enabled=t},l=function(e){for(var t=0;t<e.length;t++)if(e[t].enabled)return!0;return!1},c=function(e,t){var n=e.state;e.state=t,e.emit("state",t,n)},u=function(e,t,n){return e.client.sendEvent(e.roomId,t,n)},p=function(e,t){e.candidateSendQueue.push(t),0===e.candidateSendTries&&setTimeout(function(){_(e)},100)},d=function(e,t,n,r){e.getRemoteVideoElement()&&(e.getRemoteVideoElement().pause&&e.getRemoteVideoElement().pause(),e.getRemoteVideoElement().src=""),e.getRemoteAudioElement()&&(e.getRemoteAudioElement().pause&&e.getRemoteAudioElement().pause(),e.getRemoteAudioElement().src=""),e.getLocalVideoElement()&&(e.getLocalVideoElement().pause&&e.getLocalVideoElement().pause(),e.getLocalVideoElement().src=""),e.hangupParty=t,e.hangupReason=n,c(e,"ended"),h(e),e.peerConn&&"closed"!==e.peerConn.signalingState&&e.peerConn.close(),r&&e.emit("hangup",e)},h=function(e){y("stopAllMedia (stream=%s)",e.localAVStream),e.localAVStream&&(R(e.localAVStream,function(e){e.stop&&e.stop()}),e.localAVStream.stop&&e.localAVStream.stop()),e.screenSharingStream&&(R(e.screenSharingStream,function(e){e.stop&&e.stop()}),e.screenSharingStream.stop&&e.screenSharingStream.stop()),e.remoteAVStream&&R(e.remoteAVStream,function(e){e.stop&&e.stop()}),e.remoteAStream&&R(e.remoteAStream,function(e){e.stop&&e.stop()})},m=function(e){if(e.getRemoteVideoElement()&&e.remoteAVStream){var t=e.getRemoteVideoElement();t.autoplay=!0,t.src=e.URL.createObjectURL(e.remoteAVStream),setTimeout(function(){var t=e.getRemoteVideoElement();t.play&&t.play(),e.webRtc.isOpenWebRTC()&&c(e,"connected")},0)}},f=function(e){if(e.getRemoteAudioElement()&&e.remoteAStream){var t=e.getRemoteAudioElement();t.autoplay=!0,t.src=e.URL.createObjectURL(e.remoteAStream),setTimeout(function(){var t=e.getRemoteAudioElement();t.play&&t.play(),e.webRtc.isOpenWebRTC()&&c(e,"connected")},0)}},g=function(e){if(0===e.listeners("error").length)throw new Error("You MUST attach an error listener using call.on('error', function() {})")},v=function(e,t){var n=new Error(t);return n.code=e,n},y=function(){s&&console.log.apply(console,arguments)},_=function(e){if(0!==e.candidateSendQueue.length){var t=e.candidateSendQueue;e.candidateSendQueue=[],++e.candidateSendTries;var n={version:0,call_id:e.callId,candidates:t};y("Attempting to send "+t.length+" candidates"),u(e,"m.call.candidates",n).then(function(){e.candidateSendTries=0,_(e)},function(n){for(var r=0;r<t.length;r++)e.candidateSendQueue.push(t[r]);if(e.candidateSendTries>5)return y("Failed to send candidates on attempt %s. Giving up for now.",e.candidateSendTries),void(e.candidateSendTries=0);var o=500*Math.pow(2,e.candidateSendTries);++e.candidateSendTries,y("Failed to send candidates. Retrying in "+o+"ms"),setTimeout(function(){_(e)},o)})}},E=function(e,t){e.client.callList[e.callId]=e,e.webRtc.getUserMedia(t,w(e,e._gotUserMediaForInvite),w(e,e._getUserMediaFailed)),c(e,"wait_local_media"),e.direction="outbound",e.config=t},b=function(e){var t=e.turnServers;if("mozilla"===e.webRtc.vendor){t=[];for(var n=0;n<e.turnServers.length;n++)for(var r=0;r<e.turnServers[n].urls.length;r++)t.push({url:e.turnServers[n].urls[r],username:e.turnServers[n].username,credential:e.turnServers[n].credential})}var o=new e.webRtc.RtcPeerConnection({iceServers:t});return o.oniceconnectionstatechange=w(e,e._onIceConnectionStateChanged),o.onsignalingstatechange=w(e,e._onSignallingStateChanged),o.onicecandidate=w(e,e._gotLocalIceCandidate),o.onaddstream=w(e,e._onAddStream),o},C=function(e){var n=t.screen;return n?t.window&&"https:"===t.window.location.protocol?{video:{mandatory:{chromeMediaSource:"screen",chromeMediaSourceId:""+Date.now(),maxWidth:n.width,maxHeight:n.height,minFrameRate:1,maxFrameRate:10}}}:void e.emit("error",v(r.ERR_NO_USER_MEDIA,"You need to be using HTTPS to place a screen-sharing call.")):void e.emit("error",v(r.ERR_NO_USER_MEDIA,"Couldn't determine screen sharing constaints."))},x=function(e){switch(e){case"voice":return{audio:!0,video:!1};case"video":return{audio:!0,video:{mandatory:{minWidth:640,maxWidth:640,minHeight:360,maxHeight:360}}}}},w=function(e,t){return function(){return t.apply(e,arguments)}},S=function(e,t){for(var n=e.getVideoTracks(),r=0;r<n.length;r++)t(n[r])},T=function(e,t){for(var n=e.getAudioTracks(),r=0;r<n.length;r++)t(n[r])},R=function(e,t){S(e,t),T(e,t)};e.exports.MatrixCall=r,e.exports.createNewMatrixCall=function(e,n){var o=t.window,i=t.document;if(!o||!i)return null;var s={};s.isOpenWebRTC=function(){var e=i.getElementById("script");if(!e||!e.length)return!1;for(var t=0;t<e.length;t++)if(e[t].src.indexOf("owr.js")>-1)return!0;return!1};var a=o.navigator.getUserMedia||o.navigator.webkitGetUserMedia||o.navigator.mozGetUserMedia;if(a&&(s.getUserMedia=function(){return a.apply(o.navigator,arguments)}),s.RtcPeerConnection=o.RTCPeerConnection||o.webkitRTCPeerConnection||o.mozRTCPeerConnection,s.RtcSessionDescription=o.RTCSessionDescription||o.webkitRTCSessionDescription||o.mozRTCSessionDescription,s.RtcIceCandidate=o.RTCIceCandidate||o.webkitRTCIceCandidate||o.mozRTCIceCandidate,s.vendor=null,o.mozRTCPeerConnection?s.vendor="mozilla":o.webkitRTCPeerConnection?s.vendor="webkit":o.RTCPeerConnection&&(s.vendor="generic"),!(s.RtcIceCandidate&&s.RtcSessionDescription&&s.RtcPeerConnection&&s.getUserMedia))return null;var l={webRtc:s,client:e,URL:o.URL,roomId:n,turnServers:e.getTurnServers()};return new r(l)}}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(){var e=o.parse(window.location.href);return e.protocol+"//"+e.host+e.pathname}var o=n(333);e.exports={getServiceUrl:r}},function(e,t){"use strict";e.exports={getCanonicalAliasForRoom:function(e){for(var t=e.currentState.getStateEvents("m.room.aliases"),n=0;n<t.length;n++){var r=t[n].getContent().aliases;if(r&&r.length)return r[0]}return null},getRoomForAlias:function(e,t){for(var n,r=0;r<e.length;r++){for(var o=e[r].currentState.getStateEvents("m.room.aliases"),i=0;i<o.length;i++){for(var s=o[i].getContent().aliases||[],a=0;a<s.length;a++)if(s[a]===t){n=e[r];break}if(n)break}if(n)break}return n||null}}},function(e,t){(function(t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e),this.modules={}}return r(e,[{key:"getModule",value:function(e){var t=this.getModuleOrNull(e);if(null===t)throw new Error("No such module: "+e);return t}},{key:"getModuleOrNull",value:function(e){if(this.modules=={})throw new Error("Attempted to get a module before a skin has been loaded.This is probably because a component has called getModule at the root level.");var t=this.modules[e];return t?t:null}},{key:"hasModule",value:function(e){var t=this.getModuleOrNull(e);return null!==t}},{key:"loadModule",value:function(e){if(!e.slot)throw new Error("Attempted to load something that is not a module (does not have a slot name)");if(void 0!==this.modules[e.slot])throw new Error("Cannot load module: slot '"+e.slot+"' is occupied!");this.modules[e.slot]=e}},{key:"reset",value:function(){for(var e=Object.keys(this.modules),t=0;t<e.length;++t){var n=e[t],r=this.modules[n];r.stop&&r.stop()}this.modules={}}},{key:"getConferenceHandler",value:function(){return this.getModule("conference")}},{key:"hasConferenceHandler",value:function(){return this.hasModule("conference")}}]),e}();void 0===t.mxModulator&&(t.mxModulator=new o),e.exports=t.mxModulator}).call(t,function(){return this}())},function(e,t){"use strict";function n(e){return e.timeline.length?e.timeline[e.timeline.length-1].getTs():Number.MAX_SAFE_INTEGER}function r(e){return e.sort(function(e,t){return n(t)-n(e)})}e.exports={mostRecentActivityFirst:r}},function(e,t){"use strict";function n(e,t,n){return n=n.slice(0),n.push(e.credentials.userId),e.downloadKeys(n,"forceDownload").then(function(r){return e.setRoomEncryption(t,{algorithm:"m.olm.v1.curve25519-aes-sha2",members:n})})}function r(e,t){return e.disableRoomEncryption(t)}e.exports={enableEncryption:n,disableEncryption:r}},function(e,t){"use strict";function n(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var r={boxFlex:!0,boxFlexGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0},o=["Webkit","ms","Moz","O"];Object.keys(r).forEach(function(e){o.forEach(function(t){r[n(t,e)]=r[e]})});var i={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}},s={isUnitlessNumber:r,shorthandPropertyExpansions:i};e.exports=s},function(e,t,n){"use strict";var r=n(98),o=n(9),i=(n(302),n(306)),s=n(313),a=n(316),l=(n(8),a(function(e){return s(e)})),c="cssFloat";o.canUseDOM&&void 0===document.documentElement.style.cssFloat&&(c="styleFloat");var u={createMarkupForStyles:function(e){var t="";for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];null!=r&&(t+=l(n)+":",t+=i(n,r)+";")}return t||null},setValueForStyles:function(e,t){var n=e.style;for(var o in t)if(t.hasOwnProperty(o)){var s=i(o,t[o]);if("float"===o&&(o=c),s)n[o]=s;else{var a=r.shorthandPropertyExpansions[o];if(a)for(var l in a)n[l]="";else n[o]=""}}}};e.exports=u},function(e,t,n){"use strict";function r(){if(a)for(var e in l){var t=l[e],n=a.indexOf(e);if(s(n>-1),!c.plugins[n]){s(t.extractEvents),c.plugins[n]=t;var r=t.eventTypes;for(var i in r)s(o(r[i],t,i))}}}function o(e,t,n){s(!c.eventNameDispatchConfigs.hasOwnProperty(n)),c.eventNameDispatchConfigs[n]=e;var r=e.phasedRegistrationNames;if(r){for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];i(a,t,n)}return!0}return e.registrationName?(i(e.registrationName,t,n),!0):!1}function i(e,t,n){s(!c.registrationNameModules[e]),c.registrationNameModules[e]=t,c.registrationNameDependencies[e]=t.eventTypes[n].dependencies}var s=n(4),a=null,l={},c={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(e){s(!a),a=Array.prototype.slice.call(e),r()},injectEventPluginsByName:function(e){var t=!1;for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];l.hasOwnProperty(n)&&l[n]===o||(s(!l[n]),l[n]=o,t=!0)}t&&r()},getPluginModuleForEvent:function(e){var t=e.dispatchConfig;if(t.registrationName)return c.registrationNameModules[t.registrationName]||null;for(var n in t.phasedRegistrationNames)if(t.phasedRegistrationNames.hasOwnProperty(n)){var r=c.registrationNameModules[t.phasedRegistrationNames[n]];if(r)return r}return null},_resetEventPlugins:function(){a=null;for(var e in l)l.hasOwnProperty(e)&&delete l[e];c.plugins.length=0;var t=c.eventNameDispatchConfigs;for(var n in t)t.hasOwnProperty(n)&&delete t[n];var r=c.registrationNameModules;for(var o in r)r.hasOwnProperty(o)&&delete r[o]}};e.exports=c},function(e,t,n){"use strict";function r(e,t){this.props=e,this.context=t}var o=n(73),i=n(4);n(8);r.prototype.setState=function(e,t){i("object"==typeof e||"function"==typeof e||null==e),o.enqueueSetState(this,e),t&&o.enqueueCallback(this,t)},r.prototype.forceUpdate=function(e){o.enqueueForceUpdate(this),e&&o.enqueueCallback(this,e)};e.exports=r},function(e,t,n){"use strict";var r=n(99),o=n(254),i=n(34),s=n(19),a=n(24),l=n(4),c=n(81),u={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},p={updatePropertyByID:function(e,t,n){var r=s.getNode(e);l(!u.hasOwnProperty(t)),null!=n?i.setValueForProperty(r,t,n):i.deleteValueForProperty(r,t)},deletePropertyByID:function(e,t,n){var r=s.getNode(e);l(!u.hasOwnProperty(t)),i.deleteValueForProperty(r,t,n)},updateStylesByID:function(e,t){var n=s.getNode(e);r.setValueForStyles(n,t)},updateInnerHTMLByID:function(e,t){var n=s.getNode(e);c(n,t)},updateTextContentByID:function(e,t){var n=s.getNode(e);o.updateTextContent(n,t)},dangerouslyReplaceNodeWithMarkupByID:function(e,t){var n=s.getNode(e);o.dangerouslyReplaceNodeWithMarkup(n,t)},dangerouslyProcessChildrenUpdates:function(e,t){for(var n=0;n<e.length;n++)e[n].parentNode=s.getNode(e[n].parentID);o.processUpdates(e,t)}};a.measureMethods(p,"ReactDOMIDOperations",{updatePropertyByID:"updatePropertyByID",deletePropertyByID:"deletePropertyByID",updateStylesByID:"updateStylesByID",updateInnerHTMLByID:"updateInnerHTMLByID",updateTextContentByID:"updateTextContentByID",dangerouslyReplaceNodeWithMarkupByID:"dangerouslyReplaceNodeWithMarkupByID",dangerouslyProcessChildrenUpdates:"dangerouslyProcessChildrenUpdates"}),e.exports=p},function(e,t,n){"use strict";var r=n(34),o=n(66),i=n(69),s=n(6),a=n(51),l=function(e){};s(l.prototype,{construct:function(e){this._currentElement=e,this._stringText=""+e,this._rootNodeID=null,this._mountIndex=0},mountComponent:function(e,t,n){this._rootNodeID=e;var o=a(this._stringText);return t.renderToStaticMarkup?o:"<span "+r.createMarkupForID(e)+">"+o+"</span>"},receiveComponent:function(e,t){if(e!==this._currentElement){this._currentElement=e;var n=""+e;n!==this._stringText&&(this._stringText=n,i.BackendIDOperations.updateTextContentByID(this._rootNodeID,n))}},unmountComponent:function(){o.unmountIDFromEnvironment(this._rootNodeID);
}}),e.exports=l},function(e,t,n){"use strict";function r(e){return i(document.documentElement,e)}var o=n(274),i=n(111),s=n(113),a=n(114),l={hasSelectionCapabilities:function(e){return e&&("INPUT"===e.nodeName&&"text"===e.type||"TEXTAREA"===e.nodeName||"true"===e.contentEditable)},getSelectionInformation:function(){var e=a();return{focusedElem:e,selectionRange:l.hasSelectionCapabilities(e)?l.getSelection(e):null}},restoreSelection:function(e){var t=a(),n=e.focusedElem,o=e.selectionRange;t!==n&&r(n)&&(l.hasSelectionCapabilities(n)&&l.setSelection(n,o),s(n))},getSelection:function(e){var t;if("selectionStart"in e)t={start:e.selectionStart,end:e.selectionEnd};else if(document.selection&&"INPUT"===e.nodeName){var n=document.selection.createRange();n.parentElement()===e&&(t={start:-n.moveStart("character",-e.value.length),end:-n.moveEnd("character",-e.value.length)})}else t=o.getOffsets(e);return t||{start:0,end:0}},setSelection:function(e,t){var n=t.start,r=t.end;if("undefined"==typeof r&&(r=n),"selectionStart"in e)e.selectionStart=n,e.selectionEnd=Math.min(r,e.value.length);else if(document.selection&&"INPUT"===e.nodeName){var i=e.createTextRange();i.collapse(!0),i.moveStart("character",n),i.moveEnd("character",r-n),i.select()}else o.setOffsets(e,t)}};e.exports=l},function(e,t,n){"use strict";var r=n(300),o={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(e){var t=r(e);return e.replace(">"," "+o.CHECKSUM_ATTR_NAME+'="'+t+'">')},canReuseMarkup:function(e,t){var n=t.getAttribute(o.CHECKSUM_ATTR_NAME);n=n&&parseInt(n,10);var i=r(e);return i===n}};e.exports=o},function(e,t,n){"use strict";var r=n(39),o=r({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,TEXT_CONTENT:null});e.exports=o},function(e,t,n){"use strict";function r(e){function t(t,n,r,o,i){if(o=o||b,null==n[r]){var s=_[i];return t?new Error("Required "+s+" `"+r+"` was not specified in "+("`"+o+"`.")):null}return e(n,r,o,i)}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function o(e){function t(t,n,r,o){var i=t[n],s=f(i);if(s!==e){var a=_[o],l=g(i);return new Error("Invalid "+a+" `"+n+"` of type `"+l+"` "+("supplied to `"+r+"`, expected `"+e+"`."))}return null}return r(t)}function i(){return r(E.thatReturns(null))}function s(e){function t(t,n,r,o){var i=t[n];if(!Array.isArray(i)){var s=_[o],a=f(i);return new Error("Invalid "+s+" `"+n+"` of type "+("`"+a+"` supplied to `"+r+"`, expected an array."))}for(var l=0;l<i.length;l++){var c=e(i,l,r,o);if(c instanceof Error)return c}return null}return r(t)}function a(){function e(e,t,n,r){if(!v.isValidElement(e[t])){var o=_[r];return new Error("Invalid "+o+" `"+t+"` supplied to "+("`"+n+"`, expected a ReactElement."))}return null}return r(e)}function l(e){function t(t,n,r,o){if(!(t[n]instanceof e)){var i=_[o],s=e.name||b;return new Error("Invalid "+i+" `"+n+"` supplied to "+("`"+r+"`, expected instance of `"+s+"`."))}return null}return r(t)}function c(e){function t(t,n,r,o){for(var i=t[n],s=0;s<e.length;s++)if(i===e[s])return null;var a=_[o],l=JSON.stringify(e);return new Error("Invalid "+a+" `"+n+"` of value `"+i+"` "+("supplied to `"+r+"`, expected one of "+l+"."))}return r(t)}function u(e){function t(t,n,r,o){var i=t[n],s=f(i);if("object"!==s){var a=_[o];return new Error("Invalid "+a+" `"+n+"` of type "+("`"+s+"` supplied to `"+r+"`, expected an object."))}for(var l in i)if(i.hasOwnProperty(l)){var c=e(i,l,r,o);if(c instanceof Error)return c}return null}return r(t)}function p(e){function t(t,n,r,o){for(var i=0;i<e.length;i++){var s=e[i];if(null==s(t,n,r,o))return null}var a=_[o];return new Error("Invalid "+a+" `"+n+"` supplied to "+("`"+r+"`."))}return r(t)}function d(){function e(e,t,n,r){if(!m(e[t])){var o=_[r];return new Error("Invalid "+o+" `"+t+"` supplied to "+("`"+n+"`, expected a ReactNode."))}return null}return r(e)}function h(e){function t(t,n,r,o){var i=t[n],s=f(i);if("object"!==s){var a=_[o];return new Error("Invalid "+a+" `"+n+"` of type `"+s+"` "+("supplied to `"+r+"`, expected `object`."))}for(var l in e){var c=e[l];if(c){var u=c(i,l,r,o);if(u)return u}}return null}return r(t)}function m(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(m);if(null===e||v.isValidElement(e))return!0;e=y.extractIfFragment(e);for(var t in e)if(!m(e[t]))return!1;return!0;default:return!1}}function f(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":t}function g(e){var t=f(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}var v=n(7),y=n(45),_=n(47),E=n(21),b="<<anonymous>>",C=a(),x=d(),w={array:o("array"),bool:o("boolean"),func:o("function"),number:o("number"),object:o("object"),string:o("string"),any:i(),arrayOf:s,element:C,instanceOf:l,node:x,objectOf:u,oneOf:c,oneOfType:p,shape:h};e.exports=w},function(e,t,n){"use strict";function r(){this.listenersToPut=[]}var o=n(16),i=n(28),s=n(6);s(r.prototype,{enqueuePutListener:function(e,t,n){this.listenersToPut.push({rootNodeID:e,propKey:t,propValue:n})},putListeners:function(){for(var e=0;e<this.listenersToPut.length;e++){var t=this.listenersToPut[e];i.putListener(t.rootNodeID,t.propKey,t.propValue)}},reset:function(){this.listenersToPut.length=0},destructor:function(){this.reset()}}),o.addPoolingTo(r),e.exports=r},function(e,t){"use strict";var n={injectCreateReactRootIndex:function(e){r.createReactRootIndex=e}},r={createReactRootIndex:null,injection:n};e.exports=r},function(e,t){"use strict";var n={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(e){n.currentScrollLeft=e.x,n.currentScrollTop=e.y}};e.exports=n},function(e,t,n){function r(e,t){return e&&t?e===t?!0:o(e)?!1:o(t)?r(e,t.parentNode):e.contains?e.contains(t):e.compareDocumentPosition?!!(16&e.compareDocumentPosition(t)):!1:!1}var o=n(314);e.exports=r},function(e,t,n){"use strict";function r(e){return null==e?null:a(e)?e:o.has(e)?i.getNodeFromInstance(e):(s(null==e.render||"function"!=typeof e.render),void s(!1))}var o=(n(18),n(30)),i=n(19),s=n(4),a=n(118);n(8);e.exports=r},function(e,t){"use strict";function n(e){try{e.focus()}catch(t){}}e.exports=n},function(e,t){function n(){try{return document.activeElement||document.body}catch(e){return document.body}}e.exports=n},function(e,t){"use strict";function n(e){var t=e&&(r&&e[r]||e[o]);return"function"==typeof t?t:void 0}var r="function"==typeof Symbol&&Symbol.iterator,o="@@iterator";e.exports=n},function(e,t,n){function r(e){return i(!!s),d.hasOwnProperty(e)||(e="*"),a.hasOwnProperty(e)||("*"===e?s.innerHTML="<link />":s.innerHTML="<"+e+"></"+e+">",a[e]=!s.firstChild),a[e]?d[e]:null}var o=n(9),i=n(4),s=o.canUseDOM?document.createElement("div"):null,a={circle:!0,clipPath:!0,defs:!0,ellipse:!0,g:!0,line:!0,linearGradient:!0,path:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,text:!0},l=[1,'<select multiple="true">',"</select>"],c=[1,"<table>","</table>"],u=[3,"<table><tbody><tr>","</tr></tbody></table>"],p=[1,"<svg>","</svg>"],d={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:l,option:l,caption:c,colgroup:c,tbody:c,tfoot:c,thead:c,td:u,th:u,circle:p,clipPath:p,defs:p,ellipse:p,g:p,line:p,linearGradient:p,path:p,polygon:p,polyline:p,radialGradient:p,rect:p,stop:p,text:p};e.exports=r},function(e,t,n){"use strict";function r(){return!i&&o.canUseDOM&&(i="textContent"in document.documentElement?"textContent":"innerText"),i}var o=n(9),i=null;e.exports=r},function(e,t){function n(e){return!(!e||!("function"==typeof Node?e instanceof Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}e.exports=n},function(e,t){"use strict";function n(e){return e&&("INPUT"===e.nodeName&&r[e.type]||"TEXTAREA"===e.nodeName)}var r={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};e.exports=n},function(e,t,n){"use strict";function r(e){return g[e]}function o(e,t){return e&&null!=e.key?s(e.key):t.toString(36)}function i(e){return(""+e).replace(v,r)}function s(e){return"$"+i(e)}function a(e,t,n,r,i){var l=typeof e;if(("undefined"===l||"boolean"===l)&&(e=null),null===e||"string"===l||"number"===l||c.isValidElement(e))return r(i,e,""===t?m+o(e,0):t,n),1;var p,g,v,y=0;if(Array.isArray(e))for(var _=0;_<e.length;_++)p=e[_],g=(""!==t?t+f:m)+o(p,_),v=n+y,y+=a(p,g,v,r,i);else{var E=d(e);if(E){var b,C=E.call(e);if(E!==e.entries)for(var x=0;!(b=C.next()).done;)p=b.value,g=(""!==t?t+f:m)+o(p,x++),v=n+y,y+=a(p,g,v,r,i);else for(;!(b=C.next()).done;){var w=b.value;w&&(p=w[1],g=(""!==t?t+f:m)+s(w[0])+f+o(p,0),v=n+y,y+=a(p,g,v,r,i))}}else if("object"===l){h(1!==e.nodeType);var S=u.extract(e);for(var T in S)S.hasOwnProperty(T)&&(p=S[T],g=(""!==t?t+f:m)+s(T)+f+o(p,0),v=n+y,y+=a(p,g,v,r,i))}}return y}function l(e,t,n){return null==e?0:a(e,"",0,t,n)}var c=n(7),u=n(45),p=n(29),d=n(115),h=n(4),m=(n(8),p.SEPARATOR),f=":",g={"=":"=0",".":"=1",":":"=2"},v=/[=.:]/g;e.exports=l},function(e,t,n){(function(e,r){function o(){function e(){}try{var t=new Uint8Array(1);return t.foo=function(){return 42},t.constructor=e,42===t.foo()&&t.constructor===e&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(n){return!1}}function i(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function e(t){return this instanceof e?(this.length=0,this.parent=void 0,"number"==typeof t?s(this,t):"string"==typeof t?a(this,t,arguments.length>1?arguments[1]:"utf8"):l(this,t)):arguments.length>1?new e(t,arguments[1]):new e(t)}function s(t,n){if(t=f(t,0>n?0:0|g(n)),!e.TYPED_ARRAY_SUPPORT)for(var r=0;n>r;r++)t[r]=0;return t}function a(e,t,n){("string"!=typeof n||""===n)&&(n="utf8");var r=0|y(t,n);return e=f(e,r),e.write(t,n),e}function l(t,n){if(e.isBuffer(n))return c(t,n);if(Q(n))return u(t,n);if(null==n)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(n.buffer instanceof ArrayBuffer)return p(t,n);if(n instanceof ArrayBuffer)return d(t,n)}return n.length?h(t,n):m(t,n)}function c(e,t){var n=0|g(t.length);return e=f(e,n),t.copy(e,0,0,n),e}function u(e,t){var n=0|g(t.length);e=f(e,n);for(var r=0;n>r;r+=1)e[r]=255&t[r];return e}function p(e,t){var n=0|g(t.length);e=f(e,n);for(var r=0;n>r;r+=1)e[r]=255&t[r];return e}function d(t,n){return e.TYPED_ARRAY_SUPPORT?(n.byteLength,t=e._augment(new Uint8Array(n))):t=p(t,new Uint8Array(n)),t}function h(e,t){var n=0|g(t.length);e=f(e,n);for(var r=0;n>r;r+=1)e[r]=255&t[r];return e}function m(e,t){var n,r=0;"Buffer"===t.type&&Q(t.data)&&(n=t.data,r=0|g(n.length)),e=f(e,r);for(var o=0;r>o;o+=1)e[o]=255&n[o];return e}function f(t,n){e.TYPED_ARRAY_SUPPORT?(t=e._augment(new Uint8Array(n)),t.__proto__=e.prototype):(t.length=n,t._isBuffer=!0);var r=0!==n&&n<=e.poolSize>>>1;return r&&(t.parent=J),t}function g(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function v(t,n){if(!(this instanceof v))return new v(t,n);var r=new e(t,n);return delete r.parent,r}function y(e,t){"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"binary":case"raw":case"raws":return n;case"utf8":case"utf-8":return W(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(r)return W(e).length;t=(""+t).toLowerCase(),r=!0}}function _(e,t,n){var r=!1;if(t=0|t,n=void 0===n||n===1/0?this.length:0|n,e||(e="utf8"),0>t&&(t=0),n>this.length&&(n=this.length),t>=n)return"";for(;;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return R(this,t,n);case"ascii":return k(this,t,n);case"binary":return M(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function E(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r),r>o&&(r=o)):r=o;var i=t.length;if(i%2!==0)throw new Error("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;r>s;s++){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");e[n+s]=a}return s}function b(e,t,n,r){return $(W(t,e.length-n),e,n,r)}function C(e,t,n,r){return $(q(t),e,n,r)}function x(e,t,n,r){return C(e,t,n,r)}function w(e,t,n,r){return $(z(t),e,n,r)}function S(e,t,n,r){return $(K(t,e.length-n),e,n,r)}function T(e,t,n){return 0===t&&n===e.length?Y.fromByteArray(e):Y.fromByteArray(e.slice(t,n))}function R(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;n>o;){var i=e[o],s=null,a=i>239?4:i>223?3:i>191?2:1;if(n>=o+a){var l,c,u,p;switch(a){case 1:128>i&&(s=i);break;case 2:l=e[o+1],128===(192&l)&&(p=(31&i)<<6|63&l,p>127&&(s=p));break;case 3:l=e[o+1],c=e[o+2],128===(192&l)&&128===(192&c)&&(p=(15&i)<<12|(63&l)<<6|63&c,p>2047&&(55296>p||p>57343)&&(s=p));break;case 4:l=e[o+1],c=e[o+2],u=e[o+3],128===(192&l)&&128===(192&c)&&128===(192&u)&&(p=(15&i)<<18|(63&l)<<12|(63&c)<<6|63&u,p>65535&&1114112>p&&(s=p))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),o+=a}return I(r)}function I(e){var t=e.length;if(X>=t)return String.fromCharCode.apply(String,e);for(var n="",r=0;t>r;)n+=String.fromCharCode.apply(String,e.slice(r,r+=X));return n}function k(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;n>o;o++)r+=String.fromCharCode(127&e[o]);return r}function M(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;n>o;o++)r+=String.fromCharCode(e[o]);return r}function N(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var o="",i=t;n>i;i++)o+=H(e[i]);return o}function D(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function A(e,t,n){if(e%1!==0||0>e)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function P(t,n,r,o,i,s){if(!e.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(n>i||s>n)throw new RangeError("value is out of bounds");if(r+o>t.length)throw new RangeError("index out of range")}function U(e,t,n,r){0>t&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);i>o;o++)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function O(e,t,n,r){0>t&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);i>o;o++)e[n+o]=t>>>8*(r?o:3-o)&255}function L(e,t,n,r,o,i){if(t>o||i>t)throw new RangeError("value is out of bounds");if(n+r>e.length)throw new RangeError("index out of range");if(0>n)throw new RangeError("index out of range")}function F(e,t,n,r,o){return o||L(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),G.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,o){return o||L(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),G.write(e,t,n,r,52,8),n+8}function V(e){if(e=j(e).replace(ee,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function j(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function H(e){return 16>e?"0"+e.toString(16):e.toString(16)}function W(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],s=0;r>s;s++){if(n=e.charCodeAt(s),n>55295&&57344>n){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(56320>n){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,128>n){if((t-=1)<0)break;i.push(n)}else if(2048>n){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(65536>n){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(1114112>n))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function q(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function K(e,t){for(var n,r,o,i=[],s=0;s<e.length&&!((t-=2)<0);s++)n=e.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function z(e){return Y.toByteArray(V(e))}function $(e,t,n,r){for(var o=0;r>o&&!(o+n>=t.length||o>=e.length);o++)t[o+n]=e[o];return o}/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
var Y=n(323),G=n(324),Q=n(325);t.Buffer=e,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50,e.poolSize=8192;var J={};e.TYPED_ARRAY_SUPPORT=void 0!==r.TYPED_ARRAY_SUPPORT?r.TYPED_ARRAY_SUPPORT:o(),e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array),e.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.compare=function(t,n){if(!e.isBuffer(t)||!e.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var r=t.length,o=n.length,i=0,s=Math.min(r,o);s>i&&t[i]===n[i];)++i;return i!==s&&(r=t[i],o=n[i]),o>r?-1:r>o?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,n){if(!Q(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new e(0);var r;if(void 0===n)for(n=0,r=0;r<t.length;r++)n+=t[r].length;var o=new e(n),i=0;for(r=0;r<t.length;r++){var s=t[r];s.copy(o,i),i+=s.length}return o},e.byteLength=y,e.prototype.length=void 0,e.prototype.parent=void 0,e.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?R(this,0,e):_.apply(this,arguments)},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===e.compare(this,t)},e.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:e.compare(this,t)},e.prototype.indexOf=function(t,n){function r(e,t,n){for(var r=-1,o=0;n+o<e.length;o++)if(e[n+o]===t[-1===r?0:o-r]){if(-1===r&&(r=o),o-r+1===t.length)return n+r}else r=-1;return-1}if(n>2147483647?n=2147483647:-2147483648>n&&(n=-2147483648),n>>=0,0===this.length)return-1;if(n>=this.length)return-1;if(0>n&&(n=Math.max(this.length+n,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,n);if(e.isBuffer(t))return r(this,t,n);if("number"==typeof t)return e.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,n):r(this,[t],n);throw new TypeError("val must be string, number or Buffer")},e.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},e.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},e.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t=0|t,isFinite(n)?(n=0|n,void 0===r&&(r="utf8")):(r=n,n=void 0);else{var o=r;r=t,t=0|n,n=o}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(0>n||0>t)||t>this.length)throw new RangeError("attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return C(this,e,t,n);case"binary":return x(this,e,t,n);case"base64":return w(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var X=4096;e.prototype.slice=function(t,n){var r=this.length;t=~~t,n=void 0===n?r:~~n,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>n?(n+=r,0>n&&(n=0)):n>r&&(n=r),t>n&&(n=t);var o;if(e.TYPED_ARRAY_SUPPORT)o=e._augment(this.subarray(t,n));else{var i=n-t;o=new e(i,void 0);for(var s=0;i>s;s++)o[s]=this[s+t]}return o.length&&(o.parent=this.parent||this),o},e.prototype.readUIntLE=function(e,t,n){e=0|e,t=0|t,n||A(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},e.prototype.readUIntBE=function(e,t,n){e=0|e,t=0|t,n||A(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},e.prototype.readUInt8=function(e,t){return t||A(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return t||A(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return t||A(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,n){e=0|e,t=0|t,n||A(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},e.prototype.readIntBE=function(e,t,n){e=0|e,t=0|t,n||A(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},e.prototype.readInt8=function(e,t){return t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},e.prototype.readInt16LE=function(e,t){t||A(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt16BE=function(e,t){t||A(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt32LE=function(e,t){return t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return t||A(e,4,this.length),G.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return t||A(e,4,this.length),G.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return t||A(e,8,this.length),G.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return t||A(e,8,this.length),G.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,n,r){e=+e,t=0|t,n=0|n,r||P(this,e,t,n,Math.pow(2,8*n),0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},e.prototype.writeUIntBE=function(e,t,n,r){e=+e,t=0|t,n=0|n,r||P(this,e,t,n,Math.pow(2,8*n),0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},e.prototype.writeUInt8=function(t,n,r){return t=+t,n=0|n,r||P(this,t,n,1,255,0),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},e.prototype.writeUInt16LE=function(t,n,r){return t=+t,n=0|n,r||P(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):U(this,t,n,!0),n+2},e.prototype.writeUInt16BE=function(t,n,r){return t=+t,n=0|n,r||P(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):U(this,t,n,!1),n+2},e.prototype.writeUInt32LE=function(t,n,r){return t=+t,n=0|n,r||P(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):O(this,t,n,!0),n+4},e.prototype.writeUInt32BE=function(t,n,r){return t=+t,n=0|n,r||P(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):O(this,t,n,!1),n+4},e.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t=0|t,!r){var o=Math.pow(2,8*n-1);P(this,e,t,n,o-1,-o)}var i=0,s=1,a=0>e?1:0;for(this[t]=255&e;++i<n&&(s*=256);)this[t+i]=(e/s>>0)-a&255;return t+n},e.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t=0|t,!r){var o=Math.pow(2,8*n-1);P(this,e,t,n,o-1,-o)}var i=n-1,s=1,a=0>e?1:0;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=(e/s>>0)-a&255;return t+n},e.prototype.writeInt8=function(t,n,r){return t=+t,n=0|n,r||P(this,t,n,1,127,-128),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[n]=255&t,n+1},e.prototype.writeInt16LE=function(t,n,r){return t=+t,n=0|n,r||P(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):U(this,t,n,!0),n+2},e.prototype.writeInt16BE=function(t,n,r){return t=+t,n=0|n,r||P(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):U(this,t,n,!1),n+2},e.prototype.writeInt32LE=function(t,n,r){return t=+t,n=0|n,r||P(this,t,n,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):O(this,t,n,!0),n+4},e.prototype.writeInt32BE=function(t,n,r){return t=+t,n=0|n,r||P(this,t,n,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):O(this,t,n,!1),n+4},e.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},e.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},e.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},e.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},e.prototype.copy=function(t,n,r,o){if(r||(r=0),o||0===o||(o=this.length),n>=t.length&&(n=t.length),n||(n=0),o>0&&r>o&&(o=r),o===r)return 0;if(0===t.length||0===this.length)return 0;if(0>n)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("sourceStart out of bounds");if(0>o)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-n<o-r&&(o=t.length-n+r);var i,s=o-r;if(this===t&&n>r&&o>n)for(i=s-1;i>=0;i--)t[i+n]=this[i+r];else if(1e3>s||!e.TYPED_ARRAY_SUPPORT)for(i=0;s>i;i++)t[i+n]=this[i+r];else t._set(this.subarray(r,r+s),n);return s},e.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),t>n)throw new RangeError("end < start");if(n!==t&&0!==this.length){if(0>t||t>=this.length)throw new RangeError("start out of bounds");if(0>n||n>this.length)throw new RangeError("end out of bounds");var r;if("number"==typeof e)for(r=t;n>r;r++)this[r]=e;else{var o=W(e.toString()),i=o.length;for(r=t;n>r;r++)this[r]=o[r%i]}return this}},e.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(e.TYPED_ARRAY_SUPPORT)return new e(this).buffer;for(var t=new Uint8Array(this.length),n=0,r=t.length;r>n;n+=1)t[n]=this[n];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var Z=e.prototype;e._augment=function(t){return t.constructor=e,t._isBuffer=!0,t._set=t.set,t.get=Z.get,t.set=Z.set,t.write=Z.write,t.toString=Z.toString,t.toLocaleString=Z.toString,t.toJSON=Z.toJSON,t.equals=Z.equals,t.compare=Z.compare,t.indexOf=Z.indexOf,t.copy=Z.copy,t.slice=Z.slice,t.readUIntLE=Z.readUIntLE,t.readUIntBE=Z.readUIntBE,t.readUInt8=Z.readUInt8,t.readUInt16LE=Z.readUInt16LE,t.readUInt16BE=Z.readUInt16BE,t.readUInt32LE=Z.readUInt32LE,t.readUInt32BE=Z.readUInt32BE,t.readIntLE=Z.readIntLE,t.readIntBE=Z.readIntBE,t.readInt8=Z.readInt8,t.readInt16LE=Z.readInt16LE,t.readInt16BE=Z.readInt16BE,t.readInt32LE=Z.readInt32LE,t.readInt32BE=Z.readInt32BE,t.readFloatLE=Z.readFloatLE,t.readFloatBE=Z.readFloatBE,t.readDoubleLE=Z.readDoubleLE,t.readDoubleBE=Z.readDoubleBE,t.writeUInt8=Z.writeUInt8,t.writeUIntLE=Z.writeUIntLE,t.writeUIntBE=Z.writeUIntBE,t.writeUInt16LE=Z.writeUInt16LE,t.writeUInt16BE=Z.writeUInt16BE,t.writeUInt32LE=Z.writeUInt32LE,t.writeUInt32BE=Z.writeUInt32BE,t.writeIntLE=Z.writeIntLE,t.writeIntBE=Z.writeIntBE,t.writeInt8=Z.writeInt8,t.writeInt16LE=Z.writeInt16LE,t.writeInt16BE=Z.writeInt16BE,t.writeInt32LE=Z.writeInt32LE,t.writeInt32BE=Z.writeInt32BE,t.writeFloatLE=Z.writeFloatLE,t.writeFloatBE=Z.writeFloatBE,t.writeDoubleLE=Z.writeDoubleLE,t.writeDoubleBE=Z.writeDoubleBE,t.fill=Z.fill,t.inspect=Z.inspect,t.toArrayBuffer=Z.toArrayBuffer,t};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,n(121).Buffer,function(){return this}())},function(e,t){function n(){c=!1,s.length?l=s.concat(l):u=-1,l.length&&r()}function r(){if(!c){var e=setTimeout(n);c=!0;for(var t=l.length;t;){for(s=l,l=[];++u<t;)s&&s[u].run();u=-1,t=l.length}s=null,c=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function i(){}var s,a=e.exports={},l=[],c=!1,u=-1;a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new o(e,t)),1!==l.length||c||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=i,a.addListener=i,a.once=i,a.off=i,a.removeListener=i,a.removeAllListeners=i,a.emit=i,a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t){e.exports={name:"matrix-react-sdk",version:"0.0.2",description:"SDK for matrix.org using React",author:{name:"matrix.org"},repository:{type:"git",url:"git+https://github.com/matrix-org/matrix-react-sdk.git"},license:"Apache-2.0",main:"lib/index.js",bin:{reskindex:"./reskindex.js"},scripts:{build:"babel src -d lib --source-maps",start:"babel src -w -d lib --source-maps",clean:"rimraf lib",prepublish:"npm run build"},dependencies:{classnames:"^2.1.2",filesize:"^3.1.2",flux:"^2.0.3",glob:"^5.0.14",linkifyjs:"^2.0.0-beta.4","matrix-js-sdk":"^0.3.0",optimist:"^0.6.1",q:"^1.4.1",react:"^0.13.3","react-loader":"^1.4.0"},"//deps":"The loader packages are here because webpack in a project that depends on us needs them in this package's node_modules folder","//depsbuglink":"https://github.com/webpack/webpack/issues/1472",devDependencies:{babel:"^5.8.23",rimraf:"^2.4.3","json-loader":"^0.5.3","source-map-loader":"^0.1.5"},gitHead:"966f44baa190cd367a50383561f24d3f9fe40224",bugs:{url:"https://github.com/matrix-org/matrix-react-sdk/issues"},homepage:"https://github.com/matrix-org/matrix-react-sdk#readme",_id:"matrix-react-sdk@0.0.2",_shasum:"758936ab3e934a795f6f1fc604cbb6902e031b43",_from:"matrix-react-sdk@^0.0.2",_npmVersion:"2.14.4",_nodeVersion:"4.1.1",_npmUser:{name:"matrixdotorg",email:"matrix@matrix.org"},dist:{shasum:"758936ab3e934a795f6f1fc604cbb6902e031b43",tarball:"http://registry.npmjs.org/matrix-react-sdk/-/matrix-react-sdk-0.0.2.tgz"},maintainers:[{name:"matrixdotorg",email:"matrix@matrix.org"}],directories:{},_resolved:"https://registry.npmjs.org/matrix-react-sdk/-/matrix-react-sdk-0.0.2.tgz",readme:"ERROR: No README data found!"}},function(e,t,n){"use strict";var r=n(5),o=n(23),i=n(2),s=n(40);e.exports={componentDidMount:function(){if(this.dispatcherRef=r.register(this.onAction),this._trackedRoom=null,this.props.room)this._trackedRoom=this.props.room,this.showCall(this._trackedRoom.roomId);else{var e=o.getAnyActiveCall();e&&(console.log("Global CallView is now tracking active call in room %s",e.roomId),this._trackedRoom=i.get().getRoom(e.roomId),this.showCall(e.roomId))}},componentWillUnmount:function(){r.unregister(this.dispatcherRef)},onAction:function(e){"call_state"===e.action&&e.room_id&&this.showCall(e.room_id)},showCall:function(e){var t=o.getCallForRoom(e)||s.getConferenceCallForRoom(e);t&&(t.setLocalVideoElement(this.getVideoView().getLocalVideoElement()),t.setRemoteVideoElement(this.getVideoView().getRemoteVideoElement()),t.setRemoteAudioElement(this.getVideoView().getRemoteAudioElement())),t&&"video"===t.type&&"ended"!==t.state?(this.getVideoView().getLocalVideoElement().style.display=t.confUserId?"none":"initial",this.getVideoView().getRemoteVideoElement().style.display="initial"):(this.getVideoView().getLocalVideoElement().style.display="none",this.getVideoView().getRemoteVideoElement().style.display="none",r.dispatch({action:"video_fullscreen",fullscreen:!1}))}}},function(e,t,n){"use strict";var r=n(1),o=n(2),i=n(96),s=n(5),a=n(3),l=n(40),c=n(23),u=!0;e.exports={componentWillMount:function(){var e=o.get();e.on("Room",this.onRoom),e.on("Room.timeline",this.onRoomTimeline),e.on("Room.name",this.onRoomName),e.on("RoomState.events",this.onRoomStateEvents),e.on("RoomMember.name",this.onRoomMemberName);var t=this.getRoomList();this.setState({roomList:t,activityMap:{}})},componentDidMount:function(){this.dispatcherRef=s.register(this.onAction)},onAction:function(e){switch(e.action){case"call_state":this._recheckCallElement(this.props.selectedRoom);break;case"view_tooltip":this.tooltip=e.tooltip,this._repositionTooltip(),this.tooltip&&(this.tooltip.style.display="block")}},componentWillUnmount:function(){s.unregister(this.dispatcherRef),o.get()&&(o.get().removeListener("Room",this.onRoom),o.get().removeListener("Room.timeline",this.onRoomTimeline),o.get().removeListener("Room.name",this.onRoomName),o.get().removeListener("RoomState.events",this.onRoomStateEvents))},componentWillReceiveProps:function(e){this.state.activityMap[e.selectedRoom]=void 0,this._recheckCallElement(e.selectedRoom),this.setState({activityMap:this.state.activityMap})},onRoom:function(e){this.refreshRoomList()},onRoomTimeline:function(e,t,n){if(!n){var r={roomList:this.getRoomList()};if(t.roomId!=this.props.selectedRoom&&e.getSender()!=o.get().credentials.userId){var i=1,s=o.get().getPushActionsForEvent(e);s&&s.tweaks&&s.tweaks.highlight&&(i=2);var a=this.state.activityMap;a[t.roomId]=Math.max(a[t.roomId]||0,i),r.activityMap=a}this.setState(r)}},onRoomName:function(e){this.refreshRoomList()},onRoomStateEvents:function(e,t){setTimeout(this.refreshRoomList,0)},onRoomMemberName:function(e,t){setTimeout(this.refreshRoomList,0)},refreshRoomList:function(){var e=this.getRoomList();this.setState({roomList:e})},getRoomList:function(){return i.mostRecentActivityFirst(o.get().getRooms().filter(function(e){var t=e.getMember(o.get().credentials.userId),n=t&&("join"==t.membership||"invite"==t.membership);if(n&&u){var r=e.getJoinedMembers();if(2===r.length){var i=r.filter(function(e){return e.userId!==t.userId})[0];l.isConferenceUser(i)&&(n=!1)}}return n}))},_recheckCallElement:function(e){var t=c.getAnyActiveCall(),n=c.getCallForRoom(e),r=t&&!n;this.setState({show_call_element:r})},_repositionTooltip:function(e){if(this.tooltip&&this.tooltip.parentElement){var t=this.getDOMNode();this.tooltip.style.top=t.parentElement.offsetTop+this.tooltip.parentElement.offsetTop-t.scrollTop+"px"}},makeRoomTiles:function(){var e=this,t=a.getComponent("molecules.RoomTile");return this.state.roomList.map(function(n){var o=n.roomId==e.props.selectedRoom;return r.createElement(t,{room:n,key:n.roomId,collapsed:e.props.collapsed,selected:o,unread:1===e.state.activityMap[n.roomId],highlight:2===e.state.activityMap[n.roomId]})})}}},function(e,t,n){"use strict";var r=n(2),o=n(1),i=n(20),s=n(208),a=n(212),l=n(14),c=n(3),u=n(23),p=n(40),d=n(5),h=20,m=20;e.exports={getInitialState:function(){return{room:this.props.roomId?r.get().getRoom(this.props.roomId):null,messageCap:m,editingRoomSettings:!1,uploadingRoomSettings:!1,numUnreadMessages:0,draggingFile:!1}},componentWillMount:function(){this.dispatcherRef=d.register(this.onAction),r.get().on("Room.timeline",this.onRoomTimeline),r.get().on("Room.name",this.onRoomName),r.get().on("RoomMember.typing",this.onRoomMemberTyping),r.get().on("RoomState.members",this.onRoomStateMember),this.atBottom=!0},componentWillUnmount:function(){if(this.refs.messageWrapper){var e=this.refs.messageWrapper.getDOMNode();e.removeEventListener("drop",this.onDrop),e.removeEventListener("dragover",this.onDragOver),e.removeEventListener("dragleave",this.onDragLeaveOrEnd),e.removeEventListener("dragend",this.onDragLeaveOrEnd)}d.unregister(this.dispatcherRef),r.get()&&(r.get().removeListener("Room.timeline",this.onRoomTimeline),r.get().removeListener("Room.name",this.onRoomName),r.get().removeListener("RoomMember.typing",this.onRoomMemberTyping),r.get().removeListener("RoomState.members",this.onRoomStateMember))},onAction:function(e){switch(e.action){case"message_send_failed":case"message_sent":case"message_resend_started":this.setState({room:r.get().getRoom(this.props.roomId)}),this.forceUpdate();break;case"notifier_enabled":this.forceUpdate();break;case"call_state":if(u.getCallForRoom(this.props.roomId)){var t=this.refs.messageWrapper;t&&(t=t.getDOMNode(),t.scrollTop=t.scrollHeight)}this._updateConfCallNotification()}},onRoomTimeline:function(e,t,n){if(this.isMounted()&&!this.state.paginating&&!this.state.joining&&t.roomId==this.props.roomId){if(this.refs.messageWrapper){var o=this.refs.messageWrapper.getDOMNode();this.atBottom=o.scrollHeight-o.scrollTop<=o.clientHeight+150}var i=this.state.numUnreadMessages;n||e.getSender()===r.get().credentials.userId||(this.atBottom?i=0:i+=1),this.setState({room:r.get().getRoom(this.props.roomId),numUnreadMessages:i}),n&&!this.state.paginating&&this.fillSpace()}},onRoomName:function(e){e.roomId==this.props.roomId&&this.setState({room:e})},onRoomMemberTyping:function(e,t){this.forceUpdate()},onRoomStateMember:function(e,t,n){n.roomId===this.props.roomId&&n.userId===p.getConferenceUserIdForRoom(n.roomId)&&this._updateConfCallNotification()},_updateConfCallNotification:function(){var e=r.get().getRoom(this.props.roomId);if(e){var t=e.getMember(p.getConferenceUserIdForRoom(this.props.roomId));if(t){var n=p.getConferenceCallForRoom(t.roomId);this.setState({displayConfCallNotification:(!n||"ended"===n.call_state)&&"join"===t.membership})}}},componentDidMount:function(){if(this.refs.messageWrapper){var e=this.refs.messageWrapper.getDOMNode();e.addEventListener("drop",this.onDrop),e.addEventListener("dragover",this.onDragOver),e.addEventListener("dragleave",this.onDragLeaveOrEnd),e.addEventListener("dragend",this.onDragLeaveOrEnd),e.scrollTop=e.scrollHeight,this.fillSpace()}this._updateConfCallNotification()},componentDidUpdate:function(){if(this.refs.messageWrapper){var e=this.refs.messageWrapper.getDOMNode();if(this.state.paginating&&!this.waiting_for_paginate){var t=e.scrollHeight-this.oldScrollHeight;e.scrollTop+=t,this.oldScrollHeight=void 0,this.fillSpace()||this.setState({paginating:!1})}else this.atBottom&&(e.scrollTop=e.scrollHeight,0!==this.state.numUnreadMessages&&this.setState({numUnreadMessages:0}))}},fillSpace:function(){if(this.refs.messageWrapper){var e=this.refs.messageWrapper.getDOMNode();if(e.scrollTop<e.clientHeight&&this.state.room.oldState.paginationToken){if(this.setState({paginating:!0}),this.oldScrollHeight=e.scrollHeight,this.state.messageCap<this.state.room.timeline.length){this.waiting_for_paginate=!1;var t=Math.min(this.state.messageCap+h,this.state.room.timeline.length);this.setState({messageCap:t,paginating:!0})}else{this.waiting_for_paginate=!0;var t=this.state.messageCap+h;this.setState({messageCap:t,paginating:!0});var n=this;r.get().scrollback(this.state.room,h)["finally"](function(){n.waiting_for_paginate=!1,n.isMounted()&&n.setState({room:r.get().getRoom(n.props.roomId)})})}return!0}return!1}},onJoinButtonClicked:function(e){var t=this;r.get().joinRoom(this.props.roomId).then(function(){t.setState({joining:!1,room:r.get().getRoom(t.props.roomId)})},function(e){t.setState({joining:!1,joinError:e})}),this.setState({joining:!0})},onMessageListScroll:function(e){if(this.refs.messageWrapper){var t=this.refs.messageWrapper.getDOMNode(),n=this.atBottom;this.atBottom=t.scrollHeight-t.scrollTop<=t.clientHeight,this.atBottom&&!n&&this.forceUpdate()}this.state.paginating||this.fillSpace()},onDragOver:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="none";var t=e.dataTransfer.items;1==t.length&&"file"==t[0].kind&&(this.setState({draggingFile:!0}),e.dataTransfer.dropEffect="copy")},onDrop:function(e){e.stopPropagation(),e.preventDefault(),this.setState({draggingFile:!1});var t=e.dataTransfer.files;1==t.length&&this.uploadFile(t[0])},onDragLeaveOrEnd:function(e){e.stopPropagation(),e.preventDefault(),this.setState({draggingFile:!1})},uploadFile:function(e){this.setState({upload:{fileName:e.name,uploadedBytes:0,totalBytes:e.size}});var t=this;s.sendContentToRoom(e,this.props.roomId,r.get()).progress(function(n){t.setState({upload:{fileName:e.name,uploadedBytes:n.loaded,totalBytes:n.total}})})["finally"](function(){t.setState({upload:void 0})}).done(void 0,function(){})},getWhoIsTypingString:function(){return a.whoIsTypingString(this.state.room)},getEventTiles:function(){for(var e=c.getComponent("molecules.DateSeparator"),t=[],n=0,r=c.getComponent("molecules.EventTile"),i=this.state.room.timeline.length-1;i>=0&&n<this.state.messageCap;--i){var s=this.state.room.timeline[i];if(r.supportsEventType(s.getType())){var a=!1,l=!1,u=null;if(i==this.state.room.timeline.length-1&&(l=!0),i>0&&n<this.state.messageCap-1){this.state.room.timeline[i].sender&&this.state.room.timeline[i-1].sender&&this.state.room.timeline[i].sender.userId===this.state.room.timeline[i-1].sender.userId&&this.state.room.timeline[i].getType()==this.state.room.timeline[i-1].getType()&&(a=!0);var p=this.state.room.timeline[i-1].getTs(),d=this.state.room.timeline[i].getTs();new Date(p).toDateString()!==new Date(d).toDateString()&&(u=o.createElement(e,{key:d,ts:d}),a=!1)}if(1===i){var d=this.state.room.timeline[i].getTs();u=o.createElement("li",{key:d},o.createElement(e,{ts:d})),a=!1}t.unshift(o.createElement("li",{key:s.getId()},o.createElement(r,{mxEvent:s,continuation:a,last:l}))),u&&t.unshift(u),++n}}return t},uploadNewState:function(e,t,n,o,s){var a=this.state.room.name,u=this.state.room.currentState.getStateEvents("m.room.topic","");u=u?u.getContent().topic:"";var p=this.state.room.currentState.getStateEvents("m.room.join_rules","");p=p?p.getContent().join_rule:"invite";var d=this.state.room.currentState.getStateEvents("m.room.history_visibility","");d=d?d.getContent().history_visibility:"shared";var h=[];if(a!=e&&void 0!=e&&e&&h.push(r.get().setRoomName(this.state.room.roomId,e)),u!=t&&void 0!=t&&h.push(r.get().setRoomTopic(this.state.room.roomId,t)),p!=n&&void 0!=n&&h.push(r.get().sendStateEvent(this.state.room.roomId,"m.room.join_rules",{join_rule:n},"")),d!=o&&void 0!=o&&h.push(r.get().sendStateEvent(this.state.room.roomId,"m.room.history_visibility",{history_visibility:o},"")),s&&h.push(r.get().sendStateEvent(this.state.room.roomId,"m.room.power_levels",s,"")),h.length){var m=this;i.all(h).fail(function(e){var t=c.getComponent("organisms.ErrorDialog");l.createDialog(t,{title:"Failed to set state",description:e.toString()})})["finally"](function(){m.setState({uploadingRoomSettings:!1})})}else this.setState({editingRoomSettings:!1,uploadingRoomSettings:!1})}}},function(e,t,n){"use strict";var r=n(61),o=n(2),i=n(249),s={};r(s,i),s.onRegistered=function(e,t){o.replaceUsingAccessToken(this.state.hs_url,this.state.is_url,e,t),this.setState({step:"profile",busy:!0});var n=this,r=o.get();r.getProfileInfo(r.credentials.userId).done(function(e){n.setState({avatarUrl:e.avatar_url,busy:!1})},function(e){console.err(e),n.setState({busy:!1})})},s.onAccountReady=function(){this.props.onLoggedIn&&this.props.onLoggedIn()},e.exports=s},function(e,t,n){"use strict";var r={};r["atoms.create_room.CreateRoomButton"]=n(137),r["atoms.create_room.Presets"]=n(138),r["atoms.create_room.RoomAlias"]=n(139),r["atoms.EditableText"]=n(129),r["atoms.EnableNotificationsButton"]=n(130),r["atoms.ImageView"]=n(131),r["atoms.LogoutButton"]=n(132),r["atoms.MemberAvatar"]=n(133),r["atoms.MessageTimestamp"]=n(134),r["atoms.RoomAvatar"]=n(135),r["atoms.voip.VideoFeed"]=n(140),r["molecules.BottomLeftMenu"]=n(141),r["molecules.BottomLeftMenuTile"]=n(142),r["molecules.ChangeAvatar"]=n(143),r["molecules.ChangeDisplayName"]=n(144),r["molecules.ChangePassword"]=n(145),r["molecules.DateSeparator"]=n(146),r["molecules.EventAsTextTile"]=n(147),r["molecules.EventTile"]=n(148),r["molecules.MatrixToolbar"]=n(155),r["molecules.MemberInfo"]=n(156),r["molecules.MemberTile"]=n(157),r["molecules.MEmoteTile"]=n(149),r["molecules.MessageComposer"]=n(158),r["molecules.MessageContextMenu"]=n(159),r["molecules.MessageTile"]=n(160),r["molecules.MFileTile"]=n(150),r["molecules.MImageTile"]=n(151),r["molecules.MNoticeTile"]=n(152),r["molecules.MRoomMemberTile"]=n(153),r["molecules.MTextTile"]=n(154),r["molecules.ProgressBar"]=n(161),r["molecules.RoomCreate"]=n(162),r["molecules.RoomDropTarget"]=n(163),r["molecules.RoomHeader"]=n(164),r["molecules.RoomSettings"]=n(165),r["molecules.RoomTile"]=n(166),r["molecules.RoomTooltip"]=n(167),r["molecules.SenderProfile"]=n(168),r["molecules.ServerConfig"]=n(169),r["molecules.UnknownMessageTile"]=n(170),r["molecules.UserSelector"]=n(171),r["molecules.voip.CallView"]=n(172),r["molecules.voip.IncomingCallBox"]=n(173),r["molecules.voip.VideoView"]=n(174),r["organisms.CasLogin"]=n(175),r["organisms.CreateRoom"]=n(176),r["organisms.ErrorDialog"]=n(177),r["organisms.LeftPanel"]=n(178),r["organisms.LogoutPrompt"]=n(179),r["organisms.MemberList"]=n(180),r["organisms.Notifier"]=n(181),r["organisms.QuestionDialog"]=n(182),r["organisms.RightPanel"]=n(183),r["organisms.RoomDirectory"]=n(184),r["organisms.RoomList"]=n(185),r["organisms.RoomView"]=n(186),r["organisms.UserSettings"]=n(187),r["organisms.ViewSource"]=n(188),r["pages.MatrixChat"]=n(189),r["templates.Login"]=n(190),r["templates.Register"]=n(191),e.exports=r},function(e,t,n){"use strict";var r=n(1),o=n(213);e.exports=r.createClass({displayName:"EditableText",mixins:[o],onKeyUp:function(e){"Enter"==e.key?this.onFinish(e):"Escape"==e.key&&this.cancelEdit()},onClickDiv:function(){this.setState({phase:this.Phases.Edit})},onFocus:function(e){e.target.setSelectionRange(0,e.target.value.length)},onFinish:function(e){e.target.value?this.setValue(e.target.value,"Enter"===e.key):this.cancelEdit()},render:function(){var e;return this.state.phase==this.Phases.Display?e=this.state.value?r.createElement("div",{ref:"display_div",onClick:this.onClickDiv},this.state.value):r.createElement("div",{ref:"display_div",onClick:this.onClickDiv},this.props.label):this.state.phase==this.Phases.Edit&&(e=r.createElement("div",null,r.createElement("input",{type:"text",defaultValue:this.state.value,onKeyUp:this.onKeyUp,onFocus:this.onFocus,onBlur:this.onFinish,placeholder:this.props.placeHolder,autoFocus:!0}))),r.createElement("div",{className:"mx_EditableText"},e)}})},function(e,t,n){"use strict";var r=n(1),o=n(214);e.exports=r.createClass({displayName:"EnableNotificationsButton",mixins:[o],render:function(){return this.enabled()?r.createElement("button",{className:"mx_EnableNotificationsButton",onClick:this.onClick},"Disable Notifications"):r.createElement("button",{className:"mx_EnableNotificationsButton",onClick:this.onClick},"Enable Notifications")}})},function(e,t,n){"use strict";var r=n(1);e.exports=r.createClass({displayName:"ImageView",componentDidMount:function(){document.addEventListener("keydown",this.onKeyDown)},componentWillUnmount:function(){document.removeEventListener("keydown",this.onKeyDown)},onKeyDown:function(e){27==e.keyCode&&(e.stopPropagation(),e.preventDefault(),this.props.onFinished())},render:function(){var e,t,n=this.props.width||500,o=this.props.height||500,i=.8*document.documentElement.clientWidth,s=.8*document.documentElement.clientHeight,a=n/i,l=o/s;a>l?(e=Math.min(n,i),t=e/n*o):(t=Math.min(o,s),e=t/o*n);var c={width:e,height:t};return r.createElement("img",{className:"mx_ImageView",src:this.props.src,style:c})}})},function(e,t,n){"use strict";var r=n(1),o=n(215);e.exports=r.createClass({displayName:"LogoutButton",mixins:[o],render:function(){return r.createElement("button",{className:"mx_LogoutButton",onClick:this.onClick},"Sign out")}})},function(e,t,n){"use strict";var r=n(1),o=n(85),i=n(216);e.exports=r.createClass({displayName:"MemberAvatar",mixins:[i],avatarUrlForMember:function(e){return o.avatarUrlForMember(e,this.props.member,this.props.width,this.props.height,this.props.resizeMethod)},skinnedDefaultAvatarUrl:function(e,t,n,r){return o.defaultAvatarUrlForString(e.userId)},render:function(){return r.createElement("img",{className:"mx_MemberAvatar",src:this.state.imageUrl,onError:this.onError,width:this.props.width,height:this.props.height})}})},function(e,t,n){"use strict";var r=n(1),o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.exports=r.createClass({displayName:"MessageTimestamp",formatDate:function(e){function t(e){return(10>e?"0":"")+e}var n=new Date;return e.toDateString()===n.toDateString()?t(e.getHours())+":"+t(e.getMinutes()):n.getTime()-e.getTime()<5184e5?o[e.getDay()]+" "+t(e.getHours())+":"+t(e.getMinutes()):n.getFullYear()===e.getFullYear()?o[e.getDay()]+", "+i[e.getMonth()]+" "+(e.getDay()+1)+" "+t(e.getHours())+":"+t(e.getMinutes()):o[e.getDay()]+", "+i[e.getMonth()]+" "+(e.getDay()+1)+" "+e.getFullYear()+" "+t(e.getHours())+":"+t(e.getMinutes());
},render:function(){var e=new Date(this.props.ts);return r.createElement("span",{className:"mx_MessageTimestamp"},this.formatDate(e))}})},function(e,t,n){"use strict";var r=n(1),o=n(217);e.exports=r.createClass({displayName:"RoomAvatar",mixins:[o],getUrlList:function(){return[this.roomAvatarUrl(),this.getOneToOneAvatar(),this.getFallbackAvatar()]},getFallbackAvatar:function(){for(var e=["80cef4","50e2c2","f4c371"],t=0,n=0;n<this.props.room.roomId.length;++n)t+=this.props.room.roomId.charCodeAt(n);return"img/"+e[t%e.length]+".png"},render:function(){var e={maxWidth:this.props.width,maxHeight:this.props.height};return r.createElement("img",{className:"mx_RoomAvatar",src:this.state.imageUrl,onError:this.onError,style:e})}})},function(e,t,n){"use strict";var r=n(1);e.exports=r.createClass({displayName:"Spinner",render:function(){var e=this.props.w||32,t=this.props.h||32,n=this.props.imgClassName||"";return r.createElement("div",null,r.createElement("img",{src:"img/spinner.gif",width:e,height:t,className:n}))}})},function(e,t,n){"use strict";var r=n(1),o=n(218);e.exports=r.createClass({displayName:"CreateRoomButton",mixins:[o],render:function(){return r.createElement("button",{className:"mx_CreateRoomButton",onClick:this.onClick},"Create Room")}})},function(e,t,n){"use strict";var r=n(1),o=n(60);e.exports=r.createClass({displayName:"CreateRoomPresets",mixins:[o],onValueChanged:function(e){this.props.onChange(e.target.value)},render:function(){return r.createElement("select",{className:"mx_Presets",onChange:this.onValueChanged,value:this.props.preset},r.createElement("option",{value:this.Presets.PrivateChat},"Private Chat"),r.createElement("option",{value:this.Presets.PublicChat},"Public Chat"),r.createElement("option",{value:this.Presets.Custom},"Custom"))}})},function(e,t,n){"use strict";var r=n(1),o=n(219);e.exports=r.createClass({displayName:"RoomAlias",mixins:[o],onValueChanged:function(e){this.props.onChange(e.target.value)},onFocus:function(e){var t=e.target,n=e.target.value;if(this.props.homeserver)if(""==n)setTimeout(function(){t.value="#:"+this.props.homeserver,t.setSelectionRange(1,1)},0);else{var r=":"+this.props.homeserver;setTimeout(function(){t.setSelectionRange(n.startsWith("#")?1:0,n.endsWith(r)?t.value.length-r.length:t.value.length)},0)}},onBlur:function(e){var t=e.target.value;if(this.props.homeserver){if(t=="#:"+this.props.homeserver)return void(e.target.value="");if(""!=t){var n=e.target.value,r=":"+this.props.homeserver;t.startsWith("#")||(n="#"+n),t.endsWith(r)||(n+=r),e.target.value=n}}},render:function(){return r.createElement("input",{type:"text",className:"mx_RoomAlias",placeholder:"Alias (optional)",onChange:this.onValueChanged,onFocus:this.onFocus,onBlur:this.onBlur,value:this.props.alias})}})},function(e,t,n){"use strict";var r=n(1);e.exports=r.createClass({displayName:"VideoFeed",render:function(){return r.createElement("video",null)}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(5);e.exports=r.createClass({displayName:"BottomLeftMenu",onSettingsClick:function(){i.dispatch({action:"view_user_settings"})},onRoomDirectoryClick:function(){i.dispatch({action:"view_room_directory"})},onCreateRoomClick:function(){i.dispatch({action:"view_create_room"})},getLabel:function(e){if(!this.props.collapsed)return r.createElement("div",{className:"mx_RoomTile_name"},e);if(this.state.hover){var t=o.getComponent("molecules.RoomTooltip");return r.createElement(t,{name:e})}},render:function(){var e=o.getComponent("molecules.BottomLeftMenuTile");return r.createElement("div",{className:"mx_BottomLeftMenu"},r.createElement("div",{className:"mx_BottomLeftMenu_options"},r.createElement(e,{collapsed:this.props.collapsed,img:"img/create-big.png",label:"Create new room",onClick:this.onCreateRoomClick}),r.createElement(e,{collapsed:this.props.collapsed,img:"img/directory-big.png",label:"Directory",onClick:this.onRoomDirectoryClick}),r.createElement(e,{collapsed:this.props.collapsed,img:"img/settings-big.png",label:"Settings",onClick:this.onSettingsClick})))}})},function(e,t,n){"use strict";var r=n(1),o=n(3);e.exports=r.createClass({displayName:"BottomLeftMenuTile",getInitialState:function(){return{hover:!1}},onMouseEnter:function(){this.setState({hover:!0})},onMouseLeave:function(){this.setState({hover:!1})},render:function(){var e;if(this.props.collapsed){if(this.state.hover){var t=o.getComponent("molecules.RoomTooltip");e=r.createElement(t,{bottom:!0,label:this.props.label})}}else e=r.createElement("div",{className:"mx_RoomTile_name"},this.props.label);return r.createElement("div",{className:"mx_RoomTile",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.props.onClick},r.createElement("div",{className:"mx_RoomTile_avatar"},r.createElement("img",{src:this.props.img,width:"36",height:"36"})),e)}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(220),s=n(10);e.exports=r.createClass({displayName:"ChangeAvatar",mixins:[i],onFileSelected:function(e){this.avatarSet=!0,this.setAvatarFromFile(e.target.files[0])},onError:function(e){this.setState({errorText:"Failed to upload profile picture!"})},render:function(){var e,t=o.getComponent("atoms.RoomAvatar");if(this.props.room&&!this.avatarSet)e=r.createElement(t,{room:this.props.room,width:"320",height:"240",resizeMethod:"scale"});else{var n={maxWidth:320,maxHeight:240};e=r.createElement("img",{src:this.state.avatarUrl,style:n})}switch(this.state.phase){case this.Phases.Display:case this.Phases.Error:return r.createElement("div",null,r.createElement("div",{className:"mx_Dialog_content"},e),r.createElement("div",{className:"mx_Dialog_content"},"Upload new:",r.createElement("input",{type:"file",onChange:this.onFileSelected}),this.state.errorText));case this.Phases.Uploading:return r.createElement(s,null)}}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(221),s=n(10);e.exports=r.createClass({displayName:"ChangeDisplayName",mixins:[i],edit:function(){this.refs.displayname_edit.edit()},onValueChanged:function(e,t){t&&this.changeDisplayname(e)},render:function(){if(this.state.busy)return r.createElement(s,null);if(this.state.errorString)return r.createElement("div",{className:"error"},this.state.errorString);var e=o.getComponent("atoms.EditableText");return r.createElement(e,{ref:"displayname_edit",initialValue:this.state.displayName,label:"Click to set display name.",onValueChanged:this.onValueChanged})}})},function(e,t,n){"use strict";var r=n(1),o=n(222),i=n(10);e.exports=r.createClass({displayName:"ChangePassword",mixins:[o],onClickChange:function(){var e=this.refs.old_input.getDOMNode().value,t=this.refs.new_input.getDOMNode().value,n=this.refs.confirm_input.getDOMNode().value;t!=n?this.setState({state:this.Phases.Error,errorString:"Passwords don't match"}):""==t||""==e?this.setState({state:this.Phases.Error,errorString:"Passwords can't be empty"}):this.changePassword(e,t)},render:function(){switch(this.state.phase){case this.Phases.Edit:case this.Phases.Error:return r.createElement("div",null,r.createElement("div",{className:"mx_Dialog_content"},r.createElement("div",null,this.state.errorString),r.createElement("div",null,r.createElement("label",null,"Old password ",r.createElement("input",{type:"password",ref:"old_input"}))),r.createElement("div",null,r.createElement("label",null,"New password ",r.createElement("input",{type:"password",ref:"new_input"}))),r.createElement("div",null,r.createElement("label",null,"Confirm password ",r.createElement("input",{type:"password",ref:"confirm_input"})))),r.createElement("div",{className:"mx_Dialog_buttons"},r.createElement("button",{onClick:this.onClickChange},"Change Password"),r.createElement("button",{onClick:this.props.onFinished},"Cancel")));case this.Phases.Uploading:return r.createElement("div",{className:"mx_Dialog_content"},r.createElement(i,null));case this.Phases.Success:return r.createElement("div",null,r.createElement("div",{className:"mx_Dialog_content"},"Success!"),r.createElement("div",{className:"mx_Dialog_buttons"},r.createElement("button",{onClick:this.props.onFinished},"Ok")))}}})},function(e,t,n){"use strict";var r=n(1),o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];e.exports=r.createClass({displayName:"DateSeparator",render:function(){var e=new Date(this.props.ts),t=new Date,n=new Date;n.setDate(t.getDate()-1);var i;return i=e.toDateString()===t.toDateString()?"Today":e.toDateString()===n.toDateString()?"Yesterday":t.getTime()-e.getTime()<5184e5?o[e.getDay()]:e.toDateString(),r.createElement("h2",null,i)}})},function(e,t,n){"use strict";var r=n(1),o=n(59);e.exports=r.createClass({displayName:"EventAsTextTile",statics:{needsSenderProfile:function(){return!1}},render:function(){var e=o.textForEvent(this.props.mxEvent);return null==e||0==e.length?null:r.createElement("div",{className:"mx_EventAsTextTile"},o.textForEvent(this.props.mxEvent))}})},function(e,t,n){"use strict";var r=n(1),o=n(33),i=n(3),s=n(223),a=n(52),l={"m.room.message":"molecules.MessageTile","m.room.member":"molecules.EventAsTextTile","m.call.invite":"molecules.EventAsTextTile","m.call.answer":"molecules.EventAsTextTile","m.call.hangup":"molecules.EventAsTextTile","m.room.topic":"molecules.EventAsTextTile"};e.exports=r.createClass({displayName:"EventTile",mixins:[s],statics:{supportsEventType:function(e){return void 0!==l[e]}},getInitialState:function(){return{menu:!1}},onEditClicked:function(e){var t=i.getComponent("molecules.MessageContextMenu"),n=e.target.getBoundingClientRect(),r=n.right,o=n.top+e.target.height/2,s=this;a.createMenu(t,{mxEvent:this.props.mxEvent,left:r,top:o,onFinished:function(){s.setState({menu:!1})}}),this.setState({menu:!0})},render:function(){var e=i.getComponent("atoms.MessageTimestamp"),t=i.getComponent("molecules.SenderProfile"),n=i.getComponent("atoms.MemberAvatar"),s=this.props.mxEvent.getContent(),a=s.msgtype,c=i.getComponent(l[this.props.mxEvent.getType()]);if(!c)return null;var u=o({mx_EventTile:!0,mx_EventTile_sending:-1!==["sending","queued"].indexOf(this.props.mxEvent.status),mx_EventTile_notSent:"not_sent"==this.props.mxEvent.status,mx_EventTile_highlight:this.shouldHighlight(),mx_EventTile_continuation:this.props.continuation,mx_EventTile_last:this.props.last,menu:this.state.menu}),p=r.createElement(e,{ts:this.props.mxEvent.getTs()}),d=r.createElement("input",{type:"image",src:"img/edit.png",alt:"Edit",className:"mx_EventTile_editButton",onClick:this.onEditClicked}),h=null;"m.image"===a?h="sent an image":"m.video"===a?h="sent a video":"m.file"===a&&(h="uploaded a file");var m,f;return this.props.continuation||(this.props.mxEvent.sender&&(m=r.createElement("div",{className:"mx_EventTile_avatar"},r.createElement(n,{member:this.props.mxEvent.sender}))),c.needsSenderProfile()&&(f=r.createElement(t,{mxEvent:this.props.mxEvent,aux:h}))),r.createElement("div",{className:u},m,f,r.createElement("div",null,p,d,r.createElement(c,{mxEvent:this.props.mxEvent})))}})},function(e,t,n){"use strict";var r=n(1),o=n(224);e.exports=r.createClass({displayName:"MEmoteTile",mixins:[o],render:function(){var e=this.props.mxEvent,t=e.getContent(),n=e.sender?e.sender.name:e.getSender();return r.createElement("span",{ref:"content",className:"mx_MEmoteTile mx_MessageTile_content"},"* ",n," ",t.body)}})},function(e,t,n){"use strict";var r=n(1),o=n(225),i=n(2);e.exports=r.createClass({displayName:"MFileTile",mixins:[o],render:function(){var e=this.props.mxEvent.getContent(),t=i.get();return r.createElement("span",{className:"mx_MFileTile"},r.createElement("div",{className:"mx_MImageTile_download"},r.createElement("a",{href:t.mxcUrlToHttp(e.url),target:"_blank"},r.createElement("img",{src:"img/download.png",width:"10",height:"12"}),"Download ",this.presentableTextForFile(e))))}})},function(e,t,n){"use strict";var r=n(1),o=n(53),i=n(2),s=n(14),a=n(3);e.exports=r.createClass({displayName:"MImageTile",thumbHeight:function(e,t,n,r){if(e&&t){if(n>e&&r>t)return t;var o=n/e,i=r/t;return i>o?Math.floor(o*t):Math.floor(i*t)}},onClick:function(e){if(0==e.button&&!e.metaKey){e.preventDefault();var t=this.props.mxEvent.getContent(),n=i.get().mxcUrlToHttp(t.url),r=a.getComponent("atoms.ImageView");s.createDialog(r,{src:n,width:t.info.w,height:t.info.h})}},render:function(){var e=this.props.mxEvent.getContent(),t=i.get(),n=null;e.info&&(n=this.thumbHeight(e.info.w,e.info.h,320,240));var s={};return n&&(s.height=n),r.createElement("span",{className:"mx_MImageTile"},r.createElement("a",{href:t.mxcUrlToHttp(e.url),onClick:this.onClick},r.createElement("img",{className:"mx_MImageTile_thumbnail",src:t.mxcUrlToHttp(e.url,320,240),alt:e.body,style:s})),r.createElement("div",{className:"mx_MImageTile_download"},r.createElement("a",{href:t.mxcUrlToHttp(e.url),target:"_blank"},r.createElement("img",{src:"img/download.png",width:"10",height:"12"}),"Download ",e.body," (",e.info&&e.info.size?o(e.info.size):"Unknown size",")")))}})},function(e,t,n){"use strict";var r=n(1),o=n(226);e.exports=r.createClass({displayName:"MNoticeTile",mixins:[o],render:function(){var e=this.props.mxEvent.getContent();return r.createElement("span",{ref:"content",className:"mx_MNoticeTile mx_MessageTile_content"},e.body)}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(59);e.exports=r.createClass({displayName:"MRoomMemberTile",getMemberEventText:function(){return i.textForEvent(this.props.mxEvent)},render:function(){var e=this.props.last?r.createElement(n,{ts:this.props.mxEvent.getTs()}):null,t=this.getMemberEventText();if(!t)return r.createElement("div",null);var n=o.getComponent("atoms.MessageTimestamp"),i=o.getComponent("atoms.MemberAvatar");return r.createElement("div",{className:"mx_MessageTile mx_MessageTile_notice"},r.createElement("div",{className:"mx_MessageTile_avatar"},r.createElement(i,{member:this.props.mxEvent.sender})),e,r.createElement("span",{className:"mx_SenderProfile"}),r.createElement("span",{className:"mx_MessageTile_content"},t))}})},function(e,t,n){"use strict";var r=n(1),o=n(227);e.exports=r.createClass({displayName:"MTextTile",mixins:[o],render:function(){var e=this.props.mxEvent.getContent();return r.createElement("span",{ref:"content",className:"mx_MTextTile mx_MessageTile_content"},e.body)}})},function(e,t,n){"use strict";var r=n(1),o=n(3);e.exports=r.createClass({displayName:"MatrixToolbar",hideToolbar:function(){var e=o.getComponent("organisms.Notifier");e.setToolbarHidden(!0)},render:function(){var e=o.getComponent("atoms.EnableNotificationsButton");return r.createElement("div",{className:"mx_MatrixToolbar"},"You are not receiving desktop notifications. ",r.createElement(e,null),r.createElement("div",{className:"mx_MatrixToolbar_close"},r.createElement("img",{src:"img/close-white.png",width:"16",height:"16",onClick:this.hideToolbar})))}})},function(e,t,n){"use strict";var r=n(1),o=n(136),i=n(2),s=n(228);e.exports=r.createClass({displayName:"MemberInfo",mixins:[s],render:function(){var e,t,n,s,a,l;if(e=this.props.member.userId===i.get().credentials.userId?r.createElement("div",{className:"mx_ContextualMenu_field",onClick:this.onLeaveClick},"Leave room"):r.createElement("div",{className:"mx_ContextualMenu_field",onClick:this.onChatClick},"Start chat"),this.state.creatingRoom&&(l=r.createElement(o,{imgClassName:"mx_ContextualMenu_spinner"})),this.state.can.kick&&(t=r.createElement("div",{className:"mx_ContextualMenu_field",onClick:this.onKick},"Kick")),this.state.can.ban&&(n=r.createElement("div",{className:"mx_ContextualMenu_field",onClick:this.onBan},"Ban")),this.state.can.mute){var c=this.state.muted?"Unmute":"Mute";s=r.createElement("div",{className:"mx_ContextualMenu_field",onClick:this.onMuteToggle},c)}if(this.state.can.modifyLevel){var u=this.state.isTargetMod?"Revoke Mod":"Make Mod";a=r.createElement("div",{className:"mx_ContextualMenu_field",onClick:this.onModToggle},u)}return r.createElement("div",null,e,s,t,n,a,l)}})},function(e,t,n){"use strict";var r=n(1),o=n(2),i=n(3),s=n(52),a=n(229),l=/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/;e.exports=r.createClass({displayName:"MemberTile",mixins:[a],shouldComponentUpdate:function(e,t){return this.state.hover!==t.hover?!0:void 0===this.member_last_modified_time||this.member_last_modified_time<e.member.getLastModifiedTime()?!0:e.member.user&&(void 0===this.user_last_modified_time||this.user_last_modified_time<e.member.user.getLastModifiedTime())?!0:!1},mouseEnter:function(e){this.setState({hover:!0})},mouseLeave:function(e){this.setState({hover:!1})},onClick:function(e){var t=this;t.setState({menu:!0});var n=i.getComponent("molecules.MemberInfo");s.createMenu(n,{member:t.props.member,right:window.innerWidth-e.pageX,top:e.pageY,onFinished:function(){t.setState({menu:!1})}})},getDuration:function(e){if(e){var t=parseInt(e/1e3),n=t%60,r=parseInt(t/60)%60,o=parseInt(t/3600)%24,i=parseInt(t/86400);return 60>t?0>t?"0s":n+"s":3600>t?r+"m":86400>t?o+"h":i+"d "}},getPrettyPresence:function(e){if(!e)return"Unknown";var t=e.presence;return"online"===t?"Online":"unavailable"===t?"Idle":"offline"===t?"Offline":"Unknown"},getPowerLabel:function(){var e=this.props.member.userId;return this.state.isTargetMod&&(e+=" - Mod ("+this.props.member.powerLevelNorm+"%)"),e},render:function(){this.member_last_modified_time=this.props.member.getLastModifiedTime(),this.props.member.user&&(this.user_last_modified_time=this.props.member.user.getLastModifiedTime());var e,t=o.get().credentials.userId==this.props.member.userId;if(this.props.member&&this.props.member.powerLevelNorm>0){var n="img/p/p"+Math.floor(20*this.props.member.powerLevelNorm/100)+".png";e=r.createElement("img",{src:n,className:"mx_MemberTile_power",width:"48",height:"48",alt:""})}var s="mx_MemberTile_offline",a="mx_MemberTile ";this.props.member.user&&("online"===this.props.member.user.presence?s="mx_MemberTile_online":"unavailable"===this.props.member.user.presence&&(s="mx_MemberTile_unavailable")),a+=s,(this.state.hover||this.state.menu)&&(a+=" mx_MemberTile_hover");var c=this.props.member.name,u=t?r.createElement("img",{className:"mx_MemberTile_leave",src:"img/delete.png",width:"10",height:"10",onClick:this.onLeaveClick}):null,p="mx_MemberTile_name";l.test(c)&&(p+=" mx_MemberTile_zalgo");var d;if(this.state.hover||this.state.menu){var h,m=this.props.member.user?Date.now()-(this.props.member.user.lastPresenceTs-this.props.member.user.lastActiveAgo)||-1:-1;h=m>=0?r.createElement("div",{className:"mx_MemberTile_presence"},this.getPrettyPresence(this.props.member.user)," ",this.getDuration(m)," ago"):r.createElement("div",{className:"mx_MemberTile_presence"},this.getPrettyPresence(this.props.member.user)),d=r.createElement("div",{className:"mx_MemberTile_details"},u,r.createElement("div",{className:"mx_MemberTile_userId"},this.props.member.userId),h)}else d=r.createElement("div",{className:p},c);var f=i.getComponent("atoms.MemberAvatar");return r.createElement("div",{className:a,title:this.getPowerLabel(),onClick:this.onClick,onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave},r.createElement("div",{className:"mx_MemberTile_avatar"},r.createElement(f,{member:this.props.member}),e),d)}})},function(e,t,n){"use strict";var r=n(1),o=n(2),i=n(230),s=n(3);e.exports=r.createClass({displayName:"MessageComposer",mixins:[i],onUploadClick:function(e){this.refs.uploadInput.getDOMNode().click()},onUploadFileSelected:function(e){var t=e.target.files;t&&t.length>0&&this.props.uploadFile(t[0]),this.refs.uploadInput.getDOMNode().value=null},render:function(){var e=this.props.room.getMember(o.get().credentials.userId),t={display:"none"},n=s.getComponent("atoms.MemberAvatar");return r.createElement("div",{className:"mx_MessageComposer"},r.createElement("div",{className:"mx_MessageComposer_wrapper"},r.createElement("div",{className:"mx_MessageComposer_row"},r.createElement("div",{className:"mx_MessageComposer_avatar"},r.createElement(n,{member:e})),r.createElement("div",{className:"mx_MessageComposer_input"},r.createElement("textarea",{ref:"textarea",onKeyDown:this.onKeyDown,placeholder:"Type a message"})),r.createElement("div",{className:"mx_MessageComposer_upload",onClick:this.onUploadClick},r.createElement("img",{src:"img/upload.png",width:"32",height:"32"}),r.createElement("input",{type:"file",style:t,ref:"uploadInput",onChange:this.onUploadFileSelected})))))}})},function(e,t,n){"use strict";var r=n(1),o=n(2),i=n(5),s=n(3),a=n(14);e.exports=r.createClass({displayName:"MessageContextMenu",onResendClick:function(){o.get().resendEvent(this.props.mxEvent,o.get().getRoom(this.props.mxEvent.getRoomId())).done(function(){i.dispatch({action:"message_sent"})},function(){i.dispatch({action:"message_send_failed"})}),i.dispatch({action:"message_resend_started"}),this.props.onFinished&&this.props.onFinished()},onViewSourceClick:function(){var e=s.getComponent("organisms.ViewSource");a.createDialog(e,{mxEvent:this.props.mxEvent}),this.props.onFinished&&this.props.onFinished()},onRedactClick:function(){o.get().redactEvent(this.props.mxEvent.getRoomId(),this.props.mxEvent.getId()).done(function(){},function(e){var t=s.getComponent("organisms.ErrorDialog"),n=e.errcode||e.statusCode;a.createDialog(t,{title:"Error",description:"You cannot delete this message. ("+n+")"})}),this.props.onFinished&&this.props.onFinished()},render:function(){var e,t,n;return"not_sent"==this.props.mxEvent.status?e=r.createElement("div",{className:"mx_ContextualMenu_field",onClick:this.onResendClick},"Resend"):n=r.createElement("div",{className:"mx_ContextualMenu_field",onClick:this.onRedactClick},"Delete"),t=r.createElement("div",{className:"mx_ContextualMenu_field",onClick:this.onViewSourceClick},"View Source"),r.createElement("div",null,e,n,t)}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(231);e.exports=r.createClass({displayName:"MessageTile",mixins:[i],statics:{needsSenderProfile:function(){return!0}},render:function(){var e=o.getComponent("molecules.UnknownMessageTile"),t={"m.text":o.getComponent("molecules.MTextTile"),"m.notice":o.getComponent("molecules.MNoticeTile"),"m.emote":o.getComponent("molecules.MEmoteTile"),"m.image":o.getComponent("molecules.MImageTile"),"m.file":o.getComponent("molecules.MFileTile")},n=this.props.mxEvent.getContent(),i=n.msgtype,s=e;return i&&t[i]&&(s=t[i]),r.createElement(s,{mxEvent:this.props.mxEvent})}})},function(e,t,n){"use strict";var r=n(1),o=n(232);e.exports=r.createClass({displayName:"ProgressBar",mixins:[o],render:function(){var e={width:this.props.value/this.props.max*100+"%"};return r.createElement("div",{className:"mx_ProgressBar"},r.createElement("div",{className:"mx_ProgressBar_fill",style:e}))}})},function(e,t,n){"use strict";var r=n(1);e.exports=r.createClass({displayName:"RoomCreate",render:function(){return r.createElement("div",{className:"mx_RoomCreate"},r.createElement("div",{className:"mx_RoomCreate_table"},r.createElement("div",{className:"mx_RoomTile"},r.createElement("div",{className:"mx_RoomTile_avatar"},r.createElement("img",{src:"img/create.png",width:"32",height:"32"})),r.createElement("div",{className:"mx_RoomTile_name"},"Create new room"))))}})},function(e,t,n){"use strict";var r=n(1);e.exports=r.createClass({displayName:"RoomDropTarget",render:function(){return r.createElement("div",{className:"mx_RoomDropTarget"},this.props.text)}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(5),s=n(23),a=n(2),l=n(233);e.exports=r.createClass({displayName:"RoomHeader",mixins:[l],onNameChange:function(e){this.props.room.name!=e&&e&&a.get().setRoomName(this.props.room.roomId,e)},getRoomName:function(){return this.refs.name_edit.getDOMNode().value},onFullscreenClick:function(){i.dispatch({action:"video_fullscreen",fullscreen:!0},!0)},render:function(){var e,t=o.getComponent("atoms.EditableText"),n=o.getComponent("atoms.RoomAvatar");if(this.props.simpleHeader)e=r.createElement("div",{className:"mx_RoomHeader_wrapper"},r.createElement("div",{className:"mx_RoomHeader_simpleHeader"},this.props.simpleHeader));else{var i,a,l=this.props.room.currentState.getStateEvents("m.room.topic","");if(this.state&&"ended"!=this.state.call_state){var c=s.getCallForRoom(this.props.room.roomId);i=r.createElement("div",{className:"mx_RoomHeader_textButton",onClick:this.onHangupClick},"End call")}var u=null,p=null,d=null,h=null,m=null,f=this.props.room.currentState.getStateEvents("m.room.name","");f&&(f=f.getContent().name),this.props.editing?(u=r.createElement("div",{className:"mx_RoomHeader_nameEditing"},r.createElement("input",{className:"mx_RoomHeader_nameInput",type:"text",defaultValue:f,placeholder:"Name",ref:"name_edit"})),d=r.createElement("div",{className:"mx_RoomHeader_textButton",onClick:this.props.onCancelClick},"Cancel"),h=r.createElement("div",{className:"mx_RoomHeader_textButton",onClick:this.props.onSaveClick},"Save Changes")):(u=r.createElement("div",{className:"mx_RoomHeader_name"},r.createElement(t,{label:this.props.room.name,initialValue:f,placeHolder:"Name",onValueChanged:this.onNameChange})),l&&(p=r.createElement("div",{className:"mx_RoomHeader_topic",title:l.getContent().topic},l.getContent().topic)),m=r.createElement("div",{className:"mx_RoomHeader_button",onClick:this.props.onSettingsClick},r.createElement("img",{src:"img/settings.png",width:"32",height:"32"})));var g=null;this.props.room&&(g=r.createElement(n,{room:this.props.room,width:"48",height:"48"})),c&&"video"==c.type&&(a=r.createElement("div",{className:"mx_RoomHeader_button",onClick:this.onFullscreenClick},r.createElement("img",{src:"img/zoom.png",title:"Fullscreen",alt:"Fullscreen",width:"32",height:"32",style:{marginTop:"3px"}}))),e=r.createElement("div",{className:"mx_RoomHeader_wrapper"},r.createElement("div",{className:"mx_RoomHeader_leftRow"},r.createElement("div",{className:"mx_RoomHeader_avatar"},g),r.createElement("div",{className:"mx_RoomHeader_info"},u,p)),i,d,h,r.createElement("div",{className:"mx_RoomHeader_rightRow"},m,a,r.createElement("div",{className:"mx_RoomHeader_button mx_RoomHeader_search"},r.createElement("img",{src:"img/search.png",title:"Search",alt:"Search",width:"32",height:"32"})),r.createElement("div",{className:"mx_RoomHeader_button mx_RoomHeader_video",onClick:c&&"video"===c.type?this.onMuteVideoClick:this.onVideoClick},r.createElement("img",{src:"img/video.png",title:"Video call",alt:"Video call",width:"32",height:"32"})),r.createElement("div",{className:"mx_RoomHeader_button mx_RoomHeader_voice",onClick:c?this.onMuteAudioClick:this.onVoiceClick},r.createElement("img",{src:"img/voip.png",title:"VoIP call",alt:"VoIP call",width:"32",height:"32"}))))}return r.createElement("div",{className:"mx_RoomHeader"},e)}})},function(e,t,n){"use strict";var r=n(1),o=n(2),i=n(3),s=n(234);e.exports=r.createClass({displayName:"RoomSettings",mixins:[s],getTopic:function(){return this.refs.topic.getDOMNode().value},getJoinRules:function(){return this.refs.is_private.getDOMNode().checked?"invite":"public"},getHistoryVisibility:function(){return this.refs.share_history.getDOMNode().checked?"shared":"invited"},getPowerLevels:function(){if(this.state.power_levels_changed){var e=this.props.room.currentState.getStateEvents("m.room.power_levels","");e=e.getContent();var t={ban:parseInt(this.refs.ban.getDOMNode().value),kick:parseInt(this.refs.kick.getDOMNode().value),redact:parseInt(this.refs.redact.getDOMNode().value),invite:parseInt(this.refs.invite.getDOMNode().value),events_default:parseInt(this.refs.events_default.getDOMNode().value),state_default:parseInt(this.refs.state_default.getDOMNode().value),users_default:parseInt(this.refs.users_default.getDOMNode().value),users:e.users,events:e.events};return t}},onPowerLevelsChanged:function(){this.setState({power_levels_changed:!0})},render:function(){var e=i.getComponent("molecules.ChangeAvatar"),t=this.props.room.currentState.getStateEvents("m.room.topic","");t&&(t=t.getContent().topic);var n=this.props.room.currentState.getStateEvents("m.room.join_rules","");n&&(n=n.getContent().join_rule);var s=this.props.room.currentState.getStateEvents("m.room.history_visibility","");s&&(s=s.getContent().history_visibility);var a=this.props.room.currentState.getStateEvents("m.room.power_levels",""),l=a.events||{};if(a){a=a.getContent();var c=parseInt(a.ban),u=parseInt(a.kick),p=parseInt(a.redact),d=parseInt(a.invite||0),h=parseInt(a.events_default||0),m=parseInt(a.state_default||0),f=parseInt(a.users_default||0);void 0==a.ban&&(c=50),void 0==a.kick&&(u=50),void 0==a.redact&&(p=50);var g=a.users||{},v=o.get().credentials.userId,y=g[v];void 0==y&&(y=f);var _=l["m.room.power_levels"];void 0==_&&(_=m);var E=y>=_}else var c=50,u=50,p=50,d=0,h=0,m=0,f=0,g=[],l=[],y=0,_=0,E=!1;var b=parseInt(a.state_default||0);void 0!==l["m.room.avatar"]&&(b=l["m.room.avatar"]);var C,x=y>=b;x&&(C=r.createElement("div",null,r.createElement("h3",null,"Room Icon"),r.createElement(e,{room:this.props.room})));var w=this.props.room.getMembersWithMembership("ban");return r.createElement("div",{className:"mx_RoomSettings"},r.createElement("textarea",{className:"mx_RoomSettings_description",placeholder:"Topic",defaultValue:t,ref:"topic"})," ",r.createElement("br",null),r.createElement("label",null,r.createElement("input",{type:"checkbox",ref:"is_private",defaultChecked:"public"!=n})," Make this room private")," ",r.createElement("br",null),r.createElement("label",null,r.createElement("input",{type:"checkbox",ref:"share_history",defaultChecked:"shared"==s})," Share message history with new users")," ",r.createElement("br",null),r.createElement("label",{className:"mx_RoomSettings_encrypt"},r.createElement("input",{type:"checkbox"})," Encrypt room")," ",r.createElement("br",null),r.createElement("h3",null,"Power levels"),r.createElement("div",{className:"mx_RoomSettings_power_levels mx_RoomSettings_settings"},r.createElement("div",null,r.createElement("label",{htmlFor:"mx_RoomSettings_ban_level"},"Ban level"),r.createElement("input",{type:"text",defaultValue:c,size:"3",ref:"ban",id:"mx_RoomSettings_ban_level",disabled:!E||c>y,onChange:this.onPowerLevelsChanged})),r.createElement("div",null,r.createElement("label",{htmlFor:"mx_RoomSettings_kick_level"},"Kick level"),r.createElement("input",{type:"text",defaultValue:u,size:"3",ref:"kick",id:"mx_RoomSettings_kick_level",disabled:!E||u>y,onChange:this.onPowerLevelsChanged})),r.createElement("div",null,r.createElement("label",{htmlFor:"mx_RoomSettings_redact_level"},"Redact level"),r.createElement("input",{type:"text",defaultValue:p,size:"3",ref:"redact",id:"mx_RoomSettings_redact_level",disabled:!E||p>y,onChange:this.onPowerLevelsChanged})),r.createElement("div",null,r.createElement("label",{htmlFor:"mx_RoomSettings_invite_level"},"Invite level"),r.createElement("input",{type:"text",defaultValue:d,size:"3",ref:"invite",id:"mx_RoomSettings_invite_level",disabled:!E||d>y,onChange:this.onPowerLevelsChanged})),r.createElement("div",null,r.createElement("label",{htmlFor:"mx_RoomSettings_event_level"},"Send event level"),r.createElement("input",{type:"text",defaultValue:h,size:"3",ref:"events_default",id:"mx_RoomSettings_event_level",disabled:!E||h>y,onChange:this.onPowerLevelsChanged})),r.createElement("div",null,r.createElement("label",{htmlFor:"mx_RoomSettings_state_level"},"Set state level"),r.createElement("input",{type:"text",defaultValue:m,size:"3",ref:"state_default",id:"mx_RoomSettings_state_level",disabled:!E||m>y,onChange:this.onPowerLevelsChanged})),r.createElement("div",null,r.createElement("label",{htmlFor:"mx_RoomSettings_user_level"},"Default user level"),r.createElement("input",{type:"text",defaultValue:f,size:"3",ref:"users_default",id:"mx_RoomSettings_user_level",disabled:!E||f>y,onChange:this.onPowerLevelsChanged}))),r.createElement("h3",null,"User levels"),r.createElement("div",{className:"mx_RoomSettings_user_levels mx_RoomSettings_settings"},Object.keys(g).map(function(e,t){return r.createElement("div",{key:e},r.createElement("label",{htmlFor:"mx_RoomSettings_user_"+t},e),r.createElement("input",{type:"text",defaultValue:g[e],size:"3",id:"mx_RoomSettings_user_"+t,disabled:!0}))})),r.createElement("h3",null,"Event levels"),r.createElement("div",{
className:"mx_RoomSettings_event_lvels mx_RoomSettings_settings"},Object.keys(l).map(function(e,t){return r.createElement("div",{key:e},r.createElement("label",{htmlFor:"mx_RoomSettings_event_"+t},e),r.createElement("input",{type:"text",defaultValue:l[e],size:"3",id:"mx_RoomSettings_event_"+t,disabled:!0}))})),r.createElement("h3",null,"Banned users"),r.createElement("div",{className:"mx_RoomSettings_banned"},w.map(function(e,t){return r.createElement("div",{key:t},e.userId)})),C)}})},function(e,t,n){"use strict";var r=n(1),o=n(33),i=n(235),s=n(2),a=n(3);e.exports=r.createClass({displayName:"RoomTile",mixins:[i],getInitialState:function(){return{hover:!1}},onMouseEnter:function(){this.setState({hover:!0})},onMouseLeave:function(){this.setState({hover:!1})},render:function(){var e,t=s.get().credentials.userId,n=o({mx_RoomTile:!0,mx_RoomTile_selected:this.props.selected,mx_RoomTile_unread:this.props.unread,mx_RoomTile_highlight:this.props.highlight,mx_RoomTile_invited:"invite"==this.props.room.currentState.members[t].membership}),i=this.props.room.name.replace(":",":​");this.props.highlight&&(e=r.createElement("div",{className:"mx_RoomTile_badge"}));var l;if(this.props.collapsed){if(this.state.hover){var c=a.getComponent("molecules.RoomTooltip");l=r.createElement(c,{room:this.props.room})}}else l=r.createElement("div",{className:"mx_RoomTile_name"},i);var u=a.getComponent("atoms.RoomAvatar");return r.createElement("div",{className:n,onClick:this.onClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},r.createElement("div",{className:"mx_RoomTile_avatar"},r.createElement(u,{room:this.props.room}),e),l)}})},function(e,t,n){"use strict";var r=n(1),o=n(5);e.exports=r.createClass({displayName:"RoomTooltip",componentDidMount:function(){if(this.props.bottom){var e=this.getDOMNode();e.style.top=e.parentElement.getBoundingClientRect().top+"px",e.style.display="block"}else o.dispatch({action:"view_tooltip",tooltip:this.getDOMNode()})},componentDidUnmount:function(){this.props.bottom||o.dispatch({action:"view_tooltip",tooltip:null})},render:function(){var e=this.props.room?this.props.room.name:this.props.label;return r.createElement("div",{className:"mx_RoomTooltip"},r.createElement("img",{className:"mx_RoomTooltip_chevron",src:"img/chevron-left.png",width:"9",height:"16"}),e)}})},function(e,t,n){"use strict";var r=n(1),o=n(33),i=/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/;e.exports=r.createClass({displayName:"SenderProfile",render:function(){var e=this.props.mxEvent,t=e.sender?e.sender.name:e.getSender(),n=o({mx_SenderProfile:!0,mx_SenderProfile_zalgo:i.test(t)}),s=e.getContent().msgtype;return s&&"m.emote"==s&&(t=""),r.createElement("span",{className:n},t," ",this.props.aux)}})},function(e,t,n){"use strict";var r=n(1),o=n(14),i=n(3),s=n(236);e.exports=r.createClass({displayName:"ServerConfig",mixins:[s],showHelpPopup:function(){var e=i.getComponent("organisms.ErrorDialog");o.createDialog(e,{title:"Custom Server Options",description:"You can use the custom server options to log into other Matrix servers by specifying a different Home server URL. This allows you to use Vector with an existing Matrix account on a different Home server. You can also set a cutom Identity server but this will affect people ability to find you if you use a server in a group other than tha main Matrix.org group.",button:"Dismiss",focus:!0})},render:function(){return r.createElement("div",{className:"mx_ServerConfig"},r.createElement("label",{className:"mx_Login_label mx_ServerConfig_hslabel",htmlFor:"hsurl"},"Home server URL"),r.createElement("input",{className:"mx_Login_field",id:"hsurl",type:"text",value:this.state.hs_url,onChange:this.hsChanged}),r.createElement("label",{className:"mx_Login_label mx_ServerConfig_islabel",htmlFor:"isurl"},"Identity server URL"),r.createElement("input",{className:"mx_Login_field",type:"text",value:this.state.is_url,onChange:this.isChanged}),r.createElement("a",{className:"mx_ServerConfig_help",href:"#",onClick:this.showHelpPopup},"What does this mean?"))}})},function(e,t,n){"use strict";var r=n(1);e.exports=r.createClass({displayName:"UnknownMessageTile",render:function(){var e=this.props.mxEvent.getContent();return r.createElement("span",{className:"mx_UnknownMessageTile"},e.body)}})},function(e,t,n){"use strict";var r=n(1),o=n(237);e.exports=r.createClass({displayName:"UserSelector",mixins:[o],onAddUserId:function(){this.addUser(this.refs.user_id_input.getDOMNode().value),this.refs.user_id_input.getDOMNode().value=""},render:function(){var e=this;return r.createElement("div",null,r.createElement("ul",{className:"mx_UserSelector_UserIdList",ref:"list"},this.props.selected_users.map(function(t,n){return r.createElement("li",{key:t},t," - ",r.createElement("span",{onClick:function(){e.removeUser(t)}},"X"))})),r.createElement("input",{type:"text",ref:"user_id_input",defaultValue:"",className:"mx_UserSelector_userIdInput",placeholder:"ex. @bob:example.com"}),r.createElement("button",{onClick:this.onAddUserId,className:"mx_UserSelector_AddUserId"},"Add User"))}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(124);e.exports=r.createClass({displayName:"CallView",mixins:[i],getVideoView:function(){return this.refs.video},render:function(){var e=o.getComponent("molecules.voip.VideoView");return r.createElement(e,{ref:"video"})}})},function(e,t,n){"use strict";var r=n(1),o=n(2),i=n(238);e.exports=r.createClass({displayName:"IncomingCallBox",mixins:[i],getRingAudio:function(){return this.refs.ringAudio.getDOMNode()},render:function(){var e=r.createElement("audio",{ref:"ringAudio",key:"voip_ring_audio",loop:!0},r.createElement("source",{src:"media/ring.ogg",type:"audio/ogg"}),r.createElement("source",{src:"media/ring.mp3",type:"audio/mpeg"}));if(!this.state.incomingCall||!this.state.incomingCall.roomId)return r.createElement("div",null,e);var t=o.get().getRoom(this.state.incomingCall.roomId).name;return r.createElement("div",{className:"mx_IncomingCallBox"},e,r.createElement("img",{className:"mx_IncomingCallBox_chevron",src:"img/chevron-left.png",width:"9",height:"16"}),r.createElement("div",{className:"mx_IncomingCallBox_title"},"Incoming ",this.state.incomingCall?this.state.incomingCall.type:""," call from ",t),r.createElement("div",{className:"mx_IncomingCallBox_buttons"},r.createElement("div",{className:"mx_IncomingCallBox_buttons_cell"},r.createElement("div",{className:"mx_IncomingCallBox_buttons_decline",onClick:this.onRejectClick},"Decline")),r.createElement("div",{className:"mx_IncomingCallBox_buttons_cell"},r.createElement("div",{className:"mx_IncomingCallBox_buttons_accept",onClick:this.onAnswerClick},"Accept"))))}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(5);e.exports=r.createClass({displayName:"VideoView",componentWillMount:function(){i.register(this.onAction)},getRemoteVideoElement:function(){return this.refs.remote.getDOMNode()},getRemoteAudioElement:function(){return this.refs.remoteAudio.getDOMNode()},getLocalVideoElement:function(){return this.refs.local.getDOMNode()},setContainer:function(e){this.container=e},onAction:function(e){switch(e.action){case"video_fullscreen":if(!this.container)return;var t=this.container.getDOMNode();if(e.fullscreen){var n=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullscreen;n.call(t)}else{var r=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen;r&&r.call(document)}}},render:function(){var e=o.getComponent("atoms.voip.VideoFeed");return r.createElement("div",{className:"mx_VideoView",ref:this.setContainer},r.createElement("div",{className:"mx_VideoView_remoteVideoFeed"},r.createElement(e,{ref:"remote"}),r.createElement("audio",{ref:"remoteAudio"})),r.createElement("div",{className:"mx_VideoView_localVideoFeed"},r.createElement(e,{ref:"local"})))}})},function(e,t,n){"use strict";var r=n(1),o=n(239);e.exports=r.createClass({displayName:"CasLogin",mixins:[o],render:function(){return r.createElement("div",null,r.createElement("button",{onClick:this.onCasClicked},"Sign in with CAS"))}})},function(e,t,n){"use strict";var r=n(1),o=n(240),i=n(3),s=n(60).Presets,a=n(10);e.exports=r.createClass({displayName:"CreateRoom",mixins:[o],getPreset:function(){return this.refs.presets.getPreset()},getName:function(){return this.refs.name_textbox.getName()},getTopic:function(){return this.refs.topic.getTopic()},getAliasLocalpart:function(){return this.refs.alias.getAliasLocalpart()},getInvitedUsers:function(){return this.refs.user_selector.getUserIds()},onPresetChanged:function(e){switch(e){case s.PrivateChat:this.setState({preset:e,is_private:!0,share_history:!1});break;case s.PublicChat:this.setState({preset:e,is_private:!1,share_history:!0});break;case s.Custom:this.setState({preset:e})}},onPrivateChanged:function(e){this.setState({preset:s.Custom,is_private:e.target.checked})},onShareHistoryChanged:function(e){this.setState({preset:s.Custom,share_history:e.target.checked})},onTopicChange:function(e){this.setState({topic:e.target.value})},onNameChange:function(e){this.setState({room_name:e.target.value})},onInviteChanged:function(e){this.setState({invited_users:e})},onAliasChanged:function(e){this.setState({alias:e})},onEncryptChanged:function(e){this.setState({encrypt:e.target.checked})},render:function(){var e=this.state.phase;if(e==this.phases.CREATING)return r.createElement(a,null);var t="";e==this.phases.ERROR&&(t=r.createElement("div",{className:"mx_Error"},"An error occured: ",this.state.error_string));var n=i.getComponent("atoms.create_room.CreateRoomButton"),o=i.getComponent("atoms.create_room.RoomAlias"),s=i.getComponent("atoms.create_room.Presets"),l=i.getComponent("molecules.UserSelector"),c=i.getComponent("molecules.RoomHeader");return r.createElement("div",{className:"mx_CreateRoom"},r.createElement(c,{simpleHeader:"Create room"}),r.createElement("div",{className:"mx_CreateRoom_body"},r.createElement("input",{type:"text",ref:"room_name",value:this.state.room_name,onChange:this.onNameChange,placeholder:"Name"})," ",r.createElement("br",null),r.createElement("textarea",{className:"mx_CreateRoom_description",ref:"topic",value:this.state.topic,onChange:this.onTopicChange,placeholder:"Topic"})," ",r.createElement("br",null),r.createElement(o,{ref:"alias",alias:this.state.alias,onChange:this.onAliasChanged})," ",r.createElement("br",null),r.createElement(l,{ref:"user_selector",selected_users:this.state.invited_users,onChange:this.onInviteChanged})," ",r.createElement("br",null),r.createElement(s,{ref:"presets",onChange:this.onPresetChanged,preset:this.state.preset})," ",r.createElement("br",null),r.createElement("div",null,r.createElement("label",null,r.createElement("input",{type:"checkbox",ref:"is_private",checked:this.state.is_private,onChange:this.onPrivateChanged})," Make this room private")),r.createElement("div",null,r.createElement("label",null,r.createElement("input",{type:"checkbox",ref:"share_history",checked:this.state.share_history,onChange:this.onShareHistoryChanged})," Share message history with new users")),r.createElement("div",{className:"mx_CreateRoom_encrypt"},r.createElement("label",null,r.createElement("input",{type:"checkbox",ref:"encrypt",checked:this.state.encrypt,onChange:this.onEncryptChanged})," Encrypt room")),r.createElement("div",null,r.createElement(n,{onCreateRoom:this.onCreateRoom})," ",r.createElement("br",null)),t))}})},function(e,t,n){"use strict";var r=n(1),o=n(241);e.exports=r.createClass({displayName:"ErrorDialog",mixins:[o],render:function(){return r.createElement("div",{className:"mx_ErrorDialog"},r.createElement("div",{className:"mx_ErrorDialogTitle"},this.props.title),r.createElement("div",{className:"mx_Dialog_content"},this.props.description),r.createElement("div",{className:"mx_Dialog_buttons"},r.createElement("button",{onClick:this.props.onFinished,autoFocus:this.props.focus},this.props.button)))}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(5);e.exports=r.createClass({displayName:"LeftPanel",onHideClick:function(){i.dispatch({action:"hide_left_panel"})},render:function(){var e,t=o.getComponent("organisms.RoomList"),n=o.getComponent("molecules.BottomLeftMenu"),i=o.getComponent("molecules.voip.IncomingCallBox"),s="mx_LeftPanel";return this.props.collapsed?s+=" collapsed":e=r.createElement("img",{className:"mx_LeftPanel_hideButton",onClick:this.onHideClick,src:"img/hide.png",width:"12",height:"20",alt:"<"}),r.createElement("aside",{className:s},e,r.createElement(i,null),r.createElement(t,{selectedRoom:this.props.selectedRoom,collapsed:this.props.collapsed}),r.createElement(n,{collapsed:this.props.collapsed}))}})},function(e,t,n){"use strict";var r=n(1),o=n(242);e.exports=r.createClass({displayName:"LogoutPrompt",mixins:[o],render:function(){return r.createElement("div",null,r.createElement("div",{className:"mx_Dialog_content"},"Sign out?"),r.createElement("div",{className:"mx_Dialog_buttons"},r.createElement("button",{onClick:this.logOut},"Sign Out"),r.createElement("button",{onClick:this.cancelPrompt},"Cancel")))}})},function(e,t,n){"use strict";var r=n(1),o=n(33),i=n(10),s=n(243),a=n(3);e.exports=r.createClass({displayName:"MemberList",mixins:[s],getInitialState:function(){return{editing:!1}},memberSort:function(e,t){var n=this.memberDict[e].user,r=this.memberDict[t].user,o={online:3,unavailable:2,offline:1},i=n?o[n.presence]:0,s=r?o[r.presence]:0;if(i!=s)return s-i;var a=n?n.lastPresenceTs-(n.lastActiveAgo||n.lastPresenceTs):0,l=r?r.lastPresenceTs-(r.lastActiveAgo||r.lastPresenceTs):0;return l-a},makeMemberTiles:function(e){var t=a.getComponent("molecules.MemberTile"),n=this;return n.state.members.filter(function(t){var r=n.memberDict[t];return r.membership==e}).map(function(e){var o=n.memberDict[e];return r.createElement(t,{key:e,member:o,ref:e})})},onPopulateInvite:function(e,t){this.refs.invite.setValue("Invite",!1,!0),this.setState({editing:!1}),t&&this.onInvite(e)},onClickInvite:function(e){this.setState({editing:!0}),this.refs.invite.onClickDiv(),e.stopPropagation(),e.preventDefault()},inviteTile:function(){var e=o({mx_MemberTile:!0,mx_MemberTile_inviteTile:!0,mx_MemberTile_inviteEditing:this.state.editing}),t=a.getComponent("atoms.EditableText");return this.state.inviting?r.createElement(i,null):r.createElement("div",{className:e,onClick:this.onClickInvite},r.createElement("div",{className:"mx_MemberTile_avatar"},r.createElement("img",{src:"img/create-big.png",width:"40",height:"40",alt:""})),r.createElement("div",{className:"mx_MemberTile_name"},r.createElement(t,{ref:"invite",label:"Invite",placeHolder:"@user:domain.com",initialValue:"",onValueChanged:this.onPopulateInvite})))},render:function(){var e=null,t=this.makeMemberTiles("invite");return t.length>0&&(e=r.createElement("div",null,r.createElement("h2",null,"Invited"),r.createElement("div",{className:"mx_MemberList_wrapper"},t))),r.createElement("div",{className:"mx_MemberList"},r.createElement("div",{className:"mx_MemberList_chevron"},r.createElement("img",{src:"img/chevron.png",width:"24",height:"13"})),r.createElement("div",{className:"mx_MemberList_border"},r.createElement("div",null,r.createElement("h2",null,"Members"),r.createElement("div",{className:"mx_MemberList_wrapper"},this.makeMemberTiles("join"))),e,this.inviteTile()))}})},function(e,t,n){(function(t){"use strict";var r=n(244),o=n(59),i=n(61),s=n(5),a=n(85),l={notificationMessageForEvent:function(e){return o.textForEvent(e)},displayNotification:function(e,n){if(t.Notification&&"granted"==t.Notification.permission&&!t.document.hasFocus()){var r=this.notificationMessageForEvent(e);if(r){var o;e.sender&&n.name!=e.sender.name?"m.room.member"==e.getType()?o=n.name:e.sender&&(o=e.sender.name+" ("+n.name+")",e.getContent().body&&(r=e.getContent().body)):(o=n.name,e.getContent().body&&(r=e.getContent().body));var i=e.sender?a.avatarUrlForMember(e.sender,40,40,"crop"):null,l=new t.Notification(o,{body:r,icon:i,tag:"vector"});l.onclick=function(){s.dispatch({action:"view_room",room_id:n.roomId}),t.focus()},t.setTimeout(function(){l.close()},5e3)}}}},c=function(){};i(c.prototype,r),i(c.prototype,l),e.exports=new c}).call(t,function(){return this}())},function(e,t,n){"use strict";var r=n(1),o=n(245);e.exports=r.createClass({displayName:"QuestionDialog",mixins:[o],onOk:function(){this.props.onFinished(!0)},onCancel:function(){this.props.onFinished(!1)},render:function(){return r.createElement("div",{className:"mx_QuestionDialog"},r.createElement("div",{className:"mx_QuestionDialogTitle"},this.props.title),r.createElement("div",{className:"mx_Dialog_content"},this.props.description),r.createElement("div",{className:"mx_Dialog_buttons"},r.createElement("button",{onClick:this.onOk,autoFocus:this.props.focus},this.props.button),r.createElement("button",{onClick:this.onCancel},"Cancel")))}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(5);e.exports=r.createClass({displayName:"RightPanel",Phase:{MemberList:"MemberList",FileList:"FileList"},getInitialState:function(){return{phase:this.Phase.MemberList}},onMemberListButtonClick:function(){this.props.collapsed?(this.setState({phase:this.Phase.MemberList}),i.dispatch({action:"show_right_panel"})):i.dispatch({action:"hide_right_panel"})},render:function(){var e,t,n=o.getComponent("organisms.MemberList");this.props.roomId&&(e=r.createElement("div",{className:"mx_RightPanel_headerButtonGroup"},r.createElement("div",{className:"mx_RightPanel_headerButton mx_RightPanel_filebutton"},r.createElement("img",{src:"img/file.png",width:"32",height:"32",title:"Files",alt:"Files"})),r.createElement("div",{className:"mx_RightPanel_headerButton",onClick:this.onMemberListButtonClick},r.createElement("img",{src:"img/members.png",width:"32",height:"32",title:"Members",alt:"Members"}))),this.props.collapsed||this.state.phase!=this.Phase.MemberList||(t=r.createElement(n,{roomId:this.props.roomId,key:this.props.roomId})));var i="mx_RightPanel";return this.props.collapsed&&(i+=" collapsed"),r.createElement("aside",{className:i},r.createElement("div",{className:"mx_RightPanel_header"},e),t)}})},function(e,t,n){"use strict";var r=n(1),o=n(2),i=n(14),s=n(3),a=n(5),l=n(10);e.exports=r.createClass({displayName:"RoomDirectory",getInitialState:function(){return{publicRooms:[],roomAlias:"",loading:!0}},componentDidMount:function(){var e=this;o.get().publicRooms(function(t,n){if(t){e.setState({loading:!1}),console.error("Failed to get publicRooms: %s",JSON.stringify(t));var r=s.getComponent("organisms.ErrorDialog");i.createDialog(r,{title:"Failed to get public room list",description:t.message})}else e.setState({publicRooms:n.chunk,loading:!1}),e.forceUpdate()})},joinRoom:function(e){var t=this;t.setState({loading:!0}),o.get().joinRoom(e).done(function(){a.dispatch({action:"view_room",room_id:e})},function(e){console.error("Failed to join room: %s",JSON.stringify(e)),i.createDialog(ErrorDialog,{title:"Failed to join room",description:e.message})})},getRows:function(e){if(!this.state.publicRooms)return[];for(var t=this.state.publicRooms.filter(function(t){return t.aliases[0].search(e)>=0&&t.num_joined_members>0}).sort(function(e,t){return e.num_joined_members-t.num_joined_members}),n=[],o=this,i=0;i<t.length;i++){var s=t[i].name||t[i].aliases[0];n.unshift(r.createElement("tbody",{key:t[i].room_id},r.createElement("tr",{onClick:o.joinRoom.bind(null,t[i].room_id)},r.createElement("td",{className:"mx_RoomDirectory_name"},s),r.createElement("td",null,t[i].aliases[0]),r.createElement("td",null,t[i].num_joined_members)),r.createElement("tr",null,r.createElement("td",{className:"mx_RoomDirectory_topic",colSpan:"3"},t[i].topic))))}return n},onKeyUp:function(e){this.forceUpdate(),this.setState({roomAlias:this.refs.roomAlias.getDOMNode().value}),"Enter"==e.key&&this.joinRoom(this.refs.roomAlias.getDOMNode().value),"Down"==e.key},render:function(){if(this.state.loading)return r.createElement("div",{className:"mx_RoomDirectory"},r.createElement(l,null));var e=s.getComponent("molecules.RoomHeader");return r.createElement("div",{className:"mx_RoomDirectory"},r.createElement(e,{simpleHeader:"Public Rooms"}),r.createElement("div",{className:"mx_RoomDirectory_list"},r.createElement("input",{ref:"roomAlias",placeholder:"Join a room (e.g. #foo:domain.com)",className:"mx_RoomDirectory_input",size:"64",onKeyUp:this.onKeyUp}),r.createElement("div",{className:"mx_RoomDirectory_tableWrapper"},r.createElement("table",{className:"mx_RoomDirectory_table"},r.createElement("tr",null,r.createElement("th",{width:"45%"},"Room"),r.createElement("th",{width:"45%"},"Alias"),r.createElement("th",{width:"10%"},"Members")),this.getRows(this.state.roomAlias)))))}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(5),s=n(125);e.exports=r.createClass({displayName:"RoomList",mixins:[s],onShowClick:function(){i.dispatch({action:"show_left_panel"})},render:function(){var e,t=o.getComponent("molecules.voip.CallView"),n=o.getComponent("molecules.RoomDropTarget");this.state.show_call_element&&(e=r.createElement(t,{className:"mx_MatrixChat_callView"}));var i=this.props.collapsed?r.createElement("img",{style:{cursor:"pointer"},onClick:this.onShowClick,src:"img/menu.png",width:"27",height:"20",alt:">"}):"Recents";return r.createElement("div",{className:"mx_RoomList",onScroll:this._repositionTooltip},e,r.createElement("h2",{className:"mx_RoomList_favourites_label"},"Favourites"),r.createElement(n,{text:"Drop here to favourite"}),r.createElement("h2",{className:"mx_RoomList_recents_label"},i),r.createElement("div",{className:"mx_RoomList_recents"},this.makeRoomTiles()),r.createElement("h2",{className:"mx_RoomList_archive_label"},"Archive"),r.createElement(n,{text:"Drop here to archive"}))}})},function(e,t,n){"use strict";var r=n(1),o=n(2),i=n(5),s=n(3),a=n(33),l=n(53),c=n(126),u=n(10);e.exports=r.createClass({displayName:"RoomView",mixins:[c],onSettingsClick:function(){this.setState({editingRoomSettings:!0})},onSaveClick:function(){this.setState({editingRoomSettings:!1,uploadingRoomSettings:!0});var e=this.refs.header.getRoomName(),t=this.refs.room_settings.getTopic(),n=this.refs.room_settings.getJoinRules(),r=this.refs.room_settings.getHistoryVisibility(),o=this.refs.room_settings.getPowerLevels();this.uploadNewState(e,t,n,r,o)},onCancelClick:function(){this.setState(this.getInitialState())},onConferenceNotificationClick:function(){i.dispatch({action:"place_call",type:"video",room_id:this.props.roomId})},getUnreadMessagesString:function(){return this.state.numUnreadMessages?this.state.numUnreadMessages+" new message"+(this.state.numUnreadMessages>1?"s":""):""},scrollToBottom:function(){if(this.refs.messageWrapper){var e=this.refs.messageWrapper.getDOMNode();e.scrollTop=e.scrollHeight}},render:function(){var e=s.getComponent("molecules.RoomHeader"),t=s.getComponent("molecules.MessageComposer"),n=s.getComponent("molecules.voip.CallView"),i=s.getComponent("molecules.RoomSettings");if(!this.state.room)return this.props.roomId?r.createElement("div",null,r.createElement("button",{onClick:this.onJoinButtonClicked},"Join Room")):r.createElement("div",null);var c=o.get().credentials.userId;if("invite"==this.state.room.currentState.members[c].membership){if(this.state.joining)return r.createElement("div",{className:"mx_RoomView"},r.createElement(u,null));var p=this.state.room.currentState.members[c].events.member.event,d=this.state.joinError?"Failed to join room!":"";return r.createElement("div",{className:"mx_RoomView"},r.createElement(e,{ref:"header",room:this.state.room,simpleHeader:"Room invite"}),r.createElement("div",{className:"mx_RoomView_invitePrompt"},r.createElement("div",null,p.user_id," has invited you to a room"),r.createElement("br",null),r.createElement("button",{ref:"joinButton",onClick:this.onJoinButtonClicked},"Join"),r.createElement("div",{className:"error"},d)))}var h=a({mx_RoomView_scrollheader:!0,loading:this.state.paginating}),m=r.createElement("div",null);if(this.state.upload){var f={width:this.state.upload.uploadedBytes/this.state.upload.totalBytes*100+"%"},g=l(this.state.upload.uploadedBytes),v=l(this.state.upload.totalBytes);g.replace(/^.* /,"")===v.replace(/^.* /,"")&&(g=g.replace(/ .*/,"")),m=r.createElement("div",{className:"mx_RoomView_uploadBar"},r.createElement("div",{className:"mx_RoomView_uploadProgressOuter"},r.createElement("div",{className:"mx_RoomView_uploadProgressInner",style:f})),r.createElement("img",{className:"mx_RoomView_uploadIcon",src:"img/fileicon.png",width:"40",height:"40"}),r.createElement("img",{className:"mx_RoomView_uploadCancel",src:"img/cancel.png",width:"40",height:"40"}),r.createElement("div",{className:"mx_RoomView_uploadBytes"},g," / ",v),r.createElement("div",{className:"mx_RoomView_uploadFilename"},"Uploading ",this.state.upload.fileName))}else{var y=this.getWhoIsTypingString(),_=this.getUnreadMessagesString();_?m=r.createElement("div",{className:"mx_RoomView_unreadMessagesBar",onClick:this.scrollToBottom},r.createElement("img",{src:"img/newmessages.png",width:"10",height:"12",alt:""}),_):y&&(m=r.createElement("div",{className:"mx_RoomView_typingBar"},r.createElement("img",{src:"img/typing.png",width:"40",height:"40",alt:""}),y))}var E=null;this.state.editingRoomSettings&&(E=r.createElement(i,{ref:"room_settings",onSaveClick:this.onSaveClick,room:this.state.room})),this.state.uploadingRoomSettings&&(E=r.createElement(u,null));var b=null;this.state.displayConfCallNotification&&(b=r.createElement("div",{className:"mx_RoomView_ongoingConfCallNotification",onClick:this.onConferenceNotificationClick},"Ongoing conference call"));var C=null;return this.state.draggingFile&&(C=r.createElement("div",{className:"mx_RoomView_fileDropTarget"},r.createElement("div",{className:"mx_RoomView_fileDropTargetLabel"},r.createElement("img",{src:"img/upload-big.png",width:"46",height:"61",alt:"Drop File Here"}),r.createElement("br",null),"Drop File Here"))),r.createElement("div",{className:"mx_RoomView"},r.createElement(e,{ref:"header",room:this.state.room,editing:this.state.editingRoomSettings,onSettingsClick:this.onSettingsClick,onSaveClick:this.onSaveClick,onCancelClick:this.onCancelClick}),r.createElement("div",{className:"mx_RoomView_auxPanel"},r.createElement(n,{room:this.state.room}),b,E),r.createElement("div",{ref:"messageWrapper",className:"mx_RoomView_messagePanel",onScroll:this.onMessageListScroll},r.createElement("div",{className:"mx_RoomView_messageListWrapper"},C,r.createElement("ol",{className:"mx_RoomView_MessageList","aria-live":"polite"},r.createElement("li",{className:h}),this.getEventTiles()))),r.createElement("div",{className:"mx_RoomView_statusArea"},r.createElement("div",{className:"mx_RoomView_statusAreaBox"},m)),r.createElement(t,{room:this.state.room,uploadFile:this.uploadFile}))}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(2),s=n(246),a=n(10),l=n(14);e.exports=r.createClass({displayName:"UserSettings",mixins:[s],editAvatar:function(){var e=i.get().mxcUrlToHttp(this.state.avatarUrl),t=o.getComponent("molecules.ChangeAvatar"),n=r.createElement("div",null,r.createElement(t,{initialAvatarUrl:e}),r.createElement("div",{className:"mx_Dialog_buttons"},r.createElement("button",{onClick:this.onAvatarDialogCancel},"Cancel")));this.avatarDialog=l.createDialogWithElement(n)},addEmail:function(){},editDisplayName:function(){this.refs.displayname.edit()},changePassword:function(){var e=o.getComponent("molecules.ChangePassword");l.createDialog(e)},onLogoutClicked:function(e){var t=o.getComponent("organisms.LogoutPrompt");this.logoutModal=l.createDialog(t,{onCancel:this.onLogoutPromptCancel})},onLogoutPromptCancel:function(){this.logoutModal.closeDialog()},onAvatarDialogCancel:function(){this.avatarDialog.close()},render:function(){switch(this.state.phase){case this.Phases.Loading:return r.createElement(a,null);case this.Phases.Display:var e=o.getComponent("molecules.ChangeDisplayName"),t=o.getComponent("atoms.EnableNotificationsButton");return r.createElement("div",{className:"mx_UserSettings"},r.createElement("div",{className:"mx_UserSettings_User"},r.createElement("h1",null,"User Settings"),r.createElement("hr",null),r.createElement("div",{className:"mx_UserSettings_User_Inner"},r.createElement("div",{className:"mx_UserSettings_Avatar"},r.createElement("div",{className:"mx_UserSettings_Avatar_Text"},"Profile Photo"),r.createElement("div",{className:"mx_UserSettings_Avatar_Edit",onClick:this.editAvatar},"Edit")),r.createElement("div",{className:"mx_UserSettings_DisplayName"},r.createElement(e,{ref:"displayname"}),r.createElement("div",{className:"mx_UserSettings_DisplayName_Edit",onClick:this.editDisplayName},"Edit")),r.createElement("div",{className:"mx_UserSettings_3pids"},this.state.threepids.map(function(e){return r.createElement("div",{key:e.address},e.address)})),r.createElement("div",{className:"mx_UserSettings_Add3pid",onClick:this.addEmail},"Add email"))),r.createElement("div",{className:"mx_UserSettings_Global"},r.createElement("h1",null,"Global Settings"),r.createElement("hr",null),r.createElement("div",{className:"mx_UserSettings_Global_Inner"},r.createElement("div",{className:"mx_UserSettings_ChangePassword",onClick:this.changePassword},"Change Password"),r.createElement("div",{className:"mx_UserSettings_ClientVersion"},"Version ",this.state.clientVersion),r.createElement("div",{className:"mx_UserSettings_EnableNotifications"},r.createElement(t,null)),r.createElement("div",{className:"mx_UserSettings_Logout"},r.createElement("button",{onClick:this.onLogoutClicked},"Sign Out")))))}}})},function(e,t,n){"use strict";var r=n(1);e.exports=r.createClass({displayName:"ViewSource",render:function(){return r.createElement("div",{className:"mx_ViewSource"},r.createElement("pre",null,JSON.stringify(this.props.mxEvent.event,null,2)))}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(247),s=n(10),a=n(5),l=n(41),c=n(52);e.exports=r.createClass({displayName:"MatrixChat",mixins:[i],getInitialState:function(){return{width:1e4}},componentDidMount:function(){window.addEventListener("resize",this.handleResize),this.handleResize()},componentWillUnmount:function(){window.removeEventListener("resize",this.handleResize)},onAliasClick:function(e,t){e.preventDefault(),a.dispatch({action:"view_room_alias",room_alias:t})},onUserClick:function(e,t){e.preventDefault();var n=o.getComponent("molecules.MemberInfo"),r=new l.RoomMember(null,t);c.createMenu(n,{member:r,right:window.innerWidth-e.pageX,top:e.pageY})},handleResize:function(e){var t=1e3,n=1e3,r=820,o=820;this.state.width>t&&window.innerWidth<=t&&a.dispatch({action:"hide_left_panel"}),this.state.width<=n&&window.innerWidth>n&&a.dispatch({action:"show_left_panel"}),this.state.width>r&&window.innerWidth<=r&&a.dispatch({action:"hide_right_panel"}),this.state.width<=o&&window.innerWidth>o&&a.dispatch({action:"show_right_panel"}),this.setState({width:window.innerWidth})},onRoomCreated:function(e){a.dispatch({action:"view_room",room_id:e})},render:function(){var e=o.getComponent("organisms.LeftPanel"),t=o.getComponent("organisms.RoomView"),n=o.getComponent("organisms.RightPanel"),i=o.getComponent("templates.Login"),a=o.getComponent("organisms.UserSettings"),l=o.getComponent("templates.Register"),c=o.getComponent("organisms.CreateRoom"),u=o.getComponent("organisms.RoomDirectory"),p=o.getComponent("molecules.MatrixToolbar"),d=o.getComponent("organisms.Notifier");if(this.state.logged_in&&this.state.ready){var h,m="";switch(this.state.page_type){case this.PageTypes.RoomView:h=r.createElement(t,{roomId:this.state.currentRoom,key:this.state.currentRoom}),m=r.createElement(n,{roomId:this.state.currentRoom,collapsed:this.state.collapse_rhs});break;case this.PageTypes.UserSettings:h=r.createElement(a,null),m=r.createElement(n,{collapsed:this.state.collapse_rhs});break;case this.PageTypes.CreateRoom:h=r.createElement(c,{onRoomCreated:this.onRoomCreated}),m=r.createElement(n,{collapsed:this.state.collapse_rhs});break;case this.PageTypes.RoomDirectory:h=r.createElement(u,null),m=r.createElement(n,{
collapsed:this.state.collapse_rhs})}return!d.supportsDesktopNotifications()||d.isEnabled()||d.isToolbarHidden()?r.createElement("div",{className:"mx_MatrixChat"},r.createElement(e,{selectedRoom:this.state.currentRoom,collapsed:this.state.collapse_lhs}),r.createElement("main",{className:"mx_MatrixChat_middlePanel"},h),m):r.createElement("div",{className:"mx_MatrixChat_wrapper"},r.createElement(p,null),r.createElement("div",{className:"mx_MatrixChat mx_MatrixChat_toolbarShowing"},r.createElement(e,{selectedRoom:this.state.currentRoom,collapsed:this.state.collapse_lhs}),r.createElement("main",{className:"mx_MatrixChat_middlePanel"},h),m))}return this.state.logged_in?r.createElement(s,null):"register"==this.state.screen?r.createElement(l,{onLoggedIn:this.onLoggedIn,clientSecret:this.state.register_client_secret,sessionId:this.state.register_session_id,idSid:this.state.register_id_sid,hsUrl:this.state.register_hs_url,isUrl:this.state.register_is_url,registrationUrl:this.props.registrationUrl}):r.createElement(i,{onLoggedIn:this.onLoggedIn})}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(2),s=n(10),a=n(248),l=n(84);e.exports=r.createClass({displayName:"Login",mixins:[a],getInitialState:function(){return{serverConfigVisible:!1}},componentWillMount:function(){this.onHSChosen(),this.customHsUrl=l.default_hs_url,this.customIsUrl=l.default_is_url},getHsUrl:function(){return this.state.serverConfigVisible?this.customHsUrl:l.default_hs_url},getIsUrl:function(){return this.state.serverConfigVisible?this.customIsUrl:l.default_is_url},onServerConfigVisibleChange:function(e){this.setState({serverConfigVisible:e.target.checked},this.onHsUrlChanged)},getFormVals:function(){return{username:this.refs.user.getDOMNode().value.trim(),password:this.refs.pass.getDOMNode().value.trim()}},onHsUrlChanged:function(){var e=this.refs.serverConfig.getHsUrl().trim(),t=this.refs.serverConfig.getIsUrl().trim();if(e!=this.customHsUrl||t!=this.customIsUrl){this.customHsUrl=e,this.customIsUrl=t,i.replaceUsingUrls(this.getHsUrl(),this.getIsUrl()),this.setState({hs_url:this.getHsUrl(),is_url:this.getIsUrl()}),this.updateHsTimeout&&clearTimeout(this.updateHsTimeout);var n=this;this.updateHsTimeout=setTimeout(function(){n.onHSChosen()},1e3)}},componentForStep:function(e){switch(e){case"choose_hs":case"fetch_stages":var t={};t.display=this.state.serverConfigVisible?"block":"none";var n=o.getComponent("molecules.ServerConfig");return r.createElement("div",null,r.createElement("input",{className:"mx_Login_checkbox",id:"advanced",type:"checkbox",checked:this.state.serverConfigVisible,onChange:this.onServerConfigVisibleChange}),r.createElement("label",{className:"mx_Login_label",htmlFor:"advanced"},"Use custom server options (advanced)"),r.createElement("div",{style:t},r.createElement(n,{ref:"serverConfig",defaultHsUrl:this.customHsUrl,defaultIsUrl:this.customIsUrl,onHsUrlChanged:this.onHsUrlChanged})));case"stage_m.login.password":return r.createElement("div",null,r.createElement("form",{onSubmit:this.onUserPassEntered},r.createElement("input",{className:"mx_Login_field",ref:"user",type:"text",value:this.state.username,onChange:this.onUsernameChanged,placeholder:"Email or user name"}),r.createElement("br",null),r.createElement("input",{className:"mx_Login_field",ref:"pass",type:"password",value:this.state.password,onChange:this.onPasswordChanged,placeholder:"Password"}),r.createElement("br",null),this.componentForStep("choose_hs"),r.createElement("input",{className:"mx_Login_submit",type:"submit",value:"Log in"})));case"stage_m.login.cas":var i=o.getComponent("organisms.CasLogin");return r.createElement(i,null)}},onUsernameChanged:function(e){this.setState({username:e.target.value})},onPasswordChanged:function(e){this.setState({password:e.target.value})},loginContent:function(){var e=this.state.busy?r.createElement("div",{className:"mx_Login_loader"},r.createElement(s,null)):null;return r.createElement("div",null,r.createElement("h2",null,"Sign in"),this.componentForStep(this.state.step),r.createElement("div",{className:"mx_Login_error"},e,this.state.errorText),r.createElement("a",{className:"mx_Login_create",onClick:this.showRegister,href:"#"},"Create a new account"),r.createElement("br",null),r.createElement("div",{className:"mx_Login_links"},r.createElement("a",{href:"https://medium.com/@Vector"},"blog"),"  ·  ",r.createElement("a",{href:"https://twitter.com/@VectorCo"},"twitter"),"  ·  ",r.createElement("a",{href:"https://github.com/vector-im/vector-web"},"github"),"  ·  ",r.createElement("a",{href:"https://matrix.org"},"powered by Matrix")))},render:function(){return r.createElement("div",{className:"mx_Login"},r.createElement("div",{className:"mx_Login_box"},r.createElement("div",{className:"mx_Login_logo"},r.createElement("img",{src:"img/logo.png",width:"249",height:"78",alt:"vector"})),this.loginContent()))}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=n(2),s=n(10),a=n(127),l=n(84);e.exports=r.createClass({displayName:"Register",mixins:[a],getInitialState:function(){return{serverConfigVisible:!1}},componentWillMount:function(){this.customHsUrl=l.default_hs_url,this.customIsUrl=l.default_is_url},getRegFormVals:function(){return{email:this.refs.email.getDOMNode().value.trim(),username:this.refs.username.getDOMNode().value.trim(),password:this.refs.password.getDOMNode().value.trim(),confirmPassword:this.refs.confirmPassword.getDOMNode().value.trim()}},getHsUrl:function(){return this.state.serverConfigVisible?this.customHsUrl:l.default_hs_url},getIsUrl:function(){return this.state.serverConfigVisible?this.customIsUrl:l.default_is_url},onServerConfigVisibleChange:function(e){this.setState({serverConfigVisible:e.target.checked})},onServerUrlChanged:function(e){this.customHsUrl=this.refs.serverConfig.getHsUrl(),this.customIsUrl=this.refs.serverConfig.getIsUrl(),this.forceUpdate()},onProfileContinueClicked:function(){this.onAccountReady()},componentForStep:function(e){switch(e){case"initial":var t={};t.display=this.state.serverConfigVisible?"block":"none";var n=o.getComponent("molecules.ServerConfig");return r.createElement("div",null,r.createElement("form",{onSubmit:this.onInitialStageSubmit},r.createElement("input",{className:"mx_Login_field",type:"text",ref:"email",placeholder:"Email address",defaultValue:this.savedParams.email}),r.createElement("br",null),r.createElement("input",{className:"mx_Login_field",type:"text",ref:"username",placeholder:"User name",defaultValue:this.savedParams.username}),r.createElement("br",null),r.createElement("input",{className:"mx_Login_field",type:"password",ref:"password",placeholder:"Password",defaultValue:this.savedParams.password}),r.createElement("br",null),r.createElement("input",{className:"mx_Login_field",type:"password",ref:"confirmPassword",placeholder:"Confirm password",defaultValue:this.savedParams.confirmPassword}),r.createElement("br",null),r.createElement("input",{className:"mx_Login_checkbox",id:"advanced",type:"checkbox",value:this.state.serverConfigVisible,onChange:this.onServerConfigVisibleChange}),r.createElement("label",{htmlFor:"advanced"},"Use custom server options (advanced)"),r.createElement("div",{style:t},r.createElement(n,{ref:"serverConfig",defaultHsUrl:this.customHsUrl,defaultIsUrl:this.customIsUrl,onHsUrlChanged:this.onServerUrlChanged,onIsUrlChanged:this.onServerUrlChanged})),r.createElement("br",null),r.createElement("input",{className:"mx_Login_submit",type:"submit",value:"Register"})));case"stage_m.login.email.identity":return r.createElement("div",null,"Please check your email to continue registration.");case"stage_m.login.recaptcha":return r.createElement("div",{ref:"recaptchaContainer"},"This Home Server would like to make sure you are not a robot",r.createElement("div",{id:"mx_recaptcha"}))}},registerContent:function(){if(this.state.busy)return r.createElement(s,null);if("profile"==this.state.step){var e=o.getComponent("molecules.ChangeDisplayName"),t=o.getComponent("molecules.ChangeAvatar");return r.createElement("div",{className:"mx_Login_profile"},"Set a display name:",r.createElement(e,null),"Upload an avatar:",r.createElement(t,{initialAvatarUrl:i.get().mxcUrlToHttp(this.state.avatarUrl)}),r.createElement("button",{onClick:this.onProfileContinueClicked},"Continue"))}return r.createElement("div",null,r.createElement("h2",null,"Create an account"),this.componentForStep(this.state.step),r.createElement("div",{className:"mx_Login_error"},this.state.errorText),r.createElement("a",{className:"mx_Login_create",onClick:this.showLogin,href:"#"},"I already have an account"))},onBadFields:function(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)switch(e[t[r]]){case this.FieldErrors.PasswordMismatch:n.push("Passwords don't match");break;case this.FieldErrors.Missing:n.push("Missing "+t[r]);break;case this.FieldErrors.TooShort:n.push(t[r]+" is too short");break;case this.FieldErrors.InUse:n.push(t[r]+" is already taken");break;case this.FieldErrors.Length:n.push(t[r]+" is not long enough.");break;default:console.error("Unhandled FieldError: %s",e[t[r]])}var o=n.join(", ");this.setState({errorText:o})},render:function(){return r.createElement("div",{className:"mx_Login"},r.createElement("div",{className:"mx_Login_box"},r.createElement("div",{className:"mx_Login_logo"},r.createElement("img",{src:"img/logo.png",width:"249",height:"78",alt:"vector"})),this.registerContent()))}})},function(e,t,n){e.exports.Dispatcher=n(193)},function(e,t,n){"use strict";function r(){this.$Dispatcher_callbacks={},this.$Dispatcher_isPending={},this.$Dispatcher_isHandled={},this.$Dispatcher_isDispatching=!1,this.$Dispatcher_pendingPayload=null}var o=n(194),i=1,s="ID_";r.prototype.register=function(e){var t=s+i++;return this.$Dispatcher_callbacks[t]=e,t},r.prototype.unregister=function(e){o(this.$Dispatcher_callbacks[e],"Dispatcher.unregister(...): `%s` does not map to a registered callback.",e),delete this.$Dispatcher_callbacks[e]},r.prototype.waitFor=function(e){o(this.$Dispatcher_isDispatching,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var t=0;t<e.length;t++){var n=e[t];this.$Dispatcher_isPending[n]?o(this.$Dispatcher_isHandled[n],"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",n):(o(this.$Dispatcher_callbacks[n],"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",n),this.$Dispatcher_invokeCallback(n))}},r.prototype.dispatch=function(e){o(!this.$Dispatcher_isDispatching,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this.$Dispatcher_startDispatching(e);try{for(var t in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[t]||this.$Dispatcher_invokeCallback(t)}finally{this.$Dispatcher_stopDispatching()}},r.prototype.isDispatching=function(){return this.$Dispatcher_isDispatching},r.prototype.$Dispatcher_invokeCallback=function(e){this.$Dispatcher_isPending[e]=!0,this.$Dispatcher_callbacks[e](this.$Dispatcher_pendingPayload),this.$Dispatcher_isHandled[e]=!0},r.prototype.$Dispatcher_startDispatching=function(e){for(var t in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[t]=!1,this.$Dispatcher_isHandled[t]=!1;this.$Dispatcher_pendingPayload=e,this.$Dispatcher_isDispatching=!0},r.prototype.$Dispatcher_stopDispatching=function(){this.$Dispatcher_pendingPayload=null,this.$Dispatcher_isDispatching=!1},e.exports=r},function(e,t){"use strict";var n=function(e,t,n,r,o,i,s,a){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,o,i,s,a],u=0;l=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return c[u++]}))}throw l.framesToPop=1,l}};e.exports=n},function(e,t,n){(function(r){"use strict";function o(e,t,n){var r=n[n.length-1];e.replaceChild(r,t);for(var o=n.length-2;o>=0;o--)e.insertBefore(n[o],r),r=n[o]}function i(e,t,n){for(var r=[],o=0;o<e.length;o++){var i=e[o];if(i.isLink){var s=i.toHref(t.defaultProtocol),a=l.options.resolve(t.format,i.toString(),i.type),c=l.options.resolve(t.formatHref,s,i.type),u=l.options.resolve(t.attributes,s,i.type),p=l.options.resolve(t.tagName,s,i.type),d=l.options.resolve(t.linkClass,s,i.type),h=l.options.resolve(t.target,s,i.type),m=l.options.resolve(t.events,s,i.type),f=n.createElement(p);if(f.setAttribute("href",c),f.setAttribute("class",d),h&&f.setAttribute("target",h),u)for(var g in u)f.setAttribute(g,u[g]);if(m)for(var v in m)f.addEventListener?f.addEventListener(v,m[v]):f.attachEvent&&f.attachEvent("on"+v,m[v]);f.appendChild(n.createTextNode(a)),r.push(f)}else"nl"===i.type&&t.nl2br?r.push(n.createElement("br")):r.push(n.createTextNode(i.toString()))}return r}function s(e,t,n){if(!e||"object"!=typeof e||e.nodeType!==c)throw new Error("Cannot linkify "+e+" - Invalid DOM Node type");if("A"===e.tagName)return e;for(var r=e.firstChild;r;){switch(r.nodeType){case c:s(r,t,n);break;case u:var a=r.nodeValue,p=l.tokenize(a),d=i(p,t,n);o(e,r,d),r=d[d.length-1]}r=r.nextSibling}return e}function a(e,t){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];try{n=n||window&&window.document||r&&r.document}catch(o){}if(!n)throw new Error("Cannot find document implementation. If you are in a non-browser environment like Node.js, pass the document implementation as the third argument to linkifyElement.");return t=l.options.normalize(t),s(e,t,n)}t.__esModule=!0;var l=n(86),c=1,u=3;a.helper=s,a.normalize=l.options.normalize,t["default"]=a,e.exports=t["default"]}).call(t,function(){return this}())},function(e,t,n){"use strict";t.__esModule=!0;var r=n(88),o=n(87),i=function(e){return new o.TokenState(e)},s=r.text.DOMAIN,a=r.text.AT,l=r.text.COLON,c=r.text.DOT,u=r.text.PUNCTUATION,p=r.text.LOCALHOST,d=r.text.NL,h=r.text.NUM,m=r.text.PLUS,f=r.text.POUND,g=r.text.PROTOCOL,v=r.text.QUERY,y=r.text.SLASH,_=r.text.SYM,E=r.text.TLD,b=r.multi.EMAIL,C=r.multi.NL,x=r.multi.TEXT,w=r.multi.URL,S=i(),T=i(),R=i(),I=i(),k=i(),M=i(),N=i(w),D=i(),A=i(w),P=i(),U=i(),O=i(w),L=i(),F=i(w),B=i(w),V=i(),j=i(),H=i(),W=i(b),q=i(),K=i(b),z=i(),$=i(),Y=i(),G=i(C);S.on(d,G),S.on(g,T),S.on(y,R),T.on(y,R),R.on(y,I),S.on(E,k),S.on(s,k),S.on(p,N),S.on(h,k),I.on(E,P),I.on(s,P),I.on(h,P),I.on(p,O),k.on(c,M),P.on(c,U),j.on(c,H),M.on(E,N),M.on(s,k),M.on(h,k),M.on(p,k),U.on(E,O),U.on(s,P),U.on(h,P),U.on(p,P),H.on(E,W),H.on(s,j),H.on(h,j),H.on(p,j),N.on(c,M),O.on(c,U),W.on(c,H),N.on(l,D),N.on(y,B),D.on(h,A),A.on(y,B),O.on(l,L),O.on(y,B),L.on(h,F),F.on(y,B),W.on(l,q),q.on(h,K);var Q=[s,a,p,h,m,f,g,y,E,_],J=[l,c,v,u];B.on(Q,B),V.on(Q,B),B.on(J,V),V.on(J,V);var X=[s,h,m,f,v,_,E];k.on(X,z),k.on(a,$),M.on(X,z),N.on(X,z),N.on(a,$),z.on(X,z),z.on(a,$),z.on(c,Y),Y.on(X,z),$.on(E,j),$.on(s,j),$.on(p,W);var Z=function(e){for(var t=e.length,n=0,r=[],o=[];t>n;){for(var i=S,s=null,a=null,l=0,c=null,u=-1;t>n&&!(s=i.next(e[n]));)o.push(e[n++]);for(;t>n&&(a=s||i.next(e[n]));)s=null,i=a,i.accepts()?(u=0,c=i):u>=0&&u++,n++,l++;if(0>u)for(var p=n-l;n>p;p++)o.push(e[p]);else{o.length>0&&(r.push(new x(o)),o=[]),n-=u,l-=u;var d=c.emit();r.push(new d(e.slice(n-l,n)))}}return o.length>0&&r.push(new x(o)),r},ee=r.multi,te=S;t.State=o.TokenState,t.TOKENS=ee,t.run=Z,t.start=te},function(e,t,n){"use strict";t.__esModule=!0;var r=n(88),o=n(87),i="abogado|ac|academy|accountants|active|actor|ad|adult|ae|aero|af|ag|agency|ai|airforce|al|allfinanz|alsace|am|an|android|ao|aq|aquarelle|ar|archi|army|arpa|as|asia|associates|at|attorney|au|auction|audio|autos|aw|ax|axa|az|ba|band|bar|bargains|bayern|bb|bd|be|beer|berlin|best|bf|bg|bh|bi|bid|bike|bio|biz|bj|black|blackfriday|bloomberg|blue|bm|bmw|bn|bnpparibas|bo|boo|boutique|br|brussels|bs|bt|budapest|build|builders|business|buzz|bv|bw|by|bz|bzh|ca|cab|cal|camera|camp|cancerresearch|capetown|capital|caravan|cards|care|career|careers|casa|cash|cat|catering|cc|cd|center|ceo|cern|cf|cg|ch|channel|cheap|christmas|chrome|church|ci|citic|city|ck|cl|claims|cleaning|click|clinic|clothing|club|cm|cn|co|coach|codes|coffee|college|cologne|com|community|company|computer|condos|construction|consulting|contractors|cooking|cool|coop|country|cr|credit|creditcard|cricket|crs|cruises|cu|cuisinella|cv|cw|cx|cy|cymru|cz|dad|dance|dating|day|de|deals|degree|delivery|democrat|dental|dentist|desi|diamonds|diet|digital|direct|directory|discount|dj|dk|dm|dnp|do|domains|durban|dvag|dz|eat|ec|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|equipment|er|es|esq|estate|et|eu|eurovision|eus|events|everbank|exchange|expert|exposed|fail|farm|fashion|feedback|fi|finance|financial|firmdale|fish|fishing|fitness|fj|fk|flights|florist|flsmidth|fly|fm|fo|foo|forsale|foundation|fr|frl|frogans|fund|furniture|futbol|ga|gal|gallery|gb|gbiz|gd|ge|gent|gf|gg|gh|gi|gift|gifts|gives|gl|glass|gle|global|globo|gm|gmail|gmo|gmx|gn|google|gop|gov|gp|gq|gr|graphics|gratis|green|gripe|gs|gt|gu|guide|guitars|guru|gw|gy|hamburg|haus|healthcare|help|here|hiphop|hiv|hk|hm|hn|holdings|holiday|homes|horse|host|hosting|house|how|hr|ht|hu|ibm|id|ie|il|im|immo|immobilien|in|industries|info|ing|ink|institute|insure|int|international|investments|io|iq|ir|irish|is|it|je|jetzt|jm|jo|jobs|joburg|jp|juegos|kaufen|ke|kg|kh|ki|kim|kitchen|kiwi|km|kn|koeln|kp|kr|krd|kred|kw|ky|kz|la|lacaixa|land|latrobe|lawyer|lb|lc|lds|lease|legal|lgbt|li|life|lighting|limited|limo|link|lk|loans|london|lotto|lr|ls|lt|ltda|lu|luxe|luxury|lv|ly|ma|madrid|maison|management|mango|market|marketing|mc|md|me|media|meet|melbourne|meme|memorial|menu|mg|mh|miami|mil|mini|mk|ml|mm|mn|mo|mobi|moda|moe|monash|money|mormon|mortgage|moscow|motorcycles|mov|mp|mq|mr|ms|mt|mu|museum|mv|mw|mx|my|mz|na|nagoya|name|navy|nc|ne|net|network|neustar|new|nexus|nf|ng|ngo|nhk|ni|ninja|nl|no|np|nr|nra|nrw|nu|nyc|nz|okinawa|om|ong|onl|ooo|org|organic|otsuka|ovh|pa|paris|partners|parts|party|pe|pf|pg|ph|pharmacy|photo|photography|photos|physio|pics|pictures|pink|pizza|pk|pl|place|plumbing|pm|pn|pohl|poker|porn|post|pr|praxi|press|pro|prod|productions|prof|properties|property|ps|pt|pub|pw|py|qa|qpon|quebec|re|realtor|recipes|red|rehab|reise|reisen|reit|ren|rentals|repair|report|republican|rest|restaurant|reviews|rich|rio|rip|ro|rocks|rodeo|rs|rsvp|ru|ruhr|rw|ryukyu|sa|saarland|sarl|sb|sc|sca|scb|schmidt|schule|science|scot|sd|se|services|sexy|sg|sh|shiksha|shoes|si|singles|sj|sk|sl|sm|sn|so|social|software|sohu|solar|solutions|soy|space|spiegel|sr|st|su|supplies|supply|support|surf|surgery|suzuki|sv|sx|sy|sydney|systems|sz|taipei|tatar|tattoo|tax|tc|td|technology|tel|tf|tg|th|tienda|tips|tirol|tj|tk|tl|tm|tn|to|today|tokyo|tools|top|town|toys|tp|tr|trade|training|travel|trust|tt|tui|tv|tw|tz|ua|ug|uk|university|uno|uol|us|uy|uz|va|vacations|vc|ve|vegas|ventures|versicherung|vet|vg|vi|viajes|villas|vision|vlaanderen|vn|vodka|vote|voting|voto|voyage|vu|wales|wang|watch|webcam|website|wed|wedding|wf|whoswho|wien|wiki|williamhill|wme|work|works|world|ws|wtc|wtf|xxx|xyz|yachts|yandex|ye|yoga|yokohama|youtube|yt|za|zip|zm|zone|zw".split("|"),s=/[0-9]/,a=/[a-z0-9]/,l=":",c=[],u=function(e){return new o.CharacterState(e)},p=r.text.DOMAIN,d=r.text.LOCALHOST,h=r.text.NUM,m=r.text.PROTOCOL,f=r.text.TLD,g=r.text.WS,v=u(),y=u(h),_=u(p),E=u(),b=u(g);v.on("@",u(r.text.AT)),v.on(".",u(r.text.DOT)),v.on("+",u(r.text.PLUS)),v.on("#",u(r.text.POUND)),v.on("?",u(r.text.QUERY)),v.on("/",u(r.text.SLASH)),v.on(l,u(r.text.COLON)),v.on(/[,;!]/,u(r.text.PUNCTUATION)),v.on(/\n/,u(r.text.NL)),v.on(/\s/,b),b.on(/[^\S\n]/,b);for(var C=0;C<i.length;C++){var x=o.stateify(i[C],v,f,p);c.push.apply(c,x)}var w=o.stateify("file",v,p,p),S=o.stateify("ftp",v,p,p),T=o.stateify("http",v,p,p);c.push.apply(c,w),c.push.apply(c,S),c.push.apply(c,T);var R=w.pop(),I=S.pop(),k=T.pop(),M=u(p),N=u(m);I.on("s",M),k.on("s",M),c.push(M),R.on(l,N),I.on(l,N),k.on(l,N),M.on(l,N);var D=o.stateify("localhost",v,d,p);c.push.apply(c,D),v.on(s,y),y.on("-",E),y.on(s,y),y.on(a,_),_.on("-",E),_.on(a,_);for(var C=0;C<c.length;C++)c[C].on("-",E),c[C].on(a,_);E.on("-",E),E.on(s,_),E.on(a,_),v.on(/./,u(r.text.SYM));var A=function(e){for(var t=e.replace(/[A-Z]/g,function(e){return e.toLowerCase()}),n=e.length,r=[],o=0;n>o;){for(var i=v,s=null,a=null,l=0,c=null,u=-1;n>o&&(a=i.next(t[o]));)s=null,i=a,i.accepts()?(u=0,c=i):u>=0&&u++,l++,o++;if(!(0>u)){o-=u,l-=u;var p=c.emit();r.push(new p(e.substr(o-l,l)))}}return r},P=v;t.State=o.CharacterState,t.TOKENS=r.text,t.run=A,t.start=P},function(e,t){"use strict";function n(e){return e}function r(e,t){return"url"===t?"_blank":null}function o(e){e=e||{};var t=e.newLine||!1;return{attributes:e.linkAttributes||null,defaultProtocol:e.defaultProtocol||"http",events:e.events||null,format:e.format||n,formatHref:e.formatHref||n,newLine:e.newLine||!1,nl2br:!!t||e.nl2br||!1,tagName:e.tagName||"a",target:e.target||r,linkClass:e.linkClass||"linkified"}}function i(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return"function"==typeof e?e.apply(void 0,n):e}t.__esModule=!0,t.normalize=o,t.resolve=i},function(e,t,n){"use strict";e.exports.MatrixEvent=n(26).MatrixEvent,e.exports.EventStatus=n(26).EventStatus,e.exports.MatrixInMemoryStore=n(203).MatrixInMemoryStore,e.exports.WebStorageStore=n(206),e.exports.MatrixHttpApi=n(56).MatrixHttpApi,e.exports.MatrixError=n(56).MatrixError,e.exports.MatrixClient=n(89).MatrixClient,e.exports.Room=n(57),e.exports.RoomMember=n(90),e.exports.RoomState=n(91),e.exports.User=n(58),e.exports.MatrixScheduler=n(202),e.exports.WebStorageSessionStore=n(204),e.exports.CRYPTO_ENABLED=n(89).CRYPTO_ENABLED,e.exports.ContentRepo=n(42),e.exports.createNewMatrixCall=n(92).createNewMatrixCall;var r;e.exports.request=function(e){r=e},e.exports.createClient=function(t){return"string"==typeof t&&(t={baseUrl:t}),t.request=t.request||r,t.store=t.store||new e.exports.MatrixInMemoryStore,t.scheduler=t.scheduler||new e.exports.MatrixScheduler,new e.exports.MatrixClient(t)}},function(e,t){"use strict";function n(e,t){this.roomId=e,this.info=t}e.exports=n},function(e,t){function n(e){var t=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},n=function(e,t,n){for(var i=["override","content","room","sender","underride"],s=0;s<i.length;++s)for(var a=i[s],l=t[a],c=0;c<l.length;++c){var u=l[c];if(u.enabled){var p=r(a,u,n);if(p&&o(p,e))return u.kind=a,u}}return null},r=function(e,t,n){var r={rule_id:t.rule_id,actions:t.actions,conditions:[]};switch(e){case"underride":case"override":r.conditions=t.conditions;break;case"room":if(!t.rule_id)return null;r.conditions.push({kind:"event_match",key:"room_id",pattern:t.rule_id});break;case"sender":if(!t.rule_id)return null;r.conditions.push({kind:"event_match",key:"user_id",pattern:t.rule_id});break;case"content":if(!t.pattern)return null;r.conditions.push({kind:"event_match",key:"content.body",pattern:t.pattern})}return n&&r.conditions.push({kind:"device",profile_tag:n}),r},o=function(e,t){for(var n=!0,r=0;r<e.conditions.length;++r){var o=e.conditions[r];n&=i(o,t)}return n},i=function(e,t){var n={event_match:c,device:l,contains_display_name:a,room_member_count:s};return n[e.kind]?n[e.kind](e,t):!0},s=function(t,n){if(!t.is)return!1;var r=e.getRoom(n.room_id);if(!r||!r.currentState||!r.currentState.members)return!1;var o=Object.keys(r.currentState.members).length,i=t.is.match(/^([=<>]*)([0-9]*)$/);if(!i)return!1;var s=i[1],a=parseInt(i[2]);if(isNaN(a))return!1;switch(s){case"":case"==":return o==a;case"<":return a>o;case">":return o>a;case"<=":return a>=o;case">=":return o>=a;default:return!1}},a=function(n,r){if(!r.content||!r.content.body||"string"!=typeof r.content.body)return!1;var o=e.getRoom(r.room_id);if(!(o&&o.currentState&&o.currentState.members&&o.currentState.getMember(e.credentials.userId)))return!1;var i=o.currentState.getMember(e.credentials.userId).name,s=new RegExp("\\b"+t(i)+"\\b","i");return r.content.body.search(s)>-1},l=function(e,t){return!1},c=function(e,t){var n=p(e.key,t);if(!n||"string"!=typeof n)return!1;var r;r="content.body"==e.key?"\\b"+u(e.pattern)+"\\b":"^"+u(e.pattern)+"$";var o=new RegExp(r,"i");return!!n.match(o)},u=function(e){var n=t(e);return n=n.replace(/\\\*/,".*"),n=n.replace(/\?/,"."),n=n.replace(/\\\[(!|)(.*)\\]/,function(e,t,n,r,o){var i=t&&"^"||"",s=n.replace(/\\\-/,"-");return"["+i+s+"]"})},p=function(e,t){for(var n=e.split("."),r=t;n.length>0;){var o=n.shift();if(!r[o])return null;r=r[o]}return r},d=function(t,r){if(!r)return null;if(t.user_id==e.credentials.userId)return null;for(var o=Object.keys(r.device),i=0;i<o.length;++i){var s=o[i],a=r.device[s],l=n(a,s);if(l)return l}return n(t,r.global)},h=function(e){for(var t={notify:!1,tweaks:{}},n=0;n<e.length;++n){var r=e[n];"notify"===r?t.notify=!0:"object"==typeof r&&(void 0===r.value&&(r.value=!0),t.tweaks[r.set_tweak]=r.value)}return t},m=function(e,t){var n=d(e,t);if(!n)return{};var r=h(n.actions);return void 0===r.tweaks.highlight&&(r.tweaks.highlight="content"==n.kind),r};this.actionsForEvent=function(t){return m(t,e.pushRules)}}e.exports=n},function(e,t,n){"use strict";function r(e,t){this.retryAlgorithm=e||r.RETRY_BACKOFF_RATELIMIT,this.queueAlgorithm=t||r.QUEUE_MESSAGES,this._queues={},this._activeQueues=[],this._procFn=null}function o(e){e._procFn&&c.forEach(c.filter(c.keys(e._queues),function(t){return-1===e._activeQueues.indexOf(t)&&e._queues[t].length>0}),function(t){e._activeQueues.push(t),l("Spinning up queue: '%s'",t),i(e,t)})}function i(e,t){var n=s(e,t);if(!n){var r=e._activeQueues.indexOf(t);return r>=0&&e._activeQueues.splice(r,1),void l("Stopping queue '%s' as it is now empty",t)}l("Queue '%s' has %s pending events",t,e._queues[t].length),e._procFn(n.event).done(function(r){a(e,t),l("Queue '%s' sent event %s",t,n.event.getId()),n.defer.resolve(r),i(e,t)},function(r){n.attempts+=1;var o=e.retryAlgorithm(n.event,n.attempts,r);l("retry(%s) err=%s event_id=%s waitTime=%s",n.attempts,r,n.event.getId(),o),-1===o?(l("Queue '%s' giving up on event %s",t,n.event.getId()),a(e,t),n.defer.reject(r),i(e,t)):setTimeout(function(){i(e,t)},o)})}function s(e,t){var n=e._queues[t];return c.isArray(n)?n[0]:null}function a(e,t){var n=e._queues[t];return c.isArray(n)?n.shift():null}function l(){p&&console.log.apply(console,arguments)}var c=n(11),u=n(20),p=!1;r.prototype.getQueueForEvent=function(e){var t=this.queueAlgorithm(e);return t&&this._queues[t]?c.map(this._queues[t],function(e){return e.event}):null},r.prototype.removeEventFromQueue=function(e){var t=this.queueAlgorithm(e);if(!t||!this._queues[t])return!1;var n=!1;return c.removeElement(this._queues[t],function(t){return t.event.getId()===e.getId()?(n=!0,!0):void 0}),n},r.prototype.setProcessFunction=function(e){this._procFn=e,o(this)},r.prototype.queueEvent=function(e){var t=this.queueAlgorithm(e);if(!t)return null;this._queues[t]||(this._queues[t]=[]);var n=u.defer();return this._queues[t].push({event:e,defer:n,attempts:0}),l("Queue algorithm dumped event %s into queue '%s'",e.getId(),t),o(this),n.promise},r.RETRY_BACKOFF_RATELIMIT=function(e,t,n){if(400===n.httpStatus||403===n.httpStatus||401===n.httpStatus)return-1;if("M_LIMIT_EXCEEDED"===n.name){var r=n.data.retry_after_ms;if(r)return r}return t>4?-1:1e3*Math.pow(2,t)},r.QUEUE_MESSAGES=function(e){return"m.room.message"===e.getType()?"message":null},e.exports=r},function(e,t,n){"use strict";var r=n(11);e.exports.MatrixInMemoryStore=function(){this.rooms={},this.users={},this.syncToken=null},e.exports.MatrixInMemoryStore.prototype={getSyncToken:function(){return this.syncToken},setSyncToken:function(e){this.syncToken=e},storeRoom:function(e){this.rooms[e.roomId]=e},getRoom:function(e){return this.rooms[e]||null},getRooms:function(){return r.values(this.rooms)},getRoomSummaries:function(){return r.map(r.values(this.rooms),function(e){return e.summary})},storeUser:function(e){this.users[e.userId]=e},getUser:function(e){return this.users[e]||null},scrollback:function(e,t){return[]},storeEvents:function(e,t,n,r){}}},function(e,t,n){"use strict";function r(e){if(this.store=e,!u.isFunction(e.getItem)||!u.isFunction(e.setItem)||!u.isFunction(e.removeItem))throw new Error("Supplied webStore does not meet the WebStorage API interface")}function o(e){return d+"devices/"+e}function i(e){return d+"sessions/"+e}function s(e){return d+"rooms/"+e}function a(e,t){try{return JSON.parse(e.getItem(t))}catch(n){c("Failed to get key %s: %s",t,n),c(n.stack)}return null}function l(e,t,n){e.setItem(t,JSON.stringify(n))}function c(){p&&console.log.apply(console,arguments)}var u=n(11),p=!1,d="session.e2e.";r.prototype={storeEndToEndAccount:function(e){this.store.setItem(h,e)},getEndToEndAccount:function(){return this.store.getItem(h)},storeEndToEndDevicesForUser:function(e,t){l(this.store,o(e),t)},getEndToEndDevicesForUser:function(e){return a(this.store,o(e))},storeEndToEndSession:function(e,t,n){var r=this.getEndToEndSessions(e)||{};r[t]=n,l(this.store,i(e),r)},getEndToEndSessions:function(e){return a(this.store,i(e))},storeEndToEndRoom:function(e,t){l(this.store,s(e),t)},getEndToEndRoom:function(e){return a(this.store,s(e))}};var h=d+"account";e.exports=r},function(e,t){"use strict";function n(){this.fromToken=null}n.prototype={getSyncToken:function(){return this.fromToken},setSyncToken:function(e){this.fromToken=e},storeRoom:function(e){},getRoom:function(e){return null},getRooms:function(){return[]},getRoomSummaries:function(){return[]},storeUser:function(e){},getUser:function(e){return null},scrollback:function(e,t){return[]},storeEvents:function(e,t,n,r){}},e.exports=n},function(e,t,n){"use strict";function r(e,t){if(this.store=e,this.batchSize=t,!(m.isFunction(e.getItem)&&m.isFunction(e.setItem)&&m.isFunction(e.removeItem)&&m.isFunction(e.key)))throw new Error("Supplied webStore does not meet the WebStorage API interface");if(!parseInt(e.length)&&0!==e.length)throw new Error("Supplied webStore does not meet the WebStorage API interface (length)");this._roomIds=[],this._syncedWithStore=!1,this._tokens=[]}function o(e){this.state={events:{}},this.timeline={},this.roomId=e}function i(e,t,n,r){var o=new f(t,r.length),i=u(e,c(t,"state")),s=[];m.forEach(m.keys(i.events),function(e){m.forEach(m.keys(i.events[e]),function(t){s.push(i.events[e][t])})});var p=m.map(m.deepCopy(s),function(e){return new v(e)}),d=m.map(s,function(e){return new v(e)});o.oldState.setStateEvents(p),o.currentState.setStateEvents(d);for(var h,g,y,_=[],E=l(a(e,t)),b=E;_.length<n&&(g=c(t,"timeline",E),y=u(e,g)||[],0!==y.length);){for(h=y.length-1;h>=0;h--)if(_.unshift(new v(y[h])),_.length===n){b=E;break}E--}return o.addEventsToTimeline(_.reverse(),!0),o.oldState.paginationToken=i.pagination_token,r.push({earliestIndex:b}),o}function s(e,t){p(e,c(t.roomId,"state"),t.state),m.forEach(m.keys(t.timeline),function(n){p(e,c(t.roomId,"timeline",n),t.timeline[n])})}function a(e,t){for(var n=[],r=0;r<e.length;r++)-1!==e.key(r).indexOf(c(t,"timeline_"))&&n.push(e.key(r).replace(c(t,"timeline_"),""));return n}function l(e,t){for(var n,r,o=0;o<e.length;o++)r=parseInt(e[o]),!isNaN(r)&&(void 0===n||!t&&r>n||t&&n>r)&&(n=r);return n}function c(e,t,n){return"room_"+e+"_"+t+(void 0===n?"":"_"+n)}function u(e,t){try{return JSON.parse(e.getItem(t))}catch(n){d("Failed to get key %s: %s",t,n),d(n.stack)}return null}function p(e,t,n){e.setItem(t,JSON.stringify(n))}function d(){h&&console.log.apply(console,arguments)}var h=!1,m=n(11),f=n(57),g=n(58),v=n(26).MatrixEvent;r.prototype.getSyncToken=function(){return this.store.getItem("sync_token")},r.prototype.setSyncToken=function(e){this.store.setItem("sync_token",e)},r.prototype.storeRoom=function(e){var t=o.fromRoom(e,this.batchSize);s(this.store,t),-1===this._roomIds.indexOf(e.roomId)&&this._roomIds.push(e.roomId)},r.prototype.getRoom=function(e){if(!u(this.store,c(e,"state")))return d("getRoom: No room with id %s found.",e),null;var t=a(this.store,e);return-1!==t.indexOf("live")&&(d("getRoom: Live events found. Syncing timeline for %s",e),this._syncTimeline(e,t)),i(this.store,e,this.batchSize,this._tokens)},r.prototype.getRooms=function(){var e,t=[];if(!this._syncedWithStore){for(this._roomIds=[],
e=0;e<this.store.length;e++)if(0===this.store.key(e).indexOf("room_")&&-1!==this.store.key(e).indexOf("_state")){var n=this.store.key(e);this._roomIds.push(n.substring("room_".length,n.length-"_state".length))}this._syncedWithStore=!0}for(e=0;e<this._roomIds.length;e++){var r=this.getRoom(this._roomIds[e]);r&&t.push(r)}return t},r.prototype.getRoomSummaries=function(){return[]},r.prototype.storeUser=function(e){p(this.store,"user_"+e.userId,{presence:e.events.presence?e.events.presence.event:null})},r.prototype.getUser=function(e){var t=u(this.store,"user_"+e);if(!t)return null;var n=new g(e);return t.presence&&n.setPresenceEvent(new v(t.presence)),n},r.prototype.scrollback=function(e,t){if(void 0===e.storageToken||e.storageToken>=this._tokens.length)return[];var n,r=this._tokens[e.storageToken]||{},o=r.earliestIndex,i=e.timeline[0]?e.timeline[0].getId():null;d("scrollback in %s (timeline=%s msgs) i=%s, timeline[0].id=%s - req %s events",e.roomId,e.timeline.length,o,i,t);var s=u(this.store,c(e.roomId,"timeline",o));if(!s)return d("No batch with index %s found.",o),[];var a=[],l=!1;for(n=s.length-1;n>=0;n--){var p=new v(s[n]);if(p.getId()!==i){if(l&&(d("Add event at position %s in batch %s",n,o),a.push(s[n]),a.length===t))break}else l=!0,d("Found timeline[0] event at position %s in batch %s",n,o)}if(a.length===t)return d("Batch has enough events to satisfy request."),a;if(!l)return d("Failed to find event ID %s in batch %s",i,o),[];for(;a.length<t;){if(o--,s=u(this.store,c(e.roomId,"timeline",o)),!s){d("No batch found at index %s",o);break}for(n=s.length-1;n>=0&&(d("Add event at position %s in batch %s",n,o),a.push(s[n]),a.length!==t);n--);}return d("Out of %s requested events, returning %s. New index=%s",t,a.length,o),e.addEventsToTimeline(m.map(a,function(e){return new v(e)}),!0),this._tokens[e.storageToken]={earliestIndex:o},a},r.prototype.storeEvents=function(e,t,n,r){if(r){var i,s,h,f=l(a(this.store,e.roomId),!0);for(i=0;i<t.length;i++){for(s=c(e.roomId,"timeline",f),h=u(this.store,s)||[];h.length<this.batchSize&&i<t.length;)h.unshift(t[i].event),i++;i--,p(this.store,s,h),f--}}else{var g=u(this.store,c(e.roomId,"timeline","live"))||[];d("Adding %s events to %s live list (which has %s already)",t.length,e.roomId,g.length);var v=!1;if(g=g.concat(m.map(t,function(e){return e.isState()&&(v=!0),e.event})),p(this.store,c(e.roomId,"timeline","live"),g),v){d("Storing state for %s as new events updated state",e.roomId);var y=o.fromRoom(e,0);p(this.store,c(y.roomId,"state"),y.state)}}},r.prototype._syncTimeline=function(e,t){t=t||a(this.store,e);for(var n=u(this.store,c(e,"timeline","live"))||[],r=l(t),o=c(e,"timeline",r),i=u(this.store,o)||[];i.length<this.batchSize&&n.length>0;)i.push(n.shift());p(this.store,o,i);for(var s=[];n.length>0;)s.push(n.shift()),(s.length===this.batchSize||0===n.length)&&(r++,o=c(e,"timeline",r),p(this.store,o,s),s=[]);p(this.store,c(e,"timeline","live"),[])},o.fromRoom=function(e,t){var n,r=new o(e.roomId);if(r.state.pagination_token=e.oldState.paginationToken,m.forEach(m.keys(e.currentState.events),function(t){m.forEach(m.keys(e.currentState.events[t]),function(n){r.state.events[t]||(r.state.events[t]={}),r.state.events[t][n]=e.currentState.events[t][n].event})}),t>0)for(n=0;n*t<e.timeline.length;)r.timeline[n]=e.timeline.slice(n*t,(n+1)*t),r.timeline[n]=m.map(r.timeline[n],function(e){return e.event}),n++;else r.timeline[0]=m.map(e.timeline,function(e){return e.event});return r},e.exports=r},function(e,t,n){var r,o,i;!function(n,s){o=[],r=s,i="function"==typeof r?r.apply(t,o):r,!(void 0!==i&&(e.exports=i))}(this,function(){function e(o,i){if("function"!=typeof i)throw new Error("Bad callback given: "+i);if(!o)throw new Error("No options given");var a=o.onResponse;if(o="string"==typeof o?{uri:o}:JSON.parse(JSON.stringify(o)),o.onResponse=a,o.verbose&&(e.log=r()),o.url&&(o.uri=o.url,delete o.url),!o.uri&&""!==o.uri)throw new Error("options.uri is a required argument");if("string"!=typeof o.uri)throw new Error("options.uri must be a string");for(var l=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],c=0;c<l.length;c++)if(o[l[c]])throw new Error("options."+l[c]+" is not supported");if(o.callback=i,o.method=o.method||"GET",o.headers=o.headers||{},o.body=o.body||null,o.timeout=o.timeout||e.DEFAULT_TIMEOUT,o.headers.host)throw new Error("Options.headers.host is not supported");o.json&&(o.headers.accept=o.headers.accept||"application/json","GET"!==o.method&&(o.headers["content-type"]="application/json"),"boolean"!=typeof o.json?o.body=JSON.stringify(o.json):"string"!=typeof o.body&&(o.body=JSON.stringify(o.body)));var u=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")};if(o.qs){var p="string"==typeof o.qs?o.qs:u(o.qs);-1!==o.uri.indexOf("?")?o.uri=o.uri+"&"+p:o.uri=o.uri+"?"+p}var d=function(e){var t={};t.boundry="-------------------------------"+Math.floor(1e9*Math.random());var n=[];for(var r in e)e.hasOwnProperty(r)&&n.push("--"+t.boundry+'\nContent-Disposition: form-data; name="'+r+'"\n\n'+e[r]+"\n");return n.push("--"+t.boundry+"--"),t.body=n.join(""),t.length=t.body.length,t.type="multipart/form-data; boundary="+t.boundry,t};if(o.form){if("string"==typeof o.form)throw"form name unsupported";if("POST"===o.method){var h=(o.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(o.headers["content-type"]=h,h){case"application/x-www-form-urlencoded":o.body=u(o.form).replace(/%20/g,"+");break;case"multipart/form-data":var m=d(o.form);o.body=m.body,o.headers["content-type"]=m.type;break;default:throw new Error("unsupported encoding:"+h)}}}return o.onResponse=o.onResponse||n,o.onResponse===!0&&(o.onResponse=i,o.callback=n),!o.headers.authorization&&o.auth&&(o.headers.authorization="Basic "+s(o.auth.username+":"+o.auth.password)),t(o)}function t(t){function n(){p=!0;var n=new Error("ETIMEDOUT");return n.code="ETIMEDOUT",n.duration=t.timeout,e.log.error("Timeout",{id:u._id,milliseconds:t.timeout}),t.callback(n,u)}function r(n){if(p)return e.log.debug("Ignoring timed out state change",{state:u.readyState,id:u.id});if(e.log.debug("State change",{state:u.readyState,id:u.id,timed_out:p}),u.readyState===a.OPENED){e.log.debug("Request started",{id:u.id});for(var r in t.headers)u.setRequestHeader(r,t.headers[r])}else u.readyState===a.HEADERS_RECEIVED?o():u.readyState===a.LOADING?(o(),s()):u.readyState===a.DONE&&(o(),s(),l())}function o(){if(!f.response){if(f.response=!0,e.log.debug("Got response",{id:u.id,status:u.status}),clearTimeout(u.timeoutTimer),u.statusCode=u.status,d&&0==u.statusCode){var n=new Error("CORS request rejected: "+t.uri);return n.cors="rejected",f.loading=!0,f.end=!0,t.callback(n,u)}t.onResponse(null,u)}}function s(){f.loading||(f.loading=!0,e.log.debug("Response body loading",{id:u.id}))}function l(){if(!f.end){if(f.end=!0,e.log.debug("Request done",{id:u.id}),u.body=u.responseText,t.json)try{u.body=JSON.parse(u.responseText)}catch(n){return t.callback(n,u)}t.callback(null,u,u.body)}}var u=new a,p=!1,d=i(t.uri),h="withCredentials"in u;if(c+=1,u.seq_id=c,u.id=c+": "+t.method+" "+t.uri,u._id=u.id,d&&!h){var m=new Error("Browser does not support cross-origin request: "+t.uri);return m.cors="unsupported",t.callback(m,u)}u.timeoutTimer=setTimeout(n,t.timeout);var f={response:!1,loading:!1,end:!1};return u.onreadystatechange=r,u.open(t.method,t.uri,!0),d&&(u.withCredentials=!!t.withCredentials),u.send(t.body),u}function n(){}function r(){var e,t,r={},i=["trace","debug","info","warn","error"];for(t=0;t<i.length;t++)e=i[t],r[e]=n,"undefined"!=typeof console&&console&&console[e]&&(r[e]=o(console,e));return r}function o(e,t){function n(n,r){return"object"==typeof r&&(n+=" "+JSON.stringify(r)),e[t].call(e,n)}return n}function i(e){var t,n=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{t=location.href}catch(r){t=document.createElement("a"),t.href="",t=t.href}var o=n.exec(t.toLowerCase())||[],i=n.exec(e.toLowerCase()),s=!(!i||i[1]==o[1]&&i[2]==o[2]&&(i[3]||("http:"===i[1]?80:443))==(o[3]||("http:"===o[1]?80:443)));return s}function s(e){var t,n,r,o,i,s,a,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,p=0,d="",h=[];if(!e)return e;do t=e.charCodeAt(u++),n=e.charCodeAt(u++),r=e.charCodeAt(u++),l=t<<16|n<<8|r,o=l>>18&63,i=l>>12&63,s=l>>6&63,a=63&l,h[p++]=c.charAt(o)+c.charAt(i)+c.charAt(s)+c.charAt(a);while(u<e.length);switch(d=h.join(""),e.length%3){case 1:d=d.slice(0,-2)+"==";break;case 2:d=d.slice(0,-1)+"="}return d}var a=XMLHttpRequest;if(!a)throw new Error("missing XMLHttpRequest");e.log={trace:n,debug:n,info:n,warn:n,error:n};var l=18e4,c=0;e.withCredentials=!1,e.DEFAULT_TIMEOUT=l,e.defaults=function(t,n){var r=function(e){var n=function(n,r){n="string"==typeof n?{uri:n}:JSON.parse(JSON.stringify(n));for(var o in t)void 0===n[o]&&(n[o]=t[o]);return e(n,r)};return n},o=r(e);return o.get=r(e.get),o.post=r(e.post),o.put=r(e.put),o.head=r(e.head),o};var u=["get","put","post","head"];return u.forEach(function(t){var n=t.toUpperCase(),r=t.toLowerCase();e[r]=function(t){"string"==typeof t?t={method:n,uri:t}:(t=JSON.parse(JSON.stringify(t)),t.method=n);var r=[t].concat(Array.prototype.slice.apply(arguments,[1]));return e.apply(this,r)}}),e.couch=function(t,r){function o(e,t,n){if(e)return r(e,t,n);if((t.statusCode<200||t.statusCode>299)&&n.error){e=new Error("CouchDB error: "+(n.error.reason||n.error.error));for(var o in n)e[o]=n[o];return r(e,t,n)}return r(e,t,n)}"string"==typeof t&&(t={uri:t}),t.json=!0,t.body&&(t.json=t.body),delete t.body,r=r||n;var i=e(t,o);return i},e})},function(e,t,n){"use strict";function r(e){var t=i.defer(),n=document.createElement("img"),r=new FileReader;return r.onload=function(e){n.src=e.target.result,n.onload=function(){t.resolve({w:n.width,h:n.height})},n.onerror=function(e){t.reject(e)}},r.onerror=function(e){t.reject(e)},r.readAsDataURL(e),t.promise}function o(e,t,n){var o={body:e.name,info:{size:e.size}};e.type&&(o.info.mimetype=e.type);var a=i.defer();return 0==e.type.indexOf("image/")?(o.msgtype="m.image",r(e).then(function(e){s(o.info,e),a.resolve()})):(o.msgtype="m.file",a.resolve()),a.promise.then(function(){return n.uploadContent(e)}).then(function(e){return o.url=e,n.sendMessage(t,o)})}var i=n(20),s=n(61);e.exports={sendContentToRoom:o}},function(e,t,n){"use strict";var r,o,i=n(2),s=18e4,a=["online","offline","unavailable"];e.exports={start:function(){var e=this;this.running=!0,void 0===r&&(document.onmousemove=function(){e._resetTimer()},document.onkeypress=function(){e._resetTimer()},this._resetTimer())},stop:function(){this.running=!1,o&&(clearTimeout(o),o=void 0),r=void 0},getState:function(){return r},setState:function(e){if(e!==r){if(-1===a.indexOf(e))throw new Error("Bad presence state: "+e);this.running&&(r=e,i.get().setPresence(r).done(function(){console.log("Presence: %s",e)},function(e){console.error("Failed to set presence: %s",e)}))}},_onUnavailableTimerFire:function(){this.setState("unavailable")},_resetTimer:function(){var e=this;this.setState("online"),clearTimeout(o),o=setTimeout(function(){e._onUnavailableTimerFire()},s)}}},function(e,t){(function(t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e),this.components=null}return r(e,[{key:"getComponent",value:function(e){if(null===this.components)throw new Error("Attempted to get a component before a skin has been loaded.This is probably because either: a) Your app has not called sdk.loadSkin(), or b) A component has called getComponent at the root level");var t=this.components[e];if(t)return t;throw new Error("No such component: "+e)}},{key:"load",value:function(e){if(null!==this.components)throw new Error("Attempted to load a skin while a skin is already loadedIf you want to change the active skin, call resetSkin first");this.components=e}},{key:"reset",value:function(){this.components=null}}]),e}();void 0===t.mxSkinner&&(t.mxSkinner=new o),e.exports=t.mxSkinner}).call(t,function(){return this}())},function(e,t,n){"use strict";var r=n(2),o=n(94),i=n(5),s=n(97),a=function(e){return{error:e}},l=function(e){return{promise:e}},c={nick:function(e,t){return t?l(r.get().setDisplayName(t)):a("Usage: /nick <display_name>")},encrypt:function(e,t){if("on"==t){var n=r.get(),o=n.getRoom(e).currentState.members,i=Object.keys(o);return l(s.enableEncryption(n,e,i))}if("off"==t){var n=r.get();return l(s.disableEncryption(n,e))}return a("Usage: encrypt <on/off>")},topic:function(e,t){return t?l(r.get().setRoomTopic(e,t)):a("Usage: /topic <topic>")},invite:function(e,t){if(t){var n=t.match(/^(\S+)$/);if(n)return l(r.get().invite(e,n[1]))}return a("Usage: /invite <userId>")},join:function(e,t){if(t){var n=t.match(/^(\S+)$/);if(n){var s=n[1];if("#"!==s[0])return a("Usage: /join #alias:domain");if(!s.match(/:/)){var c=r.get().credentials.userId.replace(/^.*:/,"");s+=":"+c}var u=o.getRoomForAlias(r.get().getRooms(),s);return u?(i.dispatch({action:"view_room",room_id:u.roomId}),l()):l(r.get().joinRoom(s).then(function(e){i.dispatch({action:"view_room",room_id:e.roomId})}))}}return a("Usage: /join <room_alias>")},part:function(e,t){var n;if(t){var o=t.match(/^(\S+)$/);if(o){var s=o[1];if("#"!==s[0])return a("Usage: /part [#alias:domain]");if(!s.match(/:/)){var c=r.get().credentials.userId.replace(/^.*:/,"");s+=":"+c}for(var u=r.get().getRooms(),p=0;p<u.length;p++){for(var d=u[p].currentState.getStateEvents("m.room.aliases"),h=0;h<d.length;h++){for(var m=d[h].getContent().aliases||[],f=0;f<m.length;f++)if(m[f]===s){n=u[p].roomId;break}if(n)break}if(n)break}}if(!n)return a("Unrecognised room alias: "+s)}return n||(n=e),l(r.get().leave(n).then(function(){i.dispatch({action:"view_next_room"})}))},kick:function(e,t){if(t){var n=t.match(/^(\S+?)( +(.*))?$/);if(n)return l(r.get().kick(e,n[1],n[3]))}return a("Usage: /kick <userId> [<reason>]")},ban:function(e,t){if(t){var n=t.match(/^(\S+?)( +(.*))?$/);if(n)return l(r.get().ban(e,n[1],n[3]))}return a("Usage: /ban <userId> [<reason>]")},unban:function(e,t){if(t){var n=t.match(/^(\S+)$/);if(n)return l(r.get().unban(e,n[1]))}return a("Usage: /unban <userId>")},op:function(e,t){if(t){var n=t.match(/^(\S+?)( +(\d+))?$/),o=50;if(n){var i=n[1];if(4===n.length&&void 0!==n[3]&&(o=parseInt(n[3])),NaN!==o){var s=r.get().getRoom(e);if(!s)return a("Bad room ID: "+e);var c=s.currentState.getStateEvents("m.room.power_levels","");return l(r.get().setPowerLevel(e,i,o,c))}}}return a("Usage: /op <userId> [<power level>]")},deop:function(e,t){if(t){var n=t.match(/^(\S+)$/);if(n){var o=r.get().getRoom(e);if(!o)return a("Bad room ID: "+e);var i=o.currentState.getStateEvents("m.room.power_levels","");return l(r.get().setPowerLevel(e,t,void 0,i))}}return a("Usage: /deop <userId>")}};c.j=c.join,e.exports={processInput:function(e,t){if(t=t.replace(/\s+$/,""),"/"===t[0]&&"/"!==t[1]){var n=t.match(/^(\S+?)( +(.*))?$/),r=n[1].substring(1).toLowerCase(),o=n[3];return"me"===r?null:c[r]?c[r](e,o):a("Unrecognised command: "+t)}return null}}},function(e,t,n){"use strict";var r=n(2);e.exports={usersTypingApartFromMe:function(e){return this.usersTyping(e,[r.get().credentials.userId])},usersTyping:function(e,t){var n=[];void 0===t&&(t=[]);for(var r=Object.keys(e.currentState.members),o=0;o<r.length;++o){var i=r[o];e.currentState.members[i].typing&&-1==t.indexOf(i)&&n.push(e.currentState.members[i])}return n},whoIsTypingString:function(e){var t=this.usersTypingApartFromMe(e);if(0==t.length)return null;if(1==t.length)return t[0].name+" is typing";var n=t.map(function(e){return e.name}),r=n.shift();return n.join(", ")+" and "+r+" are typing"}}},function(e,t,n){"use strict";var r=n(1);e.exports={propTypes:{onValueChanged:r.PropTypes.func,initialValue:r.PropTypes.string,label:r.PropTypes.string,placeHolder:r.PropTypes.string},Phases:{Display:"display",Edit:"edit"},getDefaultProps:function(){return{onValueChanged:function(){},initialValue:"",label:"Click to set",placeholder:""}},getInitialState:function(){return{value:this.props.initialValue,phase:this.Phases.Display}},componentWillReceiveProps:function(e){this.setState({value:e.initialValue})},getValue:function(){return this.state.value},setValue:function(e,t,n){var r=this;this.setState({value:e,phase:this.Phases.Display},function(){n||r.onValueChanged(t)})},edit:function(){this.setState({phase:this.Phases.Edit})},cancelEdit:function(){this.setState({phase:this.Phases.Display}),this.onValueChanged(!1)},onValueChanged:function(e){this.props.onValueChanged(this.state.value,e)}}},function(e,t,n){"use strict";var r=n(3),o=n(5);e.exports={componentDidMount:function(){this.dispatcherRef=o.register(this.onAction)},componentWillUnmount:function(){o.unregister(this.dispatcherRef)},onAction:function(e){"notifier_enabled"===e.action&&this.forceUpdate()},enabled:function(){var e=r.getComponent("organisms.Notifier");return e.isEnabled()},onClick:function(){var e=r.getComponent("organisms.Notifier"),t=this;e.supportsDesktopNotifications()&&(e.isEnabled()?e.setEnabled(!1):e.setEnabled(!0,function(){t.forceUpdate()}),this.forceUpdate())}}},function(e,t,n){"use strict";var r=n(5);e.exports={onClick:function(){r.dispatch({action:"logout"})}}},function(e,t,n){"use strict";var r=n(1),o=n(2);e.exports={propTypes:{member:r.PropTypes.object.isRequired,width:r.PropTypes.number,height:r.PropTypes.number,resizeMethod:r.PropTypes.string},getDefaultProps:function(){return{width:40,height:40,resizeMethod:"crop"}},defaultAvatarUrl:function(e,t,n,r){return this.skinnedDefaultAvatarUrl?this.skinnedDefaultAvatarUrl(e,t,n,r):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADRJREFUeNrszQENADAIACB9QjNbxSKP4eagAFnTseHFErFYLBaLxWKxWCwWi8Vi8cX4CzAABSwCRWJw31gAAAAASUVORK5CYII="},onError:function(e){e.target.src!=this.defaultAvatarUrl(this.props.member)&&this.setState({imageUrl:this.defaultAvatarUrl(this.props.member)})},getInitialState:function(){var e=this.props.member.getAvatarUrl(o.get().getHomeserverUrl(),this.props.width,this.props.height,this.props.resizeMethod,!1);return e||(e=this.defaultAvatarUrl(this.props.member,this.props.width,this.props.height,this.props.resizeMethod)),{imageUrl:e}}}},function(e,t,n){"use strict";var r=n(2);e.exports={getDefaultProps:function(){return{width:36,height:36,resizeMethod:"crop"}},getInitialState:function(){return this._update(),{imageUrl:this._nextUrl()}},componentWillReceiveProps:function(e){this._update(),this.setState({imageUrl:this._nextUrl()})},_update:function(){this.urlList=this.getUrlList(),this.urlListIndex=-1},_nextUrl:function(){do++this.urlListIndex;while(null===this.urlList[this.urlListIndex]&&this.urlListIndex<this.urlList.length);return this.urlListIndex<this.urlList.length?this.urlList[this.urlListIndex]:null},roomAvatarUrl:function(){var e=this.props.room.getAvatarUrl(r.get().getHomeserverUrl(),this.props.width,this.props.height,this.props.resizeMethod,!1);return e},getOneToOneAvatar:function(){var e=Object.keys(this.props.room.currentState.members);if(2==e.length){var t=null;return t=this.props.room.currentState.members[e[0]].userId==r.get().credentials.userId?this.props.room.currentState.members[e[1]]:this.props.room.currentState.members[e[0]],t.getAvatarUrl(r.get().getHomeserverUrl(),this.props.width,this.props.height,this.props.resizeMethod,!1)}return 1==e.length?this.props.room.currentState.members[e[0]].getAvatarUrl(r.get().getHomeserverUrl(),this.props.width,this.props.height,this.props.resizeMethod,!1):null},onError:function(e){this.setState({imageUrl:this._nextUrl()})}}},function(e,t,n){"use strict";var r=n(1);e.exports={propTypes:{onCreateRoom:r.PropTypes.func},getDefaultProps:function(){return{onCreateRoom:function(){}}},onClick:function(){this.props.onCreateRoom()}}},function(e,t,n){"use strict";var r=n(1);e.exports={propTypes:{homeserver:r.PropTypes.string,alias:r.PropTypes.string,onChange:r.PropTypes.func},getDefaultProps:function(){return{onChange:function(){},alias:""}},getAliasLocalpart:function(){var e=this.props.alias;if(e&&this.props.homeserver){var t=":"+this.props.homeserver;e.startsWith("#")&&e.endsWith(t)&&(e=e.slice(1,-t.length))}return e}}},function(e,t,n){"use strict";var r=n(1),o=n(2);e.exports={propTypes:{initialAvatarUrl:r.PropTypes.string,room:r.PropTypes.object},Phases:{Display:"display",Uploading:"uploading",Error:"error"},getInitialState:function(){return{avatarUrl:this.props.initialAvatarUrl,phase:this.Phases.Display}},setAvatarFromFile:function(e){var t=null;this.setState({phase:this.Phases.Uploading});var n=this;o.get().uploadContent(e).then(function(e){return t=e,n.props.room?o.get().sendStateEvent(n.props.room.roomId,"m.room.avatar",{url:e},""):o.get().setAvatarUrl(e)}).done(function(){n.setState({phase:n.Phases.Display,avatarUrl:o.get().mxcUrlToHttp(t)})},function(e){n.setState({phase:n.Phases.Error}),n.onError(e)})}}},function(e,t,n){"use strict";var r=n(2);e.exports={getDefaultProps:function(){return{onFinished:function(){}}},getInitialState:function(){return{busy:!1,errorString:null}},componentWillMount:function(){var e=r.get();this.setState({busy:!0});var t=this;e.getProfileInfo(e.credentials.userId).done(function(e){t.setState({displayName:e.displayname,busy:!1})},function(e){t.setState({errorString:"Failed to fetch display name",busy:!1})})},changeDisplayname:function(e){this.setState({busy:!0,errorString:null});var t=this;r.get().setDisplayName(e).then(function(){t.setState({busy:!1,displayName:e})},function(e){t.setState({busy:!1,errorString:"Failed to set display name"})})}}},function(e,t,n){"use strict";var r=n(1),o=n(2);e.exports={propTypes:{onFinished:r.PropTypes.func},Phases:{Edit:"edit",Uploading:"uploading",Error:"error",Success:"Success"},getDefaultProps:function(){return{onFinished:function(){}}},getInitialState:function(){return{phase:this.Phases.Edit,errorString:""}},changePassword:function(e,t){var n=o.get(),r={type:"m.login.password",user:n.credentials.userId,password:e};this.setState({phase:this.Phases.Uploading,errorString:""});var i=n.setPassword(r,t),s=this;i.then(function(){s.setState({phase:s.Phases.Success,errorString:""})},function(e){s.setState({phase:s.Phases.Error,errorString:e.toString()})})}}},function(e,t,n){"use strict";var r=n(2);e.exports={shouldHighlight:function(){var e=r.get().getPushActionsForEvent(this.props.mxEvent);return e&&e.tweaks?e.tweaks.highlight:!1}}},function(e,t,n){"use strict";var r=n(55),o=n(54),i=n(43);i(r),e.exports={componentDidMount:function(){o(this.refs.content.getDOMNode(),i.options)}}},function(e,t,n){"use strict";var r=n(53);e.exports={presentableTextForFile:function(e){var t="Attachment";e.body&&e.body.length>0&&(t=e.body);var n=[];return e.info&&e.info.size&&n.push(r(e.info.size)),n.length>0&&(t+=" ("+n.join(", ")+")"),t}}},function(e,t,n){"use strict";var r=n(55),o=n(54),i=n(43);i(r),e.exports={componentDidMount:function(){o(this.refs.content.getDOMNode(),i.options)}}},function(e,t,n){"use strict";var r=n(55),o=n(54),i=n(43);i(r),e.exports={componentDidMount:function(){o(this.refs.content.getDOMNode(),i.options)}}},function(e,t,n){"use strict";var r=n(2),o=n(5),i=n(14),s=n(3),a=n(10);e.exports={componentDidMount:function(){if(this.props.member){var e=this._calculateOpsPermissions();this.setState(e)}},onKick:function(){var e=s.getComponent("organisms.ErrorDialog"),t=this.props.member.roomId,n=this.props.member.userId;r.get().kick(t,n).done(function(){console.log("Kick success")},function(t){i.createDialog(e,{title:"Kick error",description:t.message})}),this.props.onFinished()},onBan:function(){var e=s.getComponent("organisms.ErrorDialog"),t=this.props.member.roomId,n=this.props.member.userId;r.get().ban(t,n).done(function(){console.log("Ban success")},function(t){i.createDialog(e,{title:"Ban error",description:t.message})}),this.props.onFinished()},onMuteToggle:function(){var e=s.getComponent("organisms.ErrorDialog"),t=this.props.member.roomId,n=this.props.member.userId,o=r.get().getRoom(t);if(!o)return void this.props.onFinished();var a=o.currentState.getStateEvents("m.room.power_levels","");if(!a)return void this.props.onFinished();var l,c=this.state.muted,u=a.getContent(),p=(u.events?u.events["m.room.message"]:null)||u.events_default;l=c?p:p-1,r.get().setPowerLevel(t,n,l,a).done(function(){console.log("Mute toggle success")},function(t){i.createDialog(e,{title:"Mute error",description:t.message})}),this.props.onFinished()},onModToggle:function(){var e=s.getComponent("organisms.ErrorDialog"),t=this.props.member.roomId,n=this.props.member.userId,o=r.get().getRoom(t);if(!o)return void this.props.onFinished();var a=o.currentState.getStateEvents("m.room.power_levels","");if(!a)return void this.props.onFinished();var l=o.getMember(r.get().credentials.userId);if(!l)return void this.props.onFinished();var c=a.getContent().users_default,u=l.powerLevel-1,p=this.state.isTargetMod?c:u;r.get().setPowerLevel(t,n,p,a).done(function(){console.log("Mod toggle success")},function(t){i.createDialog(e,{title:"Mod error",description:t.message})}),this.props.onFinished()},onChatClick:function(){for(var e=this,t=r.get().getRooms(),n=[this.props.member.userId,r.get().credentials.userId],i=null,s=0;s<t.length;s++){var a=t[s].getJoinedMembers();if(2===a.length){for(var l=!0,c=0;c<a.length;c++)if(-1===n.indexOf(a[c].userId)){l=!1;break}if(l){i=t[s].roomId;break}}}i?(o.dispatch({action:"view_room",room_id:i}),this.props.onFinished()):(e.setState({creatingRoom:!0}),r.get().createRoom({invite:[this.props.member.userId],preset:"private_chat"}).done(function(t){e.setState({creatingRoom:!1}),o.dispatch({action:"view_room",room_id:t.room_id}),e.props.onFinished()},function(t){e.setState({creatingRoom:!1}),console.error("Failed to create room: %s",JSON.stringify(t)),e.props.onFinished()}))},onLeaveClick:function(){var e=s.getComponent("organisms.ErrorDialog"),t=s.getComponent("organisms.QuestionDialog"),n=this.props.member.roomId;i.createDialog(t,{title:"Leave room",description:"Are you sure you want to leave the room?",onFinished:function(t){if(t){var s=r.get().leave(n),l=i.createDialog(a);s.then(function(){l.close(),o.dispatch({action:"view_next_room"})},function(t){l.close(),i.createDialog(e,{title:"Failed to leave room",description:t.toString()})})}}}),this.props.onFinished()},getInitialState:function(){return{can:{kick:!1,ban:!1,mute:!1,modifyLevel:!1},muted:!1,isTargetMod:!1,creatingRoom:!1}},_calculateOpsPermissions:function(){var e={can:{},muted:!1,modifyLevel:!1},t=r.get().getRoom(this.props.member.roomId);if(!t)return e;var n=t.currentState.getStateEvents("m.room.power_levels","");if(!n)return e;var o=t.getMember(r.get().credentials.userId),i=this.props.member;return{can:this._calculateCanPermissions(o,i,n.getContent()),muted:this._isMuted(i,n.getContent()),isTargetMod:i.powerLevel>n.getContent().users_default}},_calculateCanPermissions:function(e,t,n){var r={kick:!1,ban:!1,mute:!1,modifyLevel:!1},o=t.powerLevel<e.powerLevel;if(!o)return r;var i=(n.events?n.events["m.room.power_levels"]:null)||n.state_default;return r.kick=e.powerLevel>=n.kick,r.ban=e.powerLevel>=n.ban,r.mute=e.powerLevel>=i,r.modifyLevel=e.powerLevel>t.powerLevel,r},_isMuted:function(e,t){if(!t||!e)return!1;var n=(t.events?t.events["m.room.message"]:null)||t.events_default;return e.powerLevel<n}}},function(e,t,n){"use strict";var r=n(5),o=n(14),i=n(3),s=n(10),a=n(2);e.exports={getInitialState:function(){return{}},onLeaveClick:function(){var e=i.getComponent("organisms.QuestionDialog"),t=this.props.member.roomId;o.createDialog(e,{title:"Leave room",description:"Are you sure you want to leave the room?",onFinished:function(e){if(e){var n=a.get().leave(t),i=o.createDialog(s);n.then(function(){i.close(),r.dispatch({action:"view_next_room"})},function(e){i.close(),o.createDialog(ErrorDialog,{title:"Failed to leave room",description:e.toString()})})}}})}}},function(e,t,n){"use strict";var r=n(2),o=n(211),i=n(14),s=n(3),a=n(5),l={ENTER:13,TAB:9,SHIFT:16,UP:38,DOWN:40},c=1e4,u=3e4;e.exports={componentWillMount:function(){this.tabStruct={completing:!1,original:null,index:0},this.sentHistory={data:[],position:-1,roomId:null,originalText:null,element:null,init:function(e,t){this.roomId=t,this.element=e,this.position=-1;var n=window.sessionStorage.getItem("history_"+t);n&&(this.data=JSON.parse(n)),this.roomId&&this.setLastTextEntry()},push:function(e){this.data.unshift(e),window.sessionStorage.setItem("history_"+this.roomId,JSON.stringify(this.data)),this.position=-1,this.originalText=null},next:function(e){if(-1===this.position?this.originalText=this.element.value:this.data[this.position]=this.element.value,e>0&&this.position===this.data.length-1)return!1;var t=this.position+e;return t=Math.max(-1,t),t=Math.min(t,this.data.length-1),this.position=t,-1!==this.position?this.element.value=this.data[this.position]:void 0!==this.originalText&&(this.element.value=this.originalText),!0},saveLastTextEntry:function(){var e=this.element.value;window.sessionStorage.setItem("input_"+this.roomId,e)},setLastTextEntry:function(){var e=window.sessionStorage.getItem("input_"+this.roomId);e&&(this.element.value=e)}}},componentDidMount:function(){this.dispatcherRef=a.register(this.onAction),this.sentHistory.init(this.refs.textarea.getDOMNode(),this.props.room.roomId)},componentWillUnmount:function(){a.unregister(this.dispatcherRef),this.sentHistory.saveLastTextEntry()},onAction:function(e){switch(e.action){case"focus_composer":this.refs.textarea.getDOMNode().focus()}},onKeyDown:function(e){if(e.keyCode===l.ENTER){var t=this.refs.textarea.getDOMNode().value;if(0===t.length)return void e.preventDefault();this.sentHistory.push(t),this.onEnter(e)}else if(e.keyCode===l.TAB){var n=[];this.props.room&&(n=this.props.room.getJoinedMembers()),this.onTab(e,n)}else e.keyCode===l.UP||e.keyCode===l.DOWN?(this.sentHistory.next(e.keyCode===l.UP?1:-1),e.preventDefault()):e.keyCode!==l.SHIFT&&this.tabStruct.completing&&(this.tabStruct.completing=!1,this.tabStruct.index=0);var r=this;setTimeout(function(){r.refs.textarea&&""!=r.refs.textarea.getDOMNode().value?r.onTypingActivity():r.onFinishedTyping()},10)},onEnter:function(e){var t=this.refs.textarea.getDOMNode().value,n=o.processInput(this.props.room.roomId,t);if(n){if(e.preventDefault(),n.error||(this.refs.textarea.getDOMNode().value=""),n.promise)n.promise.done(function(){console.log("Command success.")},function(e){console.error("Command failure: %s",e);var t=s.getComponent("organisms.ErrorDialog");i.createDialog(t,{title:"Server error",description:e.message})});else if(n.error){console.error(n.error);var l=s.getComponent("organisms.ErrorDialog");i.createDialog(l,{title:"Command error",description:n.error})}}else{var c=null;c=/^\/me /i.test(t)?{msgtype:"m.emote",body:t.substring(4)}:{msgtype:"m.text",body:t},r.get().sendMessage(this.props.room.roomId,c).then(function(){a.dispatch({action:"message_sent"})},function(){a.dispatch({action:"message_send_failed"})}),this.refs.textarea.getDOMNode().value="",e.preventDefault()}},onTab:function(e,t){var n=this.refs.textarea.getDOMNode();this.tabStruct.completing||(this.tabStruct.completing=!0,this.tabStruct.index=0,this.tabStruct.original=n.value),e.shiftKey?(this.tabStruct.index--,this.tabStruct.index<0&&(this.tabStruct.index=Number.MAX_VALUE)):this.tabStruct.index++;var r=0,o=this.tabStruct.index,i=this.tabStruct.original,s=/@?([a-zA-Z0-9_\-:\.]+)$/.exec(i);if(0===o)n.value=i;else if(s&&s[1]){for(var a,l=0;l<t.length;l++){var c=t[l];c.name&&o>r&&0===c.name.toLowerCase().indexOf(s[1].toLowerCase())&&(a=c.name,r++)}if(o>r)for(var l=0;l<t.length&&!(r>=o);l++){var u=t[l].userId;1===u.toLowerCase().indexOf(s[1].toLowerCase())&&(a=u,r++)}r===o||o===Number.MAX_VALUE?(a+=s[0].length===i.length?": ":" ",
n.value=i.replace(/@?([a-zA-Z0-9_\-:\.]+)$/,a),n.style["background-color"]="",o===Number.MAX_VALUE&&(this.tabStruct.index=r,o=r)):(n.style["background-color"]="#faa",setTimeout(function(){n.style["background-color"]=""},150),n.value=i,this.tabStruct.index=0)}else this.tabStruct.index=0;e.preventDefault()},onTypingActivity:function(){this.isTyping=!0,this.userTypingTimer||this.sendTyping(!0),this.startUserTypingTimer(),this.startServerTypingTimer()},onFinishedTyping:function(){this.isTyping=!1,this.sendTyping(!1),this.stopUserTypingTimer(),this.stopServerTypingTimer()},startUserTypingTimer:function(){this.stopUserTypingTimer();var e=this;this.userTypingTimer=setTimeout(function(){e.isTyping=!1,e.sendTyping(e.isTyping),e.userTypingTimer=null},c)},stopUserTypingTimer:function(){this.userTypingTimer&&(clearTimeout(this.userTypingTimer),this.userTypingTimer=null)},startServerTypingTimer:function(){if(!this.serverTypingTimer){var e=this;this.serverTypingTimer=setTimeout(function(){e.isTyping&&(e.sendTyping(e.isTyping),e.startServerTypingTimer())},u/2)}},stopServerTypingTimer:function(){this.serverTypingTimer&&(clearTimeout(this.servrTypingTimer),this.serverTypingTimer=null)},sendTyping:function(e){r.get().sendTyping(this.props.room.roomId,this.isTyping,u).done()},refreshTyping:function(){this.typingTimeout&&(clearTimeout(this.typingTimeout),this.typingTimeout=null)}}},function(e,t,n){"use strict";n(2);e.exports={}},function(e,t,n){"use strict";var r=n(1);e.exports={propTypes:{value:r.PropTypes.number,max:r.PropTypes.number}}},function(e,t,n){"use strict";var r=n(1),o=n(5),i=n(23);e.exports={propTypes:{room:r.PropTypes.object.isRequired,editing:r.PropTypes.bool,onSettingsClick:r.PropTypes.func,onSaveClick:r.PropTypes.func},getDefaultProps:function(){return{editing:!1,onSettingsClick:function(){},onSaveClick:function(){}}},componentDidMount:function(){if(this.dispatcherRef=o.register(this.onAction),this.props.room){var e=i.getCallForRoom(this.props.room.roomId),t=e?e.call_state:"ended";this.setState({call_state:t})}},componentWillUnmount:function(){o.unregister(this.dispatcherRef)},onAction:function(e){if("call_state"===e.action&&e.room_id){var t=i.getCallForRoom(e.room_id),n=t?t.call_state:"ended";this.setState({call_state:n})}},onVideoClick:function(e){o.dispatch({action:"place_call",type:e.shiftKey?"screensharing":"video",room_id:this.props.room.roomId})},onVoiceClick:function(){o.dispatch({action:"place_call",type:"voice",room_id:this.props.room.roomId})},onHangupClick:function(){var e=i.getCallForRoom(this.props.room.roomId);e&&o.dispatch({action:"hangup",room_id:e.roomId})},onMuteAudioClick:function(){var e=i.getCallForRoom(this.props.room.roomId);if(e){var t=!e.isMicrophoneMuted();e.setMicrophoneMuted(t),this.setState({audioMuted:t})}},onMuteVideoClick:function(){var e=i.getCallForRoom(this.props.room.roomId);if(e){var t=!e.isLocalVideoMuted();e.setLocalVideoMuted(t),this.setState({videoMuted:t})}}}},function(e,t,n){"use strict";var r=n(1);e.exports={propTypes:{room:r.PropTypes.object.isRequired},getInitialState:function(){return{power_levels_changed:!1}}}},function(e,t,n){"use strict";var r=n(5);e.exports={onClick:function(){r.dispatch({action:"view_room",room_id:this.props.room.roomId})}}},function(e,t,n){"use strict";var r=n(1);e.exports={propTypes:{onHsUrlChanged:r.PropTypes.func,onIsUrlChanged:r.PropTypes.func,default_hs_url:r.PropTypes.string,default_is_url:r.PropTypes.string},getDefaultProps:function(){return{onHsUrlChanged:function(){},onIsUrlChanged:function(){},defaultHsUrl:"https://matrix.org/",defaultIsUrl:"https://matrix.org/"}},getInitialState:function(){return{hs_url:this.props.defaultHsUrl,is_url:this.props.defaultIsUrl}},hsChanged:function(e){this.setState({hs_url:e.target.value},function(){this.props.onHsUrlChanged(this.state.hs_url)})},isChanged:function(e){this.setState({is_url:e.target.value},function(){this.props.onIsUrlChanged(this.state.is_url)})},getHsUrl:function(){return this.state.hs_url},getIsUrl:function(){return this.state.is_url}}},function(e,t,n){"use strict";var r=n(1);e.exports={propTypes:{onChange:r.PropTypes.func,selected_users:r.PropTypes.arrayOf(r.PropTypes.string)},getDefaultProps:function(){return{onChange:function(){},selected:[]}},addUser:function(e){this.props.selected_users.indexOf(-1==e)&&this.props.onChange(this.props.selected_users.concat([e]))},removeUser:function(e){this.props.onChange(this.props.selected_users.filter(function(t){return t!=e}))}}},function(e,t,n){"use strict";var r=n(5),o=n(23);e.exports={componentDidMount:function(){this.dispatcherRef=r.register(this.onAction)},componentWillUnmount:function(){r.unregister(this.dispatcherRef)},getInitialState:function(){return{incomingCall:null}},onAction:function(e){if("call_state"===e.action){var t=o.getCall(e.room_id);if(!t||"ringing"!==t.call_state)return this.setState({incomingCall:null}),void this.getRingAudio().pause();"ringing"===t.call_state?(this.getRingAudio().load(),this.getRingAudio().play()):this.getRingAudio().pause(),this.setState({incomingCall:t})}},onAnswerClick:function(){r.dispatch({action:"answer",room_id:this.state.incomingCall.roomId})},onRejectClick:function(){r.dispatch({action:"hangup",room_id:this.state.incomingCall.roomId})}}},function(e,t,n){"use strict";var r=n(2),o=n(93);e.exports={onCasClicked:function(e){var t=o.getServiceUrl()+"#/login/cas",n=this;r.get().getCasServer().done(function(e){var n=e.serverUrl+"/login?service="+encodeURIComponent(t);window.location.href=n},function(e){n.setStep("stage_m.login.cas"),n.setState({errorText:"Login failed."})})}}},function(e,t,n){"use strict";var r=n(1),o=n(2),i=n(60).Presets,s=n(20),a=n(97);e.exports={propTypes:{onRoomCreated:r.PropTypes.func},phases:{CONFIG:"CONFIG",CREATING:"CREATING",CREATED:"CREATED",ERROR:"ERROR"},getDefaultProps:function(){return{onRoomCreated:function(){}}},getInitialState:function(){return{phase:this.phases.CONFIG,error_string:"",is_private:!0,share_history:!1,default_preset:i.PrivateChat,topic:"",room_name:"",invited_users:[]}},onCreateRoom:function(){var e={};this.state.room_name&&(e.name=this.state.room_name),this.state.topic&&(e.topic=this.state.topic),this.state.preset&&(this.state.preset!=i.Custom?e.preset=this.state.preset:e.initial_state=[{type:"m.room.join_rules",content:{join_rules:this.state.is_private?"invite":"public"}},{type:"m.room.history_visibility",content:{history_visibility:this.state.share_history?"shared":"invited"}}]),e.invite=this.state.invited_users;var t=this.getAliasLocalpart();t&&(e.room_alias_name=t);var n=o.get();if(!n)return void console.error("Cannot create room: No matrix client.");var r,l=n.createRoom(e);this.state.encrypt&&(l=l.then(function(t){return r=t,a.enableEncryption(n,r.roomId,e.invite)}).then(function(){return s(r)})),this.setState({phase:this.phases.CREATING});var c=this;l.then(function(e){c.setState({phase:c.phases.CREATED}),c.props.onRoomCreated(e.room_id)},function(e){c.setState({phase:c.phases.ERROR,error_string:e.toString()})})}}},function(e,t,n){"use strict";var r=n(1);e.exports={propTypes:{title:r.PropTypes.string,description:r.PropTypes.string,button:r.PropTypes.string,focus:r.PropTypes.bool,onFinished:r.PropTypes.func.isRequired},getDefaultProps:function(){return{title:"Error",description:"An error has occurred.",button:"OK",focus:!0}}}},function(e,t,n){"use strict";var r=n(5);e.exports={logOut:function(){r.dispatch({action:"logout"}),this.props.onFinished&&this.props.onFinished()},cancelPrompt:function(){this.props.onFinished&&this.props.onFinished()}}},function(e,t,n){"use strict";var r=n(2),o=n(14),i=n(3),s=50;e.exports={getInitialState:function(){if(!this.props.roomId)return{members:[]};var e=r.get(),t=e.getRoom(this.props.roomId);if(!t)return{members:[]};this.memberDict=this.getMemberDict();var n=this.roomMembers(s);return{members:n}},componentWillMount:function(){var e=r.get();e.on("RoomState.members",this.onRoomStateMember),e.on("Room",this.onRoom)},componentWillUnmount:function(){r.get()&&(r.get().removeListener("Room",this.onRoom),r.get().removeListener("RoomState.members",this.onRoomStateMember),r.get().removeListener("User.presence",this.userPresenceFn))},componentDidMount:function(){function e(e,n){n.lastPresenceTs=Date.now();var r=t.refs[n.userId];r&&t._updateList()}var t=this;setTimeout(function(){t.isMounted()&&t.setState({members:t.roomMembers()})},50),r.get().on("User.presence",e),this.userPresenceFn=e},onRoom:function(e){e.roomId===this.props.roomId&&this._updateList()},onRoomStateMember:function(e,t,n){this._updateList()},_updateList:function(){this.memberDict=this.getMemberDict();var e=this;this.setState({members:e.roomMembers()})},onInvite:function(e){var t=i.getComponent("organisms.ErrorDialog"),n=this;return e=e.trim(),"@"!==e[0]||-1===e.indexOf(":")?(console.error("Bad user ID to invite: %s",e),void o.createDialog(t,{title:"Invite Error",description:"Malformed user ID. Should look like '@localpart:domain'"})):(n.setState({inviting:!0}),console.log("Invite %s to %s",e,this.props.roomId),void r.get().invite(this.props.roomId,e).done(function(e){console.log("Invited"),n.setState({inviting:!1})},function(e){console.error("Failed to invite: %s",JSON.stringify(e)),o.createDialog(t,{title:"Server error whilst inviting",description:e.message}),n.setState({inviting:!1})}))},getMemberDict:function(){if(!this.props.roomId)return{};var e=r.get(),t=e.getRoom(this.props.roomId);if(!t)return{};var n=t.currentState.members;return Object.keys(n).map(function(e){n[e].user&&!n[e].user.lastPresenceTs&&(n[e].user.lastPresenceTs=Date.now())}),n},roomMembers:function(e){var t=this.memberDict||{},n=Object.keys(t);this.memberSort&&n.sort(this.memberSort);for(var r=[],o=0,i=0;i<n.length&&(void 0===e||e>o);++i){var s=n[i],a=t[s];("join"==a.membership||"invite"==a.membership)&&(r.push(s),++o)}return r}}},function(e,t,n){(function(t){"use strict";var r=n(2),o=n(5);e.exports={start:function(){this.boundOnRoomTimeline=this.onRoomTimeline.bind(this),r.get().on("Room.timeline",this.boundOnRoomTimeline),this.state={toolbarHidden:!1}},stop:function(){r.get()&&r.get().removeListener("Room.timeline",this.boundOnRoomTimeline)},supportsDesktopNotifications:function(){return!!t.Notification},havePermission:function(){return this.supportsDesktopNotifications()?"granted"==t.Notification.permission:!1},setEnabled:function(e,n){if(e){if(this.havePermission()||t.Notification.requestPermission(function(){n&&(n(),o.dispatch({action:"notifier_enabled",value:!0}))}),!t.localStorage)return;t.localStorage.setItem("notifications_enabled","true"),this.havePermission&&o.dispatch({action:"notifier_enabled",value:!0})}else{if(!t.localStorage)return;t.localStorage.setItem("notifications_enabled","false"),o.dispatch({action:"notifier_enabled",value:!1})}this.setToolbarHidden(!1)},isEnabled:function(){if(!this.havePermission())return!1;if(!t.localStorage)return!0;var e=t.localStorage.getItem("notifications_enabled");return null===e?!0:"true"===e},setToolbarHidden:function(e){this.state.toolbarHidden=e,o.dispatch({action:"notifier_enabled",value:this.isEnabled()})},isToolbarHidden:function(){return this.state.toolbarHidden},onRoomTimeline:function(e,t,n){if(!n&&(!e.sender||e.sender.userId!=r.get().credentials.userId)&&this.isEnabled()){var o=r.get().getPushActionsForEvent(e);o&&o.notify&&this.displayNotification(e,t)}}}}).call(t,function(){return this}())},function(e,t,n){"use strict";var r=n(1);e.exports={propTypes:{title:r.PropTypes.string,description:r.PropTypes.string,button:r.PropTypes.string,focus:r.PropTypes.bool,onFinished:r.PropTypes.func.isRequired},getDefaultProps:function(){return{title:"",description:"",button:"OK",focus:!0}}}},function(e,t,n){"use strict";var r=n(2),o=n(20),i=n(123).version;e.exports={Phases:{Loading:"loading",Display:"display"},getInitialState:function(){return{avatarUrl:null,threePids:[],clientVersion:i,phase:this.Phases.Loading}},componentWillMount:function(){var e=this,t=r.get(),n=t.getProfileInfo(t.credentials.userId),i=t.getThreePids();o.all([n,i]).then(function(t){e.setState({avatarUrl:t[0].avatar_url,threepids:t[1].threepids,phase:e.Phases.Display})},function(e){console.err(e)})}}},function(e,t,n){"use strict";var r=n(2),o=n(96),i=n(209),s=n(5),a=n(3),l=n(94),c=n(43),u=n(93);e.exports={PageTypes:{RoomView:"room_view",UserSettings:"user_settings",CreateRoom:"create_room",RoomDirectory:"room_directory"},AuxPanel:{RoomSettings:"room_settings"},getInitialState:function(){var e={logged_in:!(!r.get()||!r.get().credentials),collapse_lhs:!1,collapse_rhs:!1,ready:!1};return e.logged_in&&(r.get().getRooms().length?e.page_type=this.PageTypes.RoomView:e.page_type=this.PageTypes.RoomDirectory),e},componentDidMount:function(){this.dispatcherRef=s.register(this.onAction),this.state.logged_in&&this.startMatrixClient(),this.focusComposer=!1,document.addEventListener("keydown",this.onKeyDown),window.addEventListener("focus",this.onFocus),this.state.logged_in?this.notifyNewScreen(""):this.notifyNewScreen("login"),this.onAliasClick&&(c.onAliasClick=this.onAliasClick),this.onUserClick&&(c.onUserClick=this.onUserClick)},componentWillUnmount:function(){s.unregister(this.dispatcherRef),document.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("focus",this.onFocus)},componentDidUpdate:function(){this.focusComposer&&(s.dispatch({action:"focus_composer"}),this.focusComposer=!1)},onAction:function(e){var t=1,n=a.getComponent("organisms.Notifier"),c=this;switch(e.action){case"logout":window.localStorage&&window.localStorage.clear(),n.stop(),i.stop(),r.get().stopClient(),r.get().removeAllListeners(),r.unset(),this.notifyNewScreen("login"),this.replaceState({logged_in:!1,ready:!1});break;case"start_registration":if(this.state.logged_in)return;var p=e.params||{};p.screen="register",e.params&&e.params.client_secret&&e.params.session_id&&e.params.hs_url&&e.params.is_url&&e.params.sid&&(p.register_client_secret=e.params.client_secret,p.register_session_id=e.params.session_id,p.register_hs_url=e.params.hs_url,p.register_is_url=e.params.is_url,p.register_id_sid=e.params.sid),this.replaceState(p),this.notifyNewScreen("register");break;case"start_login":if(this.state.logged_in)return;this.replaceState({screen:"login"}),this.notifyNewScreen("login");break;case"cas_login":if(this.state.logged_in)return;var c=this,d=r.get(),h=u.getServiceUrl();d.loginWithCas(e.params.ticket,h).done(function(e){r.replaceUsingAccessToken(d.getHomeserverUrl(),d.getIdentityServerUrl(),e.user_id,e.access_token),c.setState({screen:void 0,logged_in:!0}),c.startMatrixClient(),c.notifyNewScreen("")},function(e){c.notifyNewScreen("login"),c.setState({errorText:"Login failed."})});break;case"view_room":this.focusComposer=!0;var p={currentRoom:e.room_id,page_type:this.PageTypes.RoomView};if(this.sdkReady){var m=e.room_id,f=r.get().getRoom(e.room_id);if(f){var g=l.getCanonicalAliasForRoom(f);g&&(m=g)}this.notifyNewScreen("room/"+m),p.ready=!0}this.setState(p);break;case"view_prev_room":t=-1;case"view_next_room":for(var v=o.mostRecentActivityFirst(r.get().getRooms()),y=-1,_=0;_<v.length;++_)if(v[_].roomId==this.state.currentRoom){y=_;break}y=(y+t)%v.length,0>y&&(y=v.length-1),this.focusComposer=!0,this.setState({currentRoom:v[y].roomId}),this.notifyNewScreen("room/"+v[y].roomId);break;case"view_indexed_room":var v=o.mostRecentActivityFirst(r.get().getRooms()),y=e.roomIndex;v[y]&&(this.focusComposer=!0,this.setState({currentRoom:v[y].roomId}),this.notifyNewScreen("room/"+v[y].roomId));break;case"view_room_alias":var E=l.getRoomForAlias(r.get().getRooms(),e.room_alias);if(E)return void s.dispatch({action:"view_room",room_id:E.roomId});r.get().getRoomIdForAlias(e.room_alias).done(function(e){s.dispatch({action:"view_room",room_id:e.room_id})});break;case"view_user_settings":this.setState({page_type:this.PageTypes.UserSettings});break;case"view_create_room":this.setState({page_type:this.PageTypes.CreateRoom});break;case"view_room_directory":this.setState({page_type:this.PageTypes.RoomDirectory});break;case"notifier_enabled":this.forceUpdate();break;case"hide_left_panel":this.setState({collapse_lhs:!0});break;case"show_left_panel":this.setState({collapse_lhs:!1});break;case"hide_right_panel":this.setState({collapse_rhs:!0});break;case"show_right_panel":this.setState({collapse_rhs:!1})}},onLoggedIn:function(){this.setState({screen:void 0,logged_in:!0}),this.startMatrixClient(),this.notifyNewScreen("")},startMatrixClient:function(){var e=a.getComponent("organisms.Notifier"),t=r.get(),n=this;t.on("syncComplete",function(){if(n.sdkReady=!0,n.starting_room_alias)s.dispatch({action:"view_room_alias",room_alias:n.starting_room_alias}),delete n.starting_room_alias;else{if(n.state.currentRoom)n.setState({ready:!0,page_type:n.PageTypes.RoomView});else{var e=null;t.getRooms()&&t.getRooms().length?(e=o.mostRecentActivityFirst(t.getRooms())[0].roomId,n.setState({ready:!0,currentRoom:e,page_type:n.PageTypes.RoomView})):n.setState({ready:!0,page_type:n.PageTypes.RoomDirectory})}var i=n.state.currentRoom,a=r.get().getRoom(n.state.currentRoom);if(a){var c=l.getCanonicalAliasForRoom(a);c&&(i=c)}n.notifyNewScreen("room/"+i),s.dispatch({action:"focus_composer"})}}),t.on("Call.incoming",function(e){s.dispatch({action:"incoming_call",call:e})}),e.start(),i.start(),t.startClient()},onKeyDown:function(e){if(e.altKey){if(e.ctrlKey&&e.keyCode>48&&e.keyCode<58)return s.dispatch({action:"view_indexed_room",roomIndex:e.keyCode-49}),e.stopPropagation(),void e.preventDefault();switch(e.keyCode){case 38:s.dispatch({action:"view_prev_room"}),e.stopPropagation(),e.preventDefault();break;case 40:s.dispatch({action:"view_next_room"}),e.stopPropagation(),e.preventDefault()}}},onFocus:function(e){s.dispatch({action:"focus_composer"})},showScreen:function(e,t){if("register"==e)s.dispatch({action:"start_registration",params:t});else if("login"==e)s.dispatch({action:"start_login",params:t});else if("cas_login"==e)s.dispatch({action:"cas_login",params:t});else if(0==e.indexOf("room/")){var n=e.split("/")[1];"#"==n[0]?this.state.logged_in?s.dispatch({action:"view_room_alias",room_alias:n}):(this.starting_room_alias=n,this.notifyNewScreen("login")):s.dispatch({action:"view_room",room_id:n})}},notifyNewScreen:function(e){this.props.onNewScreen&&this.props.onNewScreen(e)}}},function(e,t,n){"use strict";var r=n(2),o=n(5);e.exports={getInitialState:function(){return{step:"choose_hs",busy:!1,currentStep:0,totalSteps:1}},setStep:function(e){this.setState({step:e,busy:!1})},onHSChosen:function(){r.replaceUsingUrls(this.getHsUrl(),this.getIsUrl()),this.setState({hs_url:this.getHsUrl(),is_url:this.getIsUrl()}),this.setStep("fetch_stages");var e=r.get();this.setState({busy:!0,errorText:""});var t=this;e.loginFlows().done(function(e){t.setState({flows:e.flows,currentStep:1,totalSteps:e.flows.length+1}),t.setStep("stage_"+e.flows[0].type)},function(e){t.setStep("choose_hs"),t.setState({errorText:"Unable to contact the given Home Server"})})},onUserPassEntered:function(e){e.preventDefault(),this.setState({busy:!0,errorText:""});var t=this,n=this.getFormVals(),o={password:n.password};n.username.indexOf("@")>0?(o.medium="email",o.address=n.username):o.user=n.username,r.get().login("m.login.password",o).done(function(e){r.replaceUsingAccessToken(t.state.hs_url,t.state.is_url,e.user_id,e.access_token),t.props.onLoggedIn&&t.props.onLoggedIn()},function(e){t.setStep("stage_m.login.password"),400==e.httpStatus&&o.medium?t.setState({errorText:"This Home Server does not support login using email address."}):403===e.httpStatus?t.setState({errorText:"Incorrect username and/or password."}):t.setState({errorText:"There was a problem logging in. (HTTP "+e.httpStatus+")"})})},showRegister:function(e){e.preventDefault(),o.dispatch({action:"start_registration"})}}},function(e,t,n){(function(t){"use strict";var r=n(2),o=n(5);e.exports={FieldErrors:{PasswordMismatch:"PasswordMismatch",TooShort:"TooShort",Missing:"Missing",InUse:"InUse",Length:"Length"},getInitialState:function(){return{step:"initial",busy:!1,currentStep:0,totalSteps:1}},componentWillMount:function(){this.savedParams={email:"",username:"",password:"",confirmPassword:""},this.readNewProps()},componentWillReceiveProps:function(){this.readNewProps()},readNewProps:function(){if(this.props.clientSecret&&this.props.hsUrl&&this.props.isUrl&&this.props.sessionId&&this.props.idSid){this.authSessionId=this.props.sessionId,r.replaceUsingUrls(this.props.hsUrl,this.props.isUrl),this.setState({hs_url:this.props.hsUrl,is_url:this.props.isUrl}),this.savedParams={client_secret:this.props.clientSecret},this.setState({busy:!0});var e=document.createElement("a");e.href=this.props.isUrl;var t={type:"m.login.email.identity",threepid_creds:{sid:this.props.idSid,client_secret:this.savedParams.client_secret,id_server:e.host}};this.tryRegister(t)}},componentDidUpdate:function(){if(this.refs.recaptchaContainer){var e=document.createElement("script");window.mx_on_recaptcha_loaded=this.onCaptchaLoaded,e.setAttribute("src",t.location.protocol+"//www.google.com/recaptcha/api.js?onload=mx_on_recaptcha_loaded&render=explicit"),this.refs.recaptchaContainer.getDOMNode().appendChild(e)}},setStep:function(e){this.setState({step:e,errorText:"",busy:!1})},getSupportedStageTypes:function(){return["m.login.email.identity","m.login.recaptcha"]},chooseFlow:function(e){for(var t=this.getSupportedStageTypes(),n=null,r=null,o=0;o<e.length;++o){for(var i=e[o],s=!1,a=!0,l=0;l<i.stages.length;++l){var c=i.stages[l];-1==t.indexOf(c)&&(a=!1),"m.login.email.identity"==c&&(s=!0)}a&&(s?n=i:r=i)}return""!=this.savedParams.email||this.completedStages.indexOf("m.login.email.identity")>-1?n:r},firstUncompletedStageIndex:function(e){if(void 0===this.completedStages)return 0;for(var t=0;t<e.stages.length;++t)if(-1==this.completedStages.indexOf(e.stages[t]))return t},numCompletedStages:function(e){if(void 0===this.completedStages)return 0;for(var t=0,n=0;n<e.stages.length;++n)this.completedStages.indexOf(e.stages[n])>-1&&++t;return t},onInitialStageSubmit:function(e){e.preventDefault();var t=this.getRegFormVals();this.savedParams=t;var n={};return t.password!=t.confirmPassword&&(n.confirmPassword=this.FieldErrors.PasswordMismatch),""==t.password?n.password=this.FieldErrors.Missing:t.password.length<6&&(n.password=this.FieldErrors.Length),""==t.username&&(n.username=this.FieldErrors.Missing),Object.keys(n).length>0?void this.onBadFields(n):(r.replaceUsingUrls(this.getHsUrl(),this.getIsUrl()),this.setState({hs_url:this.getHsUrl(),is_url:this.getIsUrl()}),this.setState({busy:!0}),void this.tryRegister())},startStage:function(e){var t=this;switch(this.setStep("stage_"+e),e){case"m.login.email.identity":t.setState({busy:!0});var n=r.get();this.savedParams.client_secret=n.generateClientSecret(),this.savedParams.send_attempt=1;var o=this.props.registrationUrl+"?client_secret="+encodeURIComponent(this.savedParams.client_secret)+"&hs_url="+encodeURIComponent(this.state.hs_url)+"&is_url="+encodeURIComponent(this.state.is_url)+"&session_id="+encodeURIComponent(this.authSessionId);n.requestEmailToken(this.savedParams.email,this.savedParams.client_secret,this.savedParams.send_attempt,o).done(function(e){t.setState({busy:!1}),t.setStep("stage_m.login.email.identity")},function(e){t.setStep("initial");var n={busy:!1};"THREEPID_IN_USE"==e.errcode?t.onBadFields({email:t.FieldErrors.InUse}):n.errorText="Unable to contact the given Home Server",t.setState(n)});break;case"m.login.recaptcha":this.authParams&&this.authParams["m.login.recaptcha"].public_key||this.setState({errorText:"This server has not supplied enough information for Recaptcha authentication"})}},onRegistered:function(e,t){r.replaceUsingAccessToken(this.state.hs_url,this.state.is_url,e,t),this.props.onLoggedIn&&this.props.onLoggedIn()},onCaptchaLoaded:function(){if(this.refs.recaptchaContainer){var e=this.authParams["m.login.recaptcha"].public_key;t.grecaptcha.render("mx_recaptcha",{sitekey:e,callback:this.onCaptchaDone})}},onCaptchaDone:function(e){this.tryRegister({type:"m.login.recaptcha",response:e})},tryRegister:function(e){var t=this;r.get().register(this.savedParams.username,this.savedParams.password,this.authSessionId,e).done(function(e){t.onRegistered(e.user_id,e.access_token)},function(e){if(401==e.httpStatus&&e.data.flows){t.authParams=e.data.params,t.authSessionId=e.data.session,t.completedStages=e.data.completed||[];var n=t.chooseFlow(e.data.flows),r=t.firstUncompletedStageIndex(n),o=t.numCompletedStages(n);t.setState({busy:!1,flows:n,currentStep:1+o,totalSteps:n.stages.length+1,flowStage:r}),t.startStage(n.stages[r])}else{t.setStep("initial");var i={busy:!1,errorText:"Unable to contact the given Home Server"};"M_USER_IN_USE"==e.name?(delete i.errorText,t.onBadFields({username:t.FieldErrors.InUse})):401==e.httpStatus?i.errorText="Authorisation failed!":e.httpStatus>=400&&e.httpStatus<500?i.errorText="Registration failed!":e.httpStatus>=500&&e.httpStatus<600?i.errorText="Server error during registration!":"M_MISSING_PARAM"==e.name&&(i.errorText="This home server does not support resuming registration."),t.setState(i)}})},showLogin:function(e){e.preventDefault(),o.dispatch({action:"start_login"})}}}).call(t,function(){return this}())},function(e,t,n){var r,o;!function(i,s){"object"==typeof e&&e.exports?e.exports=s():(r=s,o="function"==typeof r?r.call(t,n,t,e):r,!(void 0!==o&&(e.exports=o)))}(this,function(){"use strict";function e(e,t){var n,r=document.createElement(e||"div");for(n in t)r[n]=t[n];return r}function t(e){for(var t=1,n=arguments.length;n>t;t++)e.appendChild(arguments[t]);return e}function n(e,t,n,r){var o=["opacity",t,~~(100*e),n,r].join("-"),i=.01+n/r*100,s=Math.max(1-(1-e)/t*(100-i),e),a=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=a&&"-"+a+"-"||"";return d[o]||(u.insertRule("@"+l+"keyframes "+o+"{0%{opacity:"+s+"}"+i+"%{opacity:"+e+"}"+(i+.01)+"%{opacity:1}"+(i+t)%100+"%{opacity:"+e+"}100%{opacity:"+s+"}}",u.cssRules.length),d[o]=1),o}function r(e,t){var n,r,o=e.style;if(t=t.charAt(0).toUpperCase()+t.slice(1),void 0!==o[t])return t;for(r=0;r<p.length;r++)if(n=p[r]+t,void 0!==o[n])return n}function o(e,t){for(var n in t)e.style[r(e,n)||n]=t[n];return e}function i(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)void 0===e[r]&&(e[r]=n[r])}return e}function s(e,t){return"string"==typeof e?e:e[t%e.length]}function a(e){this.opts=i(e||{},a.defaults,h)}function l(){function n(t,n){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}u.addRule(".spin-vml","behavior:url(#default#VML)"),a.prototype.lines=function(e,r){function i(){return o(n("group",{coordsize:u+" "+u,coordorigin:-c+" "+-c}),{width:u,height:u})}function a(e,a,l){t(d,t(o(i(),{rotation:360/r.lines*e+"deg",left:~~a}),t(o(n("roundrect",{arcsize:r.corners}),{width:c,height:r.scale*r.width,left:r.scale*r.radius,top:-r.scale*r.width>>1,filter:l}),n("fill",{color:s(r.color,e),opacity:r.opacity}),n("stroke",{opacity:0}))))}var l,c=r.scale*(r.length+r.width),u=2*r.scale*c,p=-(r.width+r.length)*r.scale*2+"px",d=o(i(),{position:"absolute",top:p,left:p});if(r.shadow)for(l=1;l<=r.lines;l++)a(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=r.lines;l++)a(l);return t(e,d)},a.prototype.opacity=function(e,t,n,r){var o=e.firstChild;r=r.shadow&&r.lines||0,o&&t+r<o.childNodes.length&&(o=o.childNodes[t+r],o=o&&o.firstChild,o=o&&o.firstChild,o&&(o.opacity=n))}}var c,u,p=["webkit","Moz","ms","O"],d={},h={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};if(a.defaults={},i(a.prototype,{spin:function(t){this.stop();var n=this,r=n.opts,i=n.el=e(null,{className:r.className});if(o(i,{position:r.position,width:0,zIndex:r.zIndex,left:r.left,top:r.top}),t&&t.insertBefore(i,t.firstChild||null),i.setAttribute("role","progressbar"),n.lines(i,n.opts),!c){var s,a=0,l=(r.lines-1)*(1-r.direction)/2,u=r.fps,p=u/r.speed,d=(1-r.opacity)/(p*r.trail/100),h=p/r.lines;!function m(){a++;for(var e=0;e<r.lines;e++)s=Math.max(1-(a+(r.lines-e)*h)%p*d,r.opacity),n.opacity(i,e*r.direction+l,s,r);n.timeout=n.el&&setTimeout(m,~~(1e3/u))}()}return n},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(r,i){function a(t,n){return o(e(),{position:"absolute",width:i.scale*(i.length+i.width)+"px",height:i.scale*i.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/i.lines*u+i.rotate)+"deg) translate("+i.scale*i.radius+"px,0)",borderRadius:(i.corners*i.scale*i.width>>1)+"px"})}for(var l,u=0,p=(i.lines-1)*(1-i.direction)/2;u<i.lines;u++)l=o(e(),{position:"absolute",top:1+~(i.scale*i.width/2)+"px",transform:i.hwaccel?"translate3d(0,0,0)":"",opacity:i.opacity,animation:c&&n(i.opacity,i.trail,p+u*i.direction,i.lines)+" "+1/i.speed+"s linear infinite"}),i.shadow&&t(l,o(a("#000","0 0 4px #000"),{top:"2px"})),t(r,t(l,a(s(i.color,u),"0 0 1px rgba(0,0,0,.1)")));return r},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}}),"undefined"!=typeof document){u=function(){var n=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}();var m=o(e("group"),{behavior:"url(#default#VML)"});!r(m,"transform")&&m.adj?l():c=r(m,"animation")}return a})},function(e,t,n){"use strict";function r(){var e=window.opera;return"object"==typeof e&&"function"==typeof e.version&&parseInt(e.version(),10)<=12}function o(e){return(e.ctrlKey||e.altKey||e.metaKey)&&!(e.ctrlKey&&e.altKey)}function i(e){switch(e){case I.topCompositionStart:return k.compositionStart;case I.topCompositionEnd:return k.compositionEnd;case I.topCompositionUpdate:return k.compositionUpdate}}function s(e,t){return e===I.topKeyDown&&t.keyCode===b}function a(e,t){switch(e){case I.topKeyUp:return-1!==E.indexOf(t.keyCode);case I.topKeyDown:return t.keyCode!==b;case I.topKeyPress:case I.topMouseDown:case I.topBlur:return!0;default:return!1}}function l(e){var t=e.detail;return"object"==typeof t&&"data"in t?t.data:null}function c(e,t,n,r){var o,c;if(C?o=i(e):N?a(e,r)&&(o=k.compositionEnd):s(e,r)&&(o=k.compositionStart),!o)return null;S&&(N||o!==k.compositionStart?o===k.compositionEnd&&N&&(c=N.getData()):N=g.getPooled(t));var u=v.getPooled(o,n,r);if(c)u.data=c;else{var p=l(r);null!==p&&(u.data=p)}return m.accumulateTwoPhaseDispatches(u),u}function u(e,t){switch(e){case I.topCompositionEnd:return l(t);case I.topKeyPress:var n=t.which;return n!==T?null:(M=!0,R);case I.topTextInput:var r=t.data;return r===R&&M?null:r;default:return null}}function p(e,t){if(N){if(e===I.topCompositionEnd||a(e,t)){var n=N.getData();return g.release(N),N=null,n}return null}switch(e){case I.topPaste:return null;case I.topKeyPress:return t.which&&!o(t)?String.fromCharCode(t.which):null;case I.topCompositionEnd:return S?null:t.data;default:return null}}function d(e,t,n,r){var o;if(o=w?u(e,r):p(e,r),!o)return null;var i=y.getPooled(k.beforeInput,n,r);return i.data=o,m.accumulateTwoPhaseDispatches(i),i}var h=n(12),m=n(36),f=n(9),g=n(259),v=n(293),y=n(296),_=n(22),E=[9,13,27,32],b=229,C=f.canUseDOM&&"CompositionEvent"in window,x=null;f.canUseDOM&&"documentMode"in document&&(x=document.documentMode);var w=f.canUseDOM&&"TextEvent"in window&&!x&&!r(),S=f.canUseDOM&&(!C||x&&x>8&&11>=x),T=32,R=String.fromCharCode(T),I=h.topLevelTypes,k={beforeInput:{phasedRegistrationNames:{bubbled:_({onBeforeInput:null}),captured:_({onBeforeInputCapture:null})},dependencies:[I.topCompositionEnd,I.topKeyPress,I.topTextInput,I.topPaste]},compositionEnd:{phasedRegistrationNames:{bubbled:_({onCompositionEnd:null}),captured:_({onCompositionEndCapture:null})},dependencies:[I.topBlur,I.topCompositionEnd,I.topKeyDown,I.topKeyPress,I.topKeyUp,I.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:_({onCompositionStart:null
}),captured:_({onCompositionStartCapture:null})},dependencies:[I.topBlur,I.topCompositionStart,I.topKeyDown,I.topKeyPress,I.topKeyUp,I.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:_({onCompositionUpdate:null}),captured:_({onCompositionUpdateCapture:null})},dependencies:[I.topBlur,I.topCompositionUpdate,I.topKeyDown,I.topKeyPress,I.topKeyUp,I.topMouseDown]}},M=!1,N=null,D={eventTypes:k,extractEvents:function(e,t,n,r){return[c(e,t,n,r),d(e,t,n,r)]}};e.exports=D},function(e,t,n){"use strict";function r(e){return"SELECT"===e.nodeName||"INPUT"===e.nodeName&&"file"===e.type}function o(e){var t=x.getPooled(I.change,M,e);E.accumulateTwoPhaseDispatches(t),C.batchedUpdates(i,t)}function i(e){_.enqueueEvents(e),_.processEventQueue()}function s(e,t){k=e,M=t,k.attachEvent("onchange",o)}function a(){k&&(k.detachEvent("onchange",o),k=null,M=null)}function l(e,t,n){return e===R.topChange?n:void 0}function c(e,t,n){e===R.topFocus?(a(),s(t,n)):e===R.topBlur&&a()}function u(e,t){k=e,M=t,N=e.value,D=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(k,"value",U),k.attachEvent("onpropertychange",d)}function p(){k&&(delete k.value,k.detachEvent("onpropertychange",d),k=null,M=null,N=null,D=null)}function d(e){if("value"===e.propertyName){var t=e.srcElement.value;t!==N&&(N=t,o(e))}}function h(e,t,n){return e===R.topInput?n:void 0}function m(e,t,n){e===R.topFocus?(p(),u(t,n)):e===R.topBlur&&p()}function f(e,t,n){return e!==R.topSelectionChange&&e!==R.topKeyUp&&e!==R.topKeyDown||!k||k.value===N?void 0:(N=k.value,M)}function g(e){return"INPUT"===e.nodeName&&("checkbox"===e.type||"radio"===e.type)}function v(e,t,n){return e===R.topClick?n:void 0}var y=n(12),_=n(35),E=n(36),b=n(9),C=n(15),x=n(25),w=n(80),S=n(119),T=n(22),R=y.topLevelTypes,I={change:{phasedRegistrationNames:{bubbled:T({onChange:null}),captured:T({onChangeCapture:null})},dependencies:[R.topBlur,R.topChange,R.topClick,R.topFocus,R.topInput,R.topKeyDown,R.topKeyUp,R.topSelectionChange]}},k=null,M=null,N=null,D=null,A=!1;b.canUseDOM&&(A=w("change")&&(!("documentMode"in document)||document.documentMode>8));var P=!1;b.canUseDOM&&(P=w("input")&&(!("documentMode"in document)||document.documentMode>9));var U={get:function(){return D.get.call(this)},set:function(e){N=""+e,D.set.call(this,e)}},O={eventTypes:I,extractEvents:function(e,t,n,o){var i,s;if(r(t)?A?i=l:s=c:S(t)?P?i=h:(i=f,s=m):g(t)&&(i=v),i){var a=i(e,t,n);if(a){var u=x.getPooled(I.change,a,o);return E.accumulateTwoPhaseDispatches(u),u}}s&&s(e,t,n)}};e.exports=O},function(e,t){"use strict";var n=0,r={createReactRootIndex:function(){return n++}};e.exports=r},function(e,t,n){"use strict";function r(e,t,n){e.insertBefore(t,e.childNodes[n]||null)}var o=n(255),i=n(106),s=n(319),a=n(4),l={dangerouslyReplaceNodeWithMarkup:o.dangerouslyReplaceNodeWithMarkup,updateTextContent:s,processUpdates:function(e,t){for(var n,l=null,c=null,u=0;u<e.length;u++)if(n=e[u],n.type===i.MOVE_EXISTING||n.type===i.REMOVE_NODE){var p=n.fromIndex,d=n.parentNode.childNodes[p],h=n.parentID;a(d),l=l||{},l[h]=l[h]||[],l[h][p]=d,c=c||[],c.push(d)}var m=o.dangerouslyRenderMarkup(t);if(c)for(var f=0;f<c.length;f++)c[f].parentNode.removeChild(c[f]);for(var g=0;g<e.length;g++)switch(n=e[g],n.type){case i.INSERT_MARKUP:r(n.parentNode,m[n.markupIndex],n.toIndex);break;case i.MOVE_EXISTING:r(n.parentNode,l[n.parentID][n.fromIndex],n.toIndex);break;case i.TEXT_CONTENT:s(n.parentNode,n.textContent);break;case i.REMOVE_NODE:}}};e.exports=l},function(e,t,n){"use strict";function r(e){return e.substring(1,e.indexOf(" "))}var o=n(9),i=n(305),s=n(21),a=n(116),l=n(4),c=/^(<[^ \/>]+)/,u="data-danger-index",p={dangerouslyRenderMarkup:function(e){l(o.canUseDOM);for(var t,n={},p=0;p<e.length;p++)l(e[p]),t=r(e[p]),t=a(t)?t:"*",n[t]=n[t]||[],n[t][p]=e[p];var d=[],h=0;for(t in n)if(n.hasOwnProperty(t)){var m,f=n[t];for(m in f)if(f.hasOwnProperty(m)){var g=f[m];f[m]=g.replace(c,"$1 "+u+'="'+m+'" ')}for(var v=i(f.join(""),s),y=0;y<v.length;++y){var _=v[y];_.hasAttribute&&_.hasAttribute(u)&&(m=+_.getAttribute(u),_.removeAttribute(u),l(!d.hasOwnProperty(m)),d[m]=_,h+=1)}}return l(h===d.length),l(d.length===e.length),d},dangerouslyReplaceNodeWithMarkup:function(e,t){l(o.canUseDOM),l(t),l("html"!==e.tagName.toLowerCase());var n=i(t,s)[0];e.parentNode.replaceChild(n,e)}};e.exports=p},function(e,t,n){"use strict";var r=n(22),o=[r({ResponderEventPlugin:null}),r({SimpleEventPlugin:null}),r({TapEventPlugin:null}),r({EnterLeaveEventPlugin:null}),r({ChangeEventPlugin:null}),r({SelectEventPlugin:null}),r({BeforeInputEventPlugin:null}),r({AnalyticsEventPlugin:null}),r({MobileSafariClickEventPlugin:null})];e.exports=o},function(e,t,n){"use strict";var r=n(12),o=n(36),i=n(48),s=n(19),a=n(22),l=r.topLevelTypes,c=s.getFirstReactDOM,u={mouseEnter:{registrationName:a({onMouseEnter:null}),dependencies:[l.topMouseOut,l.topMouseOver]},mouseLeave:{registrationName:a({onMouseLeave:null}),dependencies:[l.topMouseOut,l.topMouseOver]}},p=[null,null],d={eventTypes:u,extractEvents:function(e,t,n,r){if(e===l.topMouseOver&&(r.relatedTarget||r.fromElement))return null;if(e!==l.topMouseOut&&e!==l.topMouseOver)return null;var a;if(t.window===t)a=t;else{var d=t.ownerDocument;a=d?d.defaultView||d.parentWindow:window}var h,m;if(e===l.topMouseOut?(h=t,m=c(r.relatedTarget||r.toElement)||a):(h=a,m=t),h===m)return null;var f=h?s.getID(h):"",g=m?s.getID(m):"",v=i.getPooled(u.mouseLeave,f,r);v.type="mouseleave",v.target=h,v.relatedTarget=m;var y=i.getPooled(u.mouseEnter,g,r);return y.type="mouseenter",y.target=m,y.relatedTarget=h,o.accumulateEnterLeaveDispatches(v,y,f,g),p[0]=v,p[1]=y,p}};e.exports=d},function(e,t,n){var r=n(21),o={listen:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}}):e.attachEvent?(e.attachEvent("on"+t,n),{remove:function(){e.detachEvent("on"+t,n)}}):void 0},capture:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!0),{remove:function(){e.removeEventListener(t,n,!0)}}):{remove:r}},registerDefault:function(){}};e.exports=o},function(e,t,n){"use strict";function r(e){this._root=e,this._startText=this.getText(),this._fallbackText=null}var o=n(16),i=n(6),s=n(117);i(r.prototype,{getText:function(){return"value"in this._root?this._root.value:this._root[s()]},getData:function(){if(this._fallbackText)return this._fallbackText;var e,t,n=this._startText,r=n.length,o=this.getText(),i=o.length;for(e=0;r>e&&n[e]===o[e];e++);var s=r-e;for(t=1;s>=t&&n[r-t]===o[i-t];t++);var a=t>1?1-t:void 0;return this._fallbackText=o.slice(e,a),this._fallbackText}}),o.addPoolingTo(r),e.exports=r},function(e,t,n){"use strict";var r,o=n(27),i=n(9),s=o.injection.MUST_USE_ATTRIBUTE,a=o.injection.MUST_USE_PROPERTY,l=o.injection.HAS_BOOLEAN_VALUE,c=o.injection.HAS_SIDE_EFFECTS,u=o.injection.HAS_NUMERIC_VALUE,p=o.injection.HAS_POSITIVE_NUMERIC_VALUE,d=o.injection.HAS_OVERLOADED_BOOLEAN_VALUE;if(i.canUseDOM){var h=document.implementation;r=h&&h.hasFeature&&h.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}var m={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,acceptCharset:null,accessKey:null,action:null,allowFullScreen:s|l,allowTransparency:s,alt:null,async:l,autoComplete:null,autoPlay:l,cellPadding:null,cellSpacing:null,charSet:s,checked:a|l,classID:s,className:r?s:a,cols:s|p,colSpan:null,content:null,contentEditable:null,contextMenu:s,controls:a|l,coords:null,crossOrigin:null,data:null,dateTime:s,defer:l,dir:null,disabled:s|l,download:d,draggable:null,encType:null,form:s,formAction:s,formEncType:s,formMethod:s,formNoValidate:l,formTarget:s,frameBorder:s,headers:null,height:s,hidden:s|l,high:null,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:a,label:null,lang:null,list:s,loop:a|l,low:null,manifest:s,marginHeight:null,marginWidth:null,max:null,maxLength:s,media:s,mediaGroup:null,method:null,min:null,multiple:a|l,muted:a|l,name:null,noValidate:l,open:l,optimum:null,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:a|l,rel:null,required:l,role:s,rows:s|p,rowSpan:null,sandbox:null,scope:null,scoped:l,scrolling:null,seamless:s|l,selected:a|l,shape:null,size:s|p,sizes:s,span:p,spellCheck:null,src:null,srcDoc:a,srcSet:s,start:u,step:null,style:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:a|c,width:s,wmode:s,autoCapitalize:null,autoCorrect:null,itemProp:s,itemScope:s|l,itemType:s,itemID:s,itemRef:s,property:null,unselectable:s},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};e.exports=m},function(e,t,n){"use strict";var r=n(12),o=n(21),i=r.topLevelTypes,s={eventTypes:null,extractEvents:function(e,t,n,r){if(e===i.topTouchStart){var s=r.target;s&&!s.onclick&&(s.onclick=o)}}};e.exports=s},function(e,t,n){"use strict";var r=n(63),o=n(264),i=n(101),s=n(13),a=n(68),l=n(18),c=n(7),u=(n(37),n(266)),p=n(103),d=n(277),h=n(29),m=n(19),f=n(24),g=n(107),v=n(31),y=n(286),_=n(6),E=n(112),b=n(317);d.inject();var C=c.createElement,x=c.createFactory,w=c.cloneElement,S=f.measure("React","render",m.render),T={Children:{map:o.map,forEach:o.forEach,count:o.count,only:b},Component:i,DOM:u,PropTypes:g,initializeTouchEvents:function(e){r.useTouchEvents=e},createClass:s.createClass,createElement:C,cloneElement:w,createFactory:x,createMixin:function(e){return e},constructAndRenderComponent:m.constructAndRenderComponent,constructAndRenderComponentByID:m.constructAndRenderComponentByID,findDOMNode:E,render:S,renderToString:y.renderToString,renderToStaticMarkup:y.renderToStaticMarkup,unmountComponentAtNode:m.unmountComponentAtNode,isValidElement:c.isValidElement,withContext:a.withContext,__spread:_};"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.inject&&__REACT_DEVTOOLS_GLOBAL_HOOK__.inject({CurrentOwner:l,InstanceHandles:h,Mount:m,Reconciler:v,TextComponent:p});T.version="0.13.3",e.exports=T},function(e,t,n){"use strict";var r=n(31),o=n(307),i=n(79),s=n(82),a={instantiateChildren:function(e,t,n){var r=o(e);for(var s in r)if(r.hasOwnProperty(s)){var a=r[s],l=i(a,null);r[s]=l}return r},updateChildren:function(e,t,n,a){var l=o(t);if(!l&&!e)return null;var c;for(c in l)if(l.hasOwnProperty(c)){var u=e&&e[c],p=u&&u._currentElement,d=l[c];if(s(p,d))r.receiveComponent(u,d,n,a),l[c]=u;else{u&&r.unmountComponent(u,c);var h=i(d,null);l[c]=h}}for(c in e)!e.hasOwnProperty(c)||l&&l.hasOwnProperty(c)||r.unmountComponent(e[c]);return l},unmountChildren:function(e){for(var t in e){var n=e[t];r.unmountComponent(n)}}};e.exports=a},function(e,t,n){"use strict";function r(e,t){this.forEachFunction=e,this.forEachContext=t}function o(e,t,n,r){var o=e;o.forEachFunction.call(o.forEachContext,t,r)}function i(e,t,n){if(null==e)return e;var i=r.getPooled(t,n);h(e,o,i),r.release(i)}function s(e,t,n){this.mapResult=e,this.mapFunction=t,this.mapContext=n}function a(e,t,n,r){var o=e,i=o.mapResult,s=!i.hasOwnProperty(n);if(s){var a=o.mapFunction.call(o.mapContext,t,r);i[n]=a}}function l(e,t,n){if(null==e)return e;var r={},o=s.getPooled(r,t,n);return h(e,a,o),s.release(o),d.create(r)}function c(e,t,n,r){return null}function u(e,t){return h(e,c,null)}var p=n(16),d=n(45),h=n(120),m=(n(8),p.twoArgumentPooler),f=p.threeArgumentPooler;p.addPoolingTo(r,m),p.addPoolingTo(s,f);var g={forEach:i,map:l,count:u};e.exports=g},function(e,t,n){"use strict";function r(e){var t=e._currentElement._owner||null;if(t){var n=t.getName();if(n)return" Check the render method of `"+n+"`."}return""}var o=n(67),i=n(68),s=n(18),a=n(7),l=(n(37),n(30)),c=n(71),u=n(46),p=n(24),d=n(72),h=(n(47),n(31)),m=n(15),f=n(6),g=n(50),v=n(4),y=n(82),_=(n(8),1),E={construct:function(e){this._currentElement=e,this._rootNodeID=null,this._instance=null,this._pendingElement=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._renderedComponent=null,this._context=null,this._mountOrder=0,this._isTopLevel=!1,this._pendingCallbacks=null},mountComponent:function(e,t,n){this._context=n,this._mountOrder=_++,this._rootNodeID=e;var r=this._processProps(this._currentElement.props),o=this._processContext(this._currentElement._context),i=u.getComponentClassForElement(this._currentElement),s=new i(r,o);s.props=r,s.context=o,s.refs=g,this._instance=s,l.set(s,this);var a=s.state;void 0===a&&(s.state=a=null),v("object"==typeof a&&!Array.isArray(a)),this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1;var p,d,m=c.currentlyMountingInstance;c.currentlyMountingInstance=this;try{s.componentWillMount&&(s.componentWillMount(),this._pendingStateQueue&&(s.state=this._processPendingState(s.props,s.context))),p=this._getValidatedChildContext(n),d=this._renderValidatedComponent(p)}finally{c.currentlyMountingInstance=m}this._renderedComponent=this._instantiateReactComponent(d,this._currentElement.type);var f=h.mountComponent(this._renderedComponent,e,t,this._mergeChildContext(n,p));return s.componentDidMount&&t.getReactMountReady().enqueue(s.componentDidMount,s),f},unmountComponent:function(){var e=this._instance;if(e.componentWillUnmount){var t=c.currentlyUnmountingInstance;c.currentlyUnmountingInstance=this;try{e.componentWillUnmount()}finally{c.currentlyUnmountingInstance=t}}h.unmountComponent(this._renderedComponent),this._renderedComponent=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._pendingCallbacks=null,this._pendingElement=null,this._context=null,this._rootNodeID=null,l.remove(e)},_setPropsInternal:function(e,t){var n=this._pendingElement||this._currentElement;this._pendingElement=a.cloneAndReplaceProps(n,f({},n.props,e)),m.enqueueUpdate(this,t)},_maskContext:function(e){var t=null;if("string"==typeof this._currentElement.type)return g;var n=this._currentElement.type.contextTypes;if(!n)return g;t={};for(var r in n)t[r]=e[r];return t},_processContext:function(e){var t=this._maskContext(e);return t},_getValidatedChildContext:function(e){var t=this._instance,n=t.getChildContext&&t.getChildContext();if(n){v("object"==typeof t.constructor.childContextTypes);for(var r in n)v(r in t.constructor.childContextTypes);return n}return null},_mergeChildContext:function(e,t){return t?f({},e,t):e},_processProps:function(e){return e},_checkPropTypes:function(e,t,n){var o=this.getName();for(var i in e)if(e.hasOwnProperty(i)){var s;try{v("function"==typeof e[i]),s=e[i](t,i,o,n)}catch(a){s=a}if(s instanceof Error){r(this);n===d.prop}}},receiveComponent:function(e,t,n){var r=this._currentElement,o=this._context;this._pendingElement=null,this.updateComponent(t,r,e,o,n)},performUpdateIfNecessary:function(e){null!=this._pendingElement&&h.receiveComponent(this,this._pendingElement||this._currentElement,e,this._context),(null!==this._pendingStateQueue||this._pendingForceUpdate)&&this.updateComponent(e,this._currentElement,this._currentElement,this._context,this._context)},_warnIfContextsDiffer:function(e,t){e=this._maskContext(e),t=this._maskContext(t);for(var n=Object.keys(t).sort(),r=(this.getName()||"ReactCompositeComponent",0);r<n.length;r++){n[r]}},updateComponent:function(e,t,n,r,o){var i=this._instance,s=i.context,a=i.props;t!==n&&(s=this._processContext(n._context),a=this._processProps(n.props),i.componentWillReceiveProps&&i.componentWillReceiveProps(a,s));var l=this._processPendingState(a,s),c=this._pendingForceUpdate||!i.shouldComponentUpdate||i.shouldComponentUpdate(a,l,s);c?(this._pendingForceUpdate=!1,this._performComponentUpdate(n,a,l,s,e,o)):(this._currentElement=n,this._context=o,i.props=a,i.state=l,i.context=s)},_processPendingState:function(e,t){var n=this._instance,r=this._pendingStateQueue,o=this._pendingReplaceState;if(this._pendingReplaceState=!1,this._pendingStateQueue=null,!r)return n.state;if(o&&1===r.length)return r[0];for(var i=f({},o?r[0]:n.state),s=o?1:0;s<r.length;s++){var a=r[s];f(i,"function"==typeof a?a.call(n,i,e,t):a)}return i},_performComponentUpdate:function(e,t,n,r,o,i){var s=this._instance,a=s.props,l=s.state,c=s.context;s.componentWillUpdate&&s.componentWillUpdate(t,n,r),this._currentElement=e,this._context=i,s.props=t,s.state=n,s.context=r,this._updateRenderedComponent(o,i),s.componentDidUpdate&&o.getReactMountReady().enqueue(s.componentDidUpdate.bind(s,a,l,c),s)},_updateRenderedComponent:function(e,t){var n=this._renderedComponent,r=n._currentElement,o=this._getValidatedChildContext(),i=this._renderValidatedComponent(o);if(y(r,i))h.receiveComponent(n,i,e,this._mergeChildContext(t,o));else{var s=this._rootNodeID,a=n._rootNodeID;h.unmountComponent(n),this._renderedComponent=this._instantiateReactComponent(i,this._currentElement.type);var l=h.mountComponent(this._renderedComponent,s,e,this._mergeChildContext(t,o));this._replaceNodeWithMarkupByID(a,l)}},_replaceNodeWithMarkupByID:function(e,t){o.replaceNodeWithMarkupByID(e,t)},_renderValidatedComponentWithoutOwnerOrContext:function(){var e=this._instance,t=e.render();return t},_renderValidatedComponent:function(e){var t,n=i.current;i.current=this._mergeChildContext(this._currentElement._context,e),s.current=this;try{t=this._renderValidatedComponentWithoutOwnerOrContext()}finally{i.current=n,s.current=null}return v(null===t||t===!1||a.isValidElement(t)),t},attachRef:function(e,t){var n=this.getPublicInstance(),r=n.refs===g?n.refs={}:n.refs;r[e]=t.getPublicInstance()},detachRef:function(e){var t=this.getPublicInstance().refs;delete t[e]},getName:function(){var e=this._currentElement.type,t=this._instance&&this._instance.constructor;return e.displayName||t&&t.displayName||e.name||t&&t.name||null},getPublicInstance:function(){return this._instance},_instantiateReactComponent:null};p.measureMethods(E,"ReactCompositeComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent",_renderValidatedComponent:"_renderValidatedComponent"});var b={Mixin:E};e.exports=b},function(e,t,n){"use strict";function r(e){return o.createFactory(e)}var o=n(7),i=(n(37),n(315)),s=i({a:"a",abbr:"abbr",address:"address",area:"area",article:"article",aside:"aside",audio:"audio",b:"b",base:"base",bdi:"bdi",bdo:"bdo",big:"big",blockquote:"blockquote",body:"body",br:"br",button:"button",canvas:"canvas",caption:"caption",cite:"cite",code:"code",col:"col",colgroup:"colgroup",data:"data",datalist:"datalist",dd:"dd",del:"del",details:"details",dfn:"dfn",dialog:"dialog",div:"div",dl:"dl",dt:"dt",em:"em",embed:"embed",fieldset:"fieldset",figcaption:"figcaption",figure:"figure",footer:"footer",form:"form",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",ins:"ins",kbd:"kbd",keygen:"keygen",label:"label",legend:"legend",li:"li",link:"link",main:"main",map:"map",mark:"mark",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",nav:"nav",noscript:"noscript",object:"object",ol:"ol",optgroup:"optgroup",option:"option",output:"output",p:"p",param:"param",picture:"picture",pre:"pre",progress:"progress",q:"q",rp:"rp",rt:"rt",ruby:"ruby",s:"s",samp:"samp",script:"script",section:"section",select:"select",small:"small",source:"source",span:"span",strong:"strong",style:"style",sub:"sub",summary:"summary",sup:"sup",table:"table",tbody:"tbody",td:"td",textarea:"textarea",tfoot:"tfoot",th:"th",thead:"thead",time:"time",title:"title",tr:"tr",track:"track",u:"u",ul:"ul","var":"var",video:"video",wbr:"wbr",circle:"circle",clipPath:"clipPath",defs:"defs",ellipse:"ellipse",g:"g",line:"line",linearGradient:"linearGradient",mask:"mask",path:"path",pattern:"pattern",polygon:"polygon",polyline:"polyline",radialGradient:"radialGradient",rect:"rect",stop:"stop",svg:"svg",text:"text",tspan:"tspan"},r);e.exports=s},function(e,t,n){"use strict";var r=n(44),o=n(17),i=n(13),s=n(7),a=n(39),l=s.createFactory("button"),c=a({onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0}),u=i.createClass({displayName:"ReactDOMButton",tagName:"BUTTON",mixins:[r,o],render:function(){var e={};for(var t in this.props)!this.props.hasOwnProperty(t)||this.props.disabled&&c[t]||(e[t]=this.props[t]);return l(e,this.props.children)}});e.exports=u},function(e,t,n){"use strict";var r=n(12),o=n(65),i=n(17),s=n(13),a=n(7),l=a.createFactory("form"),c=s.createClass({displayName:"ReactDOMForm",tagName:"FORM",mixins:[i,o],render:function(){return l(this.props)},componentDidMount:function(){this.trapBubbledEvent(r.topLevelTypes.topReset,"reset"),this.trapBubbledEvent(r.topLevelTypes.topSubmit,"submit")}});e.exports=c},function(e,t,n){"use strict";var r=n(12),o=n(65),i=n(17),s=n(13),a=n(7),l=a.createFactory("iframe"),c=s.createClass({displayName:"ReactDOMIframe",tagName:"IFRAME",mixins:[i,o],render:function(){return l(this.props)},componentDidMount:function(){this.trapBubbledEvent(r.topLevelTypes.topLoad,"load")}});e.exports=c},function(e,t,n){"use strict";var r=n(12),o=n(65),i=n(17),s=n(13),a=n(7),l=a.createFactory("img"),c=s.createClass({displayName:"ReactDOMImg",tagName:"IMG",mixins:[i,o],render:function(){return l(this.props)},componentDidMount:function(){this.trapBubbledEvent(r.topLevelTypes.topLoad,"load"),this.trapBubbledEvent(r.topLevelTypes.topError,"error")}});e.exports=c},function(e,t,n){"use strict";function r(){this.isMounted()&&this.forceUpdate()}var o=n(44),i=n(34),s=n(64),a=n(17),l=n(13),c=n(7),u=n(19),p=n(15),d=n(6),h=n(4),m=c.createFactory("input"),f={},g=l.createClass({displayName:"ReactDOMInput",tagName:"INPUT",mixins:[o,s.Mixin,a],getInitialState:function(){var e=this.props.defaultValue;return{initialChecked:this.props.defaultChecked||!1,initialValue:null!=e?e:null}},render:function(){var e=d({},this.props);e.defaultChecked=null,e.defaultValue=null;var t=s.getValue(this);e.value=null!=t?t:this.state.initialValue;var n=s.getChecked(this);return e.checked=null!=n?n:this.state.initialChecked,e.onChange=this._handleChange,m(e,this.props.children)},componentDidMount:function(){var e=u.getID(this.getDOMNode());f[e]=this},componentWillUnmount:function(){var e=this.getDOMNode(),t=u.getID(e);delete f[t]},componentDidUpdate:function(e,t,n){var r=this.getDOMNode();null!=this.props.checked&&i.setValueForProperty(r,"checked",this.props.checked||!1);var o=s.getValue(this);null!=o&&i.setValueForProperty(r,"value",""+o)},_handleChange:function(e){var t,n=s.getOnChange(this);n&&(t=n.call(this,e)),p.asap(r,this);var o=this.props.name;if("radio"===this.props.type&&null!=o){for(var i=this.getDOMNode(),a=i;a.parentNode;)a=a.parentNode;for(var l=a.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),c=0,d=l.length;d>c;c++){var m=l[c];if(m!==i&&m.form===i.form){var g=u.getID(m);h(g);var v=f[g];h(v),p.asap(r,v)}}}return t}});e.exports=g},function(e,t,n){"use strict";var r=n(17),o=n(13),i=n(7),s=(n(8),i.createFactory("option")),a=o.createClass({displayName:"ReactDOMOption",tagName:"OPTION",mixins:[r],componentWillMount:function(){},render:function(){return s(this.props,this.props.children)}});e.exports=a},function(e,t,n){"use strict";function r(){if(this._pendingUpdate){this._pendingUpdate=!1;var e=a.getValue(this);null!=e&&this.isMounted()&&i(this,e)}}function o(e,t,n){if(null==e[t])return null;if(e.multiple){if(!Array.isArray(e[t]))return new Error("The `"+t+"` prop supplied to <select> must be an array if `multiple` is true.")}else if(Array.isArray(e[t]))return new Error("The `"+t+"` prop supplied to <select> must be a scalar value if `multiple` is false.")}function i(e,t){var n,r,o,i=e.getDOMNode().options;if(e.props.multiple){for(n={},r=0,o=t.length;o>r;r++)n[""+t[r]]=!0;for(r=0,o=i.length;o>r;r++){var s=n.hasOwnProperty(i[r].value);i[r].selected!==s&&(i[r].selected=s)}}else{for(n=""+t,r=0,o=i.length;o>r;r++)if(i[r].value===n)return void(i[r].selected=!0);i.length&&(i[0].selected=!0)}}var s=n(44),a=n(64),l=n(17),c=n(13),u=n(7),p=n(15),d=n(6),h=u.createFactory("select"),m=c.createClass({displayName:"ReactDOMSelect",tagName:"SELECT",mixins:[s,a.Mixin,l],propTypes:{defaultValue:o,value:o},render:function(){var e=d({},this.props);return e.onChange=this._handleChange,e.value=null,h(e,this.props.children)},componentWillMount:function(){this._pendingUpdate=!1},componentDidMount:function(){var e=a.getValue(this);null!=e?i(this,e):null!=this.props.defaultValue&&i(this,this.props.defaultValue)},componentDidUpdate:function(e){var t=a.getValue(this);null!=t?(this._pendingUpdate=!1,i(this,t)):!e.multiple!=!this.props.multiple&&(null!=this.props.defaultValue?i(this,this.props.defaultValue):i(this,this.props.multiple?[]:""))},_handleChange:function(e){var t,n=a.getOnChange(this);return n&&(t=n.call(this,e)),this._pendingUpdate=!0,p.asap(r,this),t}});e.exports=m},function(e,t,n){"use strict";function r(e,t,n,r){return e===n&&t===r}function o(e){var t=document.selection,n=t.createRange(),r=n.text.length,o=n.duplicate();o.moveToElementText(e),o.setEndPoint("EndToStart",n);var i=o.text.length,s=i+r;return{start:i,end:s}}function i(e){var t=window.getSelection&&window.getSelection();if(!t||0===t.rangeCount)return null;var n=t.anchorNode,o=t.anchorOffset,i=t.focusNode,s=t.focusOffset,a=t.getRangeAt(0),l=r(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),c=l?0:a.toString().length,u=a.cloneRange();u.selectNodeContents(e),u.setEnd(a.startContainer,a.startOffset);var p=r(u.startContainer,u.startOffset,u.endContainer,u.endOffset),d=p?0:u.toString().length,h=d+c,m=document.createRange();m.setStart(n,o),m.setEnd(i,s);var f=m.collapsed;return{start:f?h:d,end:f?d:h}}function s(e,t){var n,r,o=document.selection.createRange().duplicate();"undefined"==typeof t.end?(n=t.start,r=n):t.start>t.end?(n=t.end,r=t.start):(n=t.start,r=t.end),o.moveToElementText(e),o.moveStart("character",n),o.setEndPoint("EndToStart",o),o.moveEnd("character",r-n),o.select()}function a(e,t){if(window.getSelection){var n=window.getSelection(),r=e[u()].length,o=Math.min(t.start,r),i="undefined"==typeof t.end?o:Math.min(t.end,r);if(!n.extend&&o>i){var s=i;i=o,o=s}var a=c(e,o),l=c(e,i);if(a&&l){var p=document.createRange();p.setStart(a.node,a.offset),n.removeAllRanges(),o>i?(n.addRange(p),n.extend(l.node,l.offset)):(p.setEnd(l.node,l.offset),n.addRange(p))}}}var l=n(9),c=n(309),u=n(117),p=l.canUseDOM&&"selection"in document&&!("getSelection"in window),d={getOffsets:p?o:i,setOffsets:p?s:a};e.exports=d},function(e,t,n){"use strict";function r(){this.isMounted()&&this.forceUpdate()}var o=n(44),i=n(34),s=n(64),a=n(17),l=n(13),c=n(7),u=n(15),p=n(6),d=n(4),h=(n(8),c.createFactory("textarea")),m=l.createClass({displayName:"ReactDOMTextarea",tagName:"TEXTAREA",mixins:[o,s.Mixin,a],getInitialState:function(){var e=this.props.defaultValue,t=this.props.children;null!=t&&(d(null==e),Array.isArray(t)&&(d(t.length<=1),t=t[0]),e=""+t),null==e&&(e="");var n=s.getValue(this);return{initialValue:""+(null!=n?n:e)}},render:function(){var e=p({},this.props);return d(null==e.dangerouslySetInnerHTML),e.defaultValue=null,e.value=null,e.onChange=this._handleChange,h(e,this.state.initialValue)},componentDidUpdate:function(e,t,n){var r=s.getValue(this);if(null!=r){var o=this.getDOMNode();i.setValueForProperty(o,"value",""+r)}},_handleChange:function(e){var t,n=s.getOnChange(this);return n&&(t=n.call(this,e)),u.asap(r,this),t}});e.exports=m},function(e,t,n){"use strict";function r(){this.reinitializeTransaction()}var o=n(15),i=n(49),s=n(6),a=n(21),l={initialize:a,close:function(){d.isBatchingUpdates=!1}},c={initialize:a,close:o.flushBatchedUpdates.bind(o)},u=[c,l];s(r.prototype,i.Mixin,{getTransactionWrappers:function(){return u}});var p=new r,d={isBatchingUpdates:!1,batchedUpdates:function(e,t,n,r,o){var i=d.isBatchingUpdates;d.isBatchingUpdates=!0,i?e(t,n,r,o):p.perform(e,null,t,n,r,o)}};e.exports=d},function(e,t,n){"use strict";function r(e){return m.createClass({tagName:e.toUpperCase(),render:function(){return new I(e,null,null,null,null,this.props)}})}function o(){M.EventEmitter.injectReactEventListener(k),M.EventPluginHub.injectEventPluginOrder(l),M.EventPluginHub.injectInstanceHandle(N),M.EventPluginHub.injectMount(D),M.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:O,EnterLeaveEventPlugin:c,ChangeEventPlugin:s,MobileSafariClickEventPlugin:d,SelectEventPlugin:P,BeforeInputEventPlugin:i}),M.NativeComponent.injectGenericComponentClass(v),M.NativeComponent.injectTextComponentClass(R),M.NativeComponent.injectAutoWrapper(r),M.Class.injectMixin(h),M.NativeComponent.injectComponentClasses({button:y,form:_,iframe:C,img:E,input:x,option:w,select:S,textarea:T,html:F("html"),head:F("head"),body:F("body")}),M.DOMProperty.injectDOMPropertyConfig(p),M.DOMProperty.injectDOMPropertyConfig(L),M.EmptyComponent.injectEmptyComponent("noscript"),M.Updates.injectReconcileTransaction(A),M.Updates.injectBatchingStrategy(g),M.RootIndex.injectCreateReactRootIndex(u.canUseDOM?a.createReactRootIndex:U.createReactRootIndex),M.Component.injectEnvironment(f),M.DOMComponent.injectIDOperations(b)}var i=n(251),s=n(252),a=n(253),l=n(256),c=n(257),u=n(9),p=n(260),d=n(261),h=n(17),m=n(13),f=n(66),g=n(276),v=n(69),y=n(267),_=n(268),E=n(270),b=n(102),C=n(269),x=n(271),w=n(272),S=n(273),T=n(275),R=n(103),I=n(7),k=n(280),M=n(281),N=n(29),D=n(19),A=n(284),P=n(289),U=n(290),O=n(291),L=n(288),F=n(304);e.exports={inject:o}},function(e,t){"use strict";var n={guard:function(e,t){return e}};e.exports=n},function(e,t,n){"use strict";function r(e){o.enqueueEvents(e),o.processEventQueue()}var o=n(35),i={handleTopLevel:function(e,t,n,i){var s=o.extractEvents(e,t,n,i);r(s)}};e.exports=i},function(e,t,n){"use strict";function r(e){var t=p.getID(e),n=u.getReactRootIDFromNodeID(t),r=p.findReactContainerForID(n),o=p.getFirstReactDOM(r);return o}function o(e,t){this.topLevelType=e,this.nativeEvent=t,this.ancestors=[]}function i(e){for(var t=p.getFirstReactDOM(m(e.nativeEvent))||window,n=t;n;)e.ancestors.push(n),n=r(n);for(var o=0,i=e.ancestors.length;i>o;o++){t=e.ancestors[o];var s=p.getID(t)||"";g._handleTopLevel(e.topLevelType,t,s,e.nativeEvent)}}function s(e){var t=f(window);e(t)}var a=n(258),l=n(9),c=n(16),u=n(29),p=n(19),d=n(15),h=n(6),m=n(78),f=n(311);h(o.prototype,{destructor:function(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0}}),c.addPoolingTo(o,c.twoArgumentPooler);var g={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:l.canUseDOM?window:null,setHandleTopLevel:function(e){g._handleTopLevel=e},setEnabled:function(e){g._enabled=!!e},isEnabled:function(){return g._enabled},trapBubbledEvent:function(e,t,n){var r=n;return r?a.listen(r,t,g.dispatchEvent.bind(null,e)):null},trapCapturedEvent:function(e,t,n){var r=n;return r?a.capture(r,t,g.dispatchEvent.bind(null,e)):null},monitorScrollValue:function(e){var t=s.bind(null,e);a.listen(window,"scroll",t)},dispatchEvent:function(e,t){if(g._enabled){var n=o.getPooled(e,t);try{d.batchedUpdates(i,n)}finally{o.release(n)}}}};e.exports=g},function(e,t,n){"use strict";var r=n(27),o=n(35),i=n(67),s=n(13),a=n(70),l=n(28),c=n(46),u=n(69),p=n(24),d=n(109),h=n(15),m={Component:i.injection,Class:s.injection,DOMComponent:u.injection,DOMProperty:r.injection,EmptyComponent:a.injection,EventPluginHub:o.injection,EventEmitter:l.injection,NativeComponent:c.injection,Perf:p.injection,RootIndex:d.injection,Updates:h.injection};e.exports=m},function(e,t,n){"use strict";function r(e,t,n){m.push({parentID:e,parentNode:null,type:u.INSERT_MARKUP,markupIndex:f.push(t)-1,textContent:null,fromIndex:null,toIndex:n})}function o(e,t,n){m.push({parentID:e,parentNode:null,type:u.MOVE_EXISTING,markupIndex:null,textContent:null,fromIndex:t,toIndex:n})}function i(e,t){m.push({parentID:e,parentNode:null,type:u.REMOVE_NODE,markupIndex:null,
textContent:null,fromIndex:t,toIndex:null})}function s(e,t){m.push({parentID:e,parentNode:null,type:u.TEXT_CONTENT,markupIndex:null,textContent:t,fromIndex:null,toIndex:null})}function a(){m.length&&(c.processChildrenUpdates(m,f),l())}function l(){m.length=0,f.length=0}var c=n(67),u=n(106),p=n(31),d=n(263),h=0,m=[],f=[],g={Mixin:{mountChildren:function(e,t,n){var r=d.instantiateChildren(e,t,n);this._renderedChildren=r;var o=[],i=0;for(var s in r)if(r.hasOwnProperty(s)){var a=r[s],l=this._rootNodeID+s,c=p.mountComponent(a,l,t,n);a._mountIndex=i,o.push(c),i++}return o},updateTextContent:function(e){h++;var t=!0;try{var n=this._renderedChildren;d.unmountChildren(n);for(var r in n)n.hasOwnProperty(r)&&this._unmountChildByName(n[r],r);this.setTextContent(e),t=!1}finally{h--,h||(t?l():a())}},updateChildren:function(e,t,n){h++;var r=!0;try{this._updateChildren(e,t,n),r=!1}finally{h--,h||(r?l():a())}},_updateChildren:function(e,t,n){var r=this._renderedChildren,o=d.updateChildren(r,e,t,n);if(this._renderedChildren=o,o||r){var i,s=0,a=0;for(i in o)if(o.hasOwnProperty(i)){var l=r&&r[i],c=o[i];l===c?(this.moveChild(l,a,s),s=Math.max(l._mountIndex,s),l._mountIndex=a):(l&&(s=Math.max(l._mountIndex,s),this._unmountChildByName(l,i)),this._mountChildByNameAtIndex(c,i,a,t,n)),a++}for(i in r)!r.hasOwnProperty(i)||o&&o.hasOwnProperty(i)||this._unmountChildByName(r[i],i)}},unmountChildren:function(){var e=this._renderedChildren;d.unmountChildren(e),this._renderedChildren=null},moveChild:function(e,t,n){e._mountIndex<n&&o(this._rootNodeID,e._mountIndex,t)},createChild:function(e,t){r(this._rootNodeID,t,e._mountIndex)},removeChild:function(e){i(this._rootNodeID,e._mountIndex)},setTextContent:function(e){s(this._rootNodeID,e)},_mountChildByNameAtIndex:function(e,t,n,r,o){var i=this._rootNodeID+t,s=p.mountComponent(e,i,r,o);e._mountIndex=n,this.createChild(e,s)},_unmountChildByName:function(e,t){this.removeChild(e),e._mountIndex=null}}};e.exports=g},function(e,t,n){"use strict";var r=n(4),o={isValidOwner:function(e){return!(!e||"function"!=typeof e.attachRef||"function"!=typeof e.detachRef)},addComponentAsRefTo:function(e,t,n){r(o.isValidOwner(n)),n.attachRef(t,e)},removeComponentAsRefFrom:function(e,t,n){r(o.isValidOwner(n)),n.getPublicInstance().refs[t]===e.getPublicInstance()&&n.detachRef(t)}};e.exports=o},function(e,t,n){"use strict";function r(){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=o.getPooled(null),this.putListenerQueue=l.getPooled()}var o=n(62),i=n(16),s=n(28),a=n(104),l=n(108),c=n(49),u=n(6),p={initialize:a.getSelectionInformation,close:a.restoreSelection},d={initialize:function(){var e=s.isEnabled();return s.setEnabled(!1),e},close:function(e){s.setEnabled(e)}},h={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},m={initialize:function(){this.putListenerQueue.reset()},close:function(){this.putListenerQueue.putListeners()}},f=[m,p,d,h],g={getTransactionWrappers:function(){return f},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){o.release(this.reactMountReady),this.reactMountReady=null,l.release(this.putListenerQueue),this.putListenerQueue=null}};u(r.prototype,c.Mixin,g),i.addPoolingTo(r),e.exports=r},function(e,t,n){"use strict";function r(e,t,n){"function"==typeof e?e(t.getPublicInstance()):i.addComponentAsRefTo(t,e,n)}function o(e,t,n){"function"==typeof e?e(null):i.removeComponentAsRefFrom(t,e,n)}var i=n(283),s={};s.attachRefs=function(e,t){var n=t.ref;null!=n&&r(n,e,t._owner)},s.shouldUpdateRefs=function(e,t){return t._owner!==e._owner||t.ref!==e.ref},s.detachRefs=function(e,t){var n=t.ref;null!=n&&o(n,e,t._owner)},e.exports=s},function(e,t,n){"use strict";function r(e){p(i.isValidElement(e));var t;try{var n=s.createReactRootID();return t=l.getPooled(!1),t.perform(function(){var r=u(e,null),o=r.mountComponent(n,t,c);return a.addChecksumToMarkup(o)},null)}finally{l.release(t)}}function o(e){p(i.isValidElement(e));var t;try{var n=s.createReactRootID();return t=l.getPooled(!0),t.perform(function(){var r=u(e,null);return r.mountComponent(n,t,c)},null)}finally{l.release(t)}}var i=n(7),s=n(29),a=n(105),l=n(287),c=n(50),u=n(79),p=n(4);e.exports={renderToString:r,renderToStaticMarkup:o}},function(e,t,n){"use strict";function r(e){this.reinitializeTransaction(),this.renderToStaticMarkup=e,this.reactMountReady=i.getPooled(null),this.putListenerQueue=s.getPooled()}var o=n(16),i=n(62),s=n(108),a=n(49),l=n(6),c=n(21),u={initialize:function(){this.reactMountReady.reset()},close:c},p={initialize:function(){this.putListenerQueue.reset()},close:c},d=[p,u],h={getTransactionWrappers:function(){return d},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){i.release(this.reactMountReady),this.reactMountReady=null,s.release(this.putListenerQueue),this.putListenerQueue=null}};l(r.prototype,a.Mixin,h),o.addPoolingTo(r),e.exports=r},function(e,t,n){"use strict";var r=n(27),o=r.injection.MUST_USE_ATTRIBUTE,i={Properties:{clipPath:o,cx:o,cy:o,d:o,dx:o,dy:o,fill:o,fillOpacity:o,fontFamily:o,fontSize:o,fx:o,fy:o,gradientTransform:o,gradientUnits:o,markerEnd:o,markerMid:o,markerStart:o,offset:o,opacity:o,patternContentUnits:o,patternUnits:o,points:o,preserveAspectRatio:o,r:o,rx:o,ry:o,spreadMethod:o,stopColor:o,stopOpacity:o,stroke:o,strokeDasharray:o,strokeLinecap:o,strokeOpacity:o,strokeWidth:o,textAnchor:o,transform:o,version:o,viewBox:o,x1:o,x2:o,x:o,y1:o,y2:o,y:o},DOMAttributeNames:{clipPath:"clip-path",fillOpacity:"fill-opacity",fontFamily:"font-family",fontSize:"font-size",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",patternContentUnits:"patternContentUnits",patternUnits:"patternUnits",preserveAspectRatio:"preserveAspectRatio",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeDasharray:"stroke-dasharray",strokeLinecap:"stroke-linecap",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox"}};e.exports=i},function(e,t,n){"use strict";function r(e){if("selectionStart"in e&&a.hasSelectionCapabilities(e))return{start:e.selectionStart,end:e.selectionEnd};if(window.getSelection){var t=window.getSelection();return{anchorNode:t.anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset}}if(document.selection){var n=document.selection.createRange();return{parentElement:n.parentElement(),text:n.text,top:n.boundingTop,left:n.boundingLeft}}}function o(e){if(y||null==f||f!==c())return null;var t=r(f);if(!v||!d(v,t)){v=t;var n=l.getPooled(m.select,g,e);return n.type="select",n.target=f,s.accumulateTwoPhaseDispatches(n),n}}var i=n(12),s=n(36),a=n(104),l=n(25),c=n(114),u=n(119),p=n(22),d=n(320),h=i.topLevelTypes,m={select:{phasedRegistrationNames:{bubbled:p({onSelect:null}),captured:p({onSelectCapture:null})},dependencies:[h.topBlur,h.topContextMenu,h.topFocus,h.topKeyDown,h.topMouseDown,h.topMouseUp,h.topSelectionChange]}},f=null,g=null,v=null,y=!1,_={eventTypes:m,extractEvents:function(e,t,n,r){switch(e){case h.topFocus:(u(t)||"true"===t.contentEditable)&&(f=t,g=n,v=null);break;case h.topBlur:f=null,g=null,v=null;break;case h.topMouseDown:y=!0;break;case h.topContextMenu:case h.topMouseUp:return y=!1,o(r);case h.topSelectionChange:case h.topKeyDown:case h.topKeyUp:return o(r)}}};e.exports=_},function(e,t){"use strict";var n=Math.pow(2,53),r={createReactRootIndex:function(){return Math.ceil(Math.random()*n)}};e.exports=r},function(e,t,n){"use strict";var r=n(12),o=n(63),i=n(36),s=n(292),a=n(25),l=n(295),c=n(297),u=n(48),p=n(294),d=n(298),h=n(38),m=n(299),f=n(76),g=n(4),v=n(22),y=(n(8),r.topLevelTypes),_={blur:{phasedRegistrationNames:{bubbled:v({onBlur:!0}),captured:v({onBlurCapture:!0})}},click:{phasedRegistrationNames:{bubbled:v({onClick:!0}),captured:v({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:v({onContextMenu:!0}),captured:v({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:v({onCopy:!0}),captured:v({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:v({onCut:!0}),captured:v({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:v({onDoubleClick:!0}),captured:v({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:v({onDrag:!0}),captured:v({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:v({onDragEnd:!0}),captured:v({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:v({onDragEnter:!0}),captured:v({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:v({onDragExit:!0}),captured:v({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:v({onDragLeave:!0}),captured:v({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:v({onDragOver:!0}),captured:v({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:v({onDragStart:!0}),captured:v({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:v({onDrop:!0}),captured:v({onDropCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:v({onFocus:!0}),captured:v({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:v({onInput:!0}),captured:v({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:v({onKeyDown:!0}),captured:v({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:v({onKeyPress:!0}),captured:v({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:v({onKeyUp:!0}),captured:v({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:v({onLoad:!0}),captured:v({onLoadCapture:!0})}},error:{phasedRegistrationNames:{bubbled:v({onError:!0}),captured:v({onErrorCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:v({onMouseDown:!0}),captured:v({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:v({onMouseMove:!0}),captured:v({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:v({onMouseOut:!0}),captured:v({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:v({onMouseOver:!0}),captured:v({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:v({onMouseUp:!0}),captured:v({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:v({onPaste:!0}),captured:v({onPasteCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:v({onReset:!0}),captured:v({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:v({onScroll:!0}),captured:v({onScrollCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:v({onSubmit:!0}),captured:v({onSubmitCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:v({onTouchCancel:!0}),captured:v({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:v({onTouchEnd:!0}),captured:v({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:v({onTouchMove:!0}),captured:v({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:v({onTouchStart:!0}),captured:v({onTouchStartCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:v({onWheel:!0}),captured:v({onWheelCapture:!0})}}},E={topBlur:_.blur,topClick:_.click,topContextMenu:_.contextMenu,topCopy:_.copy,topCut:_.cut,topDoubleClick:_.doubleClick,topDrag:_.drag,topDragEnd:_.dragEnd,topDragEnter:_.dragEnter,topDragExit:_.dragExit,topDragLeave:_.dragLeave,topDragOver:_.dragOver,topDragStart:_.dragStart,topDrop:_.drop,topError:_.error,topFocus:_.focus,topInput:_.input,topKeyDown:_.keyDown,topKeyPress:_.keyPress,topKeyUp:_.keyUp,topLoad:_.load,topMouseDown:_.mouseDown,topMouseMove:_.mouseMove,topMouseOut:_.mouseOut,topMouseOver:_.mouseOver,topMouseUp:_.mouseUp,topPaste:_.paste,topReset:_.reset,topScroll:_.scroll,topSubmit:_.submit,topTouchCancel:_.touchCancel,topTouchEnd:_.touchEnd,topTouchMove:_.touchMove,topTouchStart:_.touchStart,topWheel:_.wheel};for(var b in E)E[b].dependencies=[b];var C={eventTypes:_,executeDispatch:function(e,t,n){var r=o.executeDispatch(e,t,n);r===!1&&(e.stopPropagation(),e.preventDefault())},extractEvents:function(e,t,n,r){var o=E[e];if(!o)return null;var v;switch(e){case y.topInput:case y.topLoad:case y.topError:case y.topReset:case y.topSubmit:v=a;break;case y.topKeyPress:if(0===f(r))return null;case y.topKeyDown:case y.topKeyUp:v=c;break;case y.topBlur:case y.topFocus:v=l;break;case y.topClick:if(2===r.button)return null;case y.topContextMenu:case y.topDoubleClick:case y.topMouseDown:case y.topMouseMove:case y.topMouseOut:case y.topMouseOver:case y.topMouseUp:v=u;break;case y.topDrag:case y.topDragEnd:case y.topDragEnter:case y.topDragExit:case y.topDragLeave:case y.topDragOver:case y.topDragStart:case y.topDrop:v=p;break;case y.topTouchCancel:case y.topTouchEnd:case y.topTouchMove:case y.topTouchStart:v=d;break;case y.topScroll:v=h;break;case y.topWheel:v=m;break;case y.topCopy:case y.topCut:case y.topPaste:v=s}g(v);var _=v.getPooled(o,n,r);return i.accumulateTwoPhaseDispatches(_),_}};e.exports=C},function(e,t,n){"use strict";function r(e,t,n){o.call(this,e,t,n)}var o=n(25),i={clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}};o.augmentClass(r,i),e.exports=r},function(e,t,n){"use strict";function r(e,t,n){o.call(this,e,t,n)}var o=n(25),i={data:null};o.augmentClass(r,i),e.exports=r},function(e,t,n){"use strict";function r(e,t,n){o.call(this,e,t,n)}var o=n(48),i={dataTransfer:null};o.augmentClass(r,i),e.exports=r},function(e,t,n){"use strict";function r(e,t,n){o.call(this,e,t,n)}var o=n(38),i={relatedTarget:null};o.augmentClass(r,i),e.exports=r},function(e,t,n){"use strict";function r(e,t,n){o.call(this,e,t,n)}var o=n(25),i={data:null};o.augmentClass(r,i),e.exports=r},function(e,t,n){"use strict";function r(e,t,n){o.call(this,e,t,n)}var o=n(38),i=n(76),s=n(308),a=n(77),l={key:s,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:a,charCode:function(e){return"keypress"===e.type?i(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?i(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}};o.augmentClass(r,l),e.exports=r},function(e,t,n){"use strict";function r(e,t,n){o.call(this,e,t,n)}var o=n(38),i=n(77),s={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:i};o.augmentClass(r,s),e.exports=r},function(e,t,n){"use strict";function r(e,t,n){o.call(this,e,t,n)}var o=n(48),i={deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null};o.augmentClass(r,i),e.exports=r},function(e,t){"use strict";function n(e){for(var t=1,n=0,o=0;o<e.length;o++)t=(t+e.charCodeAt(o))%r,n=(n+t)%r;return t|n<<16}var r=65521;e.exports=n},function(e,t){function n(e){return e.replace(r,function(e,t){return t.toUpperCase()})}var r=/-(.)/g;e.exports=n},function(e,t,n){"use strict";function r(e){return o(e.replace(i,"ms-"))}var o=n(301),i=/^-ms-/;e.exports=r},function(e,t,n){function r(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(Array.isArray(e)||"callee"in e||"item"in e)}function o(e){return r(e)?Array.isArray(e)?e.slice():i(e):[e]}var i=n(321);e.exports=o},function(e,t,n){"use strict";function r(e){var t=i.createFactory(e),n=o.createClass({tagName:e.toUpperCase(),displayName:"ReactFullPageComponent"+e,componentWillUnmount:function(){s(!1)},render:function(){return t(this.props)}});return n}var o=n(13),i=n(7),s=n(4);e.exports=r},function(e,t,n){function r(e){var t=e.match(u);return t&&t[1].toLowerCase()}function o(e,t){var n=c;l(!!c);var o=r(e),i=o&&a(o);if(i){n.innerHTML=i[1]+e+i[2];for(var u=i[0];u--;)n=n.lastChild}else n.innerHTML=e;var p=n.getElementsByTagName("script");p.length&&(l(t),s(p).forEach(t));for(var d=s(n.childNodes);n.lastChild;)n.removeChild(n.lastChild);return d}var i=n(9),s=n(303),a=n(116),l=n(4),c=i.canUseDOM?document.createElement("div"):null,u=/^\s*<(\w+)/;e.exports=o},function(e,t,n){"use strict";function r(e,t){var n=null==t||"boolean"==typeof t||""===t;if(n)return"";var r=isNaN(t);return r||0===t||i.hasOwnProperty(e)&&i[e]?""+t:("string"==typeof t&&(t=t.trim()),t+"px")}var o=n(98),i=o.isUnitlessNumber;e.exports=r},function(e,t,n){"use strict";function r(e,t,n){var r=e,o=!r.hasOwnProperty(n);o&&null!=t&&(r[n]=t)}function o(e){if(null==e)return e;var t={};return i(e,r,t),t}var i=n(120);n(8);e.exports=o},function(e,t,n){"use strict";function r(e){if(e.key){var t=i[e.key]||e.key;if("Unidentified"!==t)return t}if("keypress"===e.type){var n=o(e);return 13===n?"Enter":String.fromCharCode(n)}return"keydown"===e.type||"keyup"===e.type?s[e.keyCode]||"Unidentified":""}var o=n(76),i={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},s={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};e.exports=r},function(e,t){"use strict";function n(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function r(e){for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function o(e,t){for(var o=n(e),i=0,s=0;o;){if(3===o.nodeType){if(s=i+o.textContent.length,t>=i&&s>=t)return{node:o,offset:t-i};i=s}o=n(r(o))}}e.exports=o},function(e,t){"use strict";function n(e){return e?e.nodeType===r?e.documentElement:e.firstChild:null}var r=9;e.exports=n},function(e,t){"use strict";function n(e){return e===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop}}e.exports=n},function(e,t){function n(e){return e.replace(r,"-$1").toLowerCase()}var r=/([A-Z])/g;e.exports=n},function(e,t,n){"use strict";function r(e){return o(e).replace(i,"-ms-")}var o=n(312),i=/^ms-/;e.exports=r},function(e,t,n){function r(e){return o(e)&&3==e.nodeType}var o=n(118);e.exports=r},function(e,t){"use strict";function n(e,t,n){if(!e)return null;var o={};for(var i in e)r.call(e,i)&&(o[i]=t.call(n,e[i],i,e));return o}var r=Object.prototype.hasOwnProperty;e.exports=n},function(e,t){"use strict";function n(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}e.exports=n},function(e,t,n){"use strict";function r(e){return i(o.isValidElement(e)),e}var o=n(7),i=n(4);e.exports=r},function(e,t,n){"use strict";function r(e){return'"'+o(e)+'"'}var o=n(51);e.exports=r},function(e,t,n){"use strict";var r=n(9),o=n(51),i=n(81),s=function(e,t){e.textContent=t};r.canUseDOM&&("textContent"in document.documentElement||(s=function(e,t){i(e,o(t))})),e.exports=s},function(e,t){"use strict";function n(e,t){if(e===t)return!0;var n;for(n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||e[n]!==t[n]))return!1;for(n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}e.exports=n},function(e,t,n){function r(e){var t=e.length;if(o(!Array.isArray(e)&&("object"==typeof e||"function"==typeof e)),o("number"==typeof t),o(0===t||t-1 in e),e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(n){}for(var r=Array(t),i=0;t>i;i++)r[i]=e[i];return r}var o=n(4);e.exports=r},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===s||t===p?62:t===a||t===d?63:l>t?-1:l+10>t?t-l+26+26:u+26>t?t-u:c+26>t?t-c+26:void 0}function n(e){function n(e){c[p++]=e}var r,o,s,a,l,c;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=e.length;l="="===e.charAt(u-2)?2:"="===e.charAt(u-1)?1:0,c=new i(3*e.length/4-l),s=l>0?e.length-4:e.length;var p=0;for(r=0,o=0;s>r;r+=4,o+=3)a=t(e.charAt(r))<<18|t(e.charAt(r+1))<<12|t(e.charAt(r+2))<<6|t(e.charAt(r+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===l?(a=t(e.charAt(r))<<2|t(e.charAt(r+1))>>4,n(255&a)):1===l&&(a=t(e.charAt(r))<<10|t(e.charAt(r+1))<<4|t(e.charAt(r+2))>>2,n(a>>8&255),n(255&a)),c}function o(e){function t(e){return r.charAt(e)}function n(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var o,i,s,a=e.length%3,l="";for(o=0,s=e.length-a;s>o;o+=3)i=(e[o]<<16)+(e[o+1]<<8)+e[o+2],l+=n(i);switch(a){case 1:i=e[e.length-1],l+=t(i>>2),l+=t(i<<4&63),l+="==";break;case 2:i=(e[e.length-2]<<8)+e[e.length-1],l+=t(i>>10),l+=t(i>>4&63),l+=t(i<<2&63),l+="="}return l}var i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),l="0".charCodeAt(0),c="a".charCodeAt(0),u="A".charCodeAt(0),p="-".charCodeAt(0),d="_".charCodeAt(0);e.toByteArray=n,e.fromByteArray=o}(t)},function(e,t){t.read=function(e,t,n,r,o){var i,s,a=8*o-r-1,l=(1<<a)-1,c=l>>1,u=-7,p=n?o-1:0,d=n?-1:1,h=e[t+p];for(p+=d,i=h&(1<<-u)-1,h>>=-u,u+=a;u>0;i=256*i+e[t+p],p+=d,u-=8);for(s=i&(1<<-u)-1,i>>=-u,u+=r;u>0;s=256*s+e[t+p],p+=d,u-=8);if(0===i)i=1-c;else{if(i===l)return s?NaN:(h?-1:1)*(1/0);s+=Math.pow(2,r),i-=c}return(h?-1:1)*s*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var s,a,l,c=8*i-o-1,u=(1<<c)-1,p=u>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,m=r?1:-1,f=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),t+=s+p>=1?d/l:d*Math.pow(2,1-p),t*l>=2&&(s++,l/=2),s+p>=u?(a=0,s=u):s+p>=1?(a=(t*l-1)*Math.pow(2,o),s+=p):(a=t*Math.pow(2,p-1)*Math.pow(2,o),s=0));o>=8;e[n+h]=255&a,h+=m,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;e[n+h]=255&s,h+=m,s/=256,c-=8);e[n+h-m]|=128*f}},function(e,t){var n=Array.isArray,r=Object.prototype.toString;e.exports=n||function(e){return!!e&&"[object Array]"==r.call(e)}},function(e,t,n){var r;(function(e,o){!function(i){function s(e){throw RangeError(D[e])}function a(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function l(e,t){var n=e.split("@"),r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(N,".");var o=e.split("."),i=a(o,t).join(".");return r+i}function c(e){for(var t,n,r=[],o=0,i=e.length;i>o;)t=e.charCodeAt(o++),t>=55296&&56319>=t&&i>o?(n=e.charCodeAt(o++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--)):r.push(t);return r}function u(e){return a(e,function(e){var t="";return e>65535&&(e-=65536,t+=U(e>>>10&1023|55296),e=56320|1023&e),t+=U(e)}).join("")}function p(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:b}function d(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function h(e,t,n){var r=0;for(e=n?P(e/S):e>>1,e+=P(e/t);e>A*x>>1;r+=b)e=P(e/A);return P(r+(A+1)*e/(e+w))}function m(e){var t,n,r,o,i,a,l,c,d,m,f=[],g=e.length,v=0,y=R,_=T;for(n=e.lastIndexOf(I),0>n&&(n=0),r=0;n>r;++r)e.charCodeAt(r)>=128&&s("not-basic"),f.push(e.charCodeAt(r));for(o=n>0?n+1:0;g>o;){for(i=v,a=1,l=b;o>=g&&s("invalid-input"),c=p(e.charCodeAt(o++)),(c>=b||c>P((E-v)/a))&&s("overflow"),v+=c*a,d=_>=l?C:l>=_+x?x:l-_,!(d>c);l+=b)m=b-d,a>P(E/m)&&s("overflow"),a*=m;t=f.length+1,_=h(v-i,t,0==i),P(v/t)>E-y&&s("overflow"),y+=P(v/t),v%=t,f.splice(v++,0,y)}return u(f)}function f(e){var t,n,r,o,i,a,l,u,p,m,f,g,v,y,_,w=[];for(e=c(e),g=e.length,t=R,n=0,i=T,a=0;g>a;++a)f=e[a],128>f&&w.push(U(f));for(r=o=w.length,o&&w.push(I);g>r;){for(l=E,a=0;g>a;++a)f=e[a],f>=t&&l>f&&(l=f);for(v=r+1,l-t>P((E-n)/v)&&s("overflow"),n+=(l-t)*v,t=l,a=0;g>a;++a)if(f=e[a],t>f&&++n>E&&s("overflow"),f==t){for(u=n,p=b;m=i>=p?C:p>=i+x?x:p-i,!(m>u);p+=b)_=u-m,y=b-m,w.push(U(d(m+_%y,0))),u=P(_/y);w.push(U(d(u,0))),i=h(n,v,r==o),n=0,++r}++n,++t}return w.join("")}function g(e){return l(e,function(e){return k.test(e)?m(e.slice(4).toLowerCase()):e})}function v(e){return l(e,function(e){return M.test(e)?"xn--"+f(e):e})}var y=("object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof o&&o);(y.global===y||y.window===y||y.self===y)&&(i=y);var _,E=2147483647,b=36,C=1,x=26,w=38,S=700,T=72,R=128,I="-",k=/^xn--/,M=/[^\x20-\x7E]/,N=/[\x2E\u3002\uFF0E\uFF61]/g,D={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=b-C,P=Math.floor,U=String.fromCharCode;_={version:"1.3.2",ucs2:{decode:c,encode:u},decode:m,encode:f,toASCII:v,toUnicode:g},r=function(){return _}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}(this)}).call(t,n(322)(e),function(){return this}())},function(e,t){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,o,i){t=t||"&",o=o||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var l=1e3;i&&"number"==typeof i.maxKeys&&(l=i.maxKeys);var c=e.length;l>0&&c>l&&(c=l);for(var u=0;c>u;++u){var p,d,h,m,f=e[u].replace(a,"%20"),g=f.indexOf(o);g>=0?(p=f.substr(0,g),d=f.substr(g+1)):(p=f,d=""),h=decodeURIComponent(p),m=decodeURIComponent(d),n(s,h)?r(s[h])?s[h].push(m):s[h]=[s[h],m]:s[h]=m}return s};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t){"use strict";function n(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,s,a){return t=t||"&",s=s||"=",null===e&&(e=void 0),"object"==typeof e?n(i(e),function(i){var a=encodeURIComponent(r(i))+s;return o(e[i])?n(e[i],function(e){return a+encodeURIComponent(r(e))}).join(t):a+encodeURIComponent(r(e[i]))}).join(t):a?encodeURIComponent(r(a))+s+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";t.decode=t.parse=n(327),t.encode=t.stringify=n(328)},function(e,t){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var s=/\+/g;e=e.split(t);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var l=e.length;a>0&&l>a&&(l=a);for(var c=0;l>c;++c){var u,p,d,h,m=e[c].replace(s,"%20"),f=m.indexOf(r);f>=0?(u=m.substr(0,f),p=m.substr(f+1)):(u=m,p=""),d=decodeURIComponent(u),h=decodeURIComponent(p),n(i,d)?Array.isArray(i[d])?i[d].push(h):i[d]=[i[d],h]:i[d]=h}return i}},function(e,t){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,o){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(o){var i=encodeURIComponent(n(o))+r;return Array.isArray(e[o])?e[o].map(function(e){return i+encodeURIComponent(n(e))}).join(t):i+encodeURIComponent(n(e[o]))}).join(t):o?encodeURIComponent(n(o))+r+encodeURIComponent(n(e)):""}},function(e,t,n){"use strict";t.decode=t.parse=n(330),t.encode=t.stringify=n(331)},function(e,t,n){function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(e,t,n){if(e&&c(e)&&e instanceof r)return e;var o=new r;return o.parse(e,t,n),o}function i(e){return l(e)&&(e=o(e)),e instanceof r?e.format():r.prototype.format.call(e)}function s(e,t){return o(e,!1,!0).resolve(t)}function a(e,t){return e?o(e,!1,!0).resolveObject(t):t}function l(e){return"string"==typeof e}function c(e){return"object"==typeof e&&null!==e}function u(e){return null===e}function p(e){return null==e}var d=n(326);t.parse=o,t.resolve=s,t.resolveObject=a,t.format=i,t.Url=r;var h=/^([a-z0-9.+-]+:)/i,m=/:[0-9]*$/,f=["<",">",'"',"`"," ","\r","\n","	"],g=["{","}","|","\\","^","`"].concat(f),v=["'"].concat(g),y=["%","/","?",";","#"].concat(v),_=["/","?","#"],E=255,b=/^[a-z0-9A-Z_-]{0,63}$/,C=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},w={javascript:!0,"javascript:":!0},S={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},T=n(332);r.prototype.parse=function(e,t,n){if(!l(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e;r=r.trim();var o=h.exec(r);if(o){o=o[0];var i=o.toLowerCase();this.protocol=i,r=r.substr(o.length)}if(n||o||r.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===r.substr(0,2);!s||o&&w[o]||(r=r.substr(2),this.slashes=!0)}if(!w[o]&&(s||o&&!S[o])){for(var a=-1,c=0;c<_.length;c++){var u=r.indexOf(_[c]);-1!==u&&(-1===a||a>u)&&(a=u)}var p,m;m=-1===a?r.lastIndexOf("@"):r.lastIndexOf("@",a),-1!==m&&(p=r.slice(0,m),r=r.slice(m+1),this.auth=decodeURIComponent(p)),a=-1;for(var c=0;c<y.length;c++){var u=r.indexOf(y[c]);-1!==u&&(-1===a||a>u)&&(a=u)}-1===a&&(a=r.length),this.host=r.slice(0,a),r=r.slice(a),this.parseHost(),this.hostname=this.hostname||"";var f="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!f)for(var g=this.hostname.split(/\./),c=0,R=g.length;R>c;c++){var I=g[c];if(I&&!I.match(b)){for(var k="",M=0,N=I.length;N>M;M++)k+=I.charCodeAt(M)>127?"x":I[M];if(!k.match(b)){var D=g.slice(0,c),A=g.slice(c+1),P=I.match(C);P&&(D.push(P[1]),A.unshift(P[2])),A.length&&(r="/"+A.join(".")+r),this.hostname=D.join(".");break}}}if(this.hostname.length>E?this.hostname="":this.hostname=this.hostname.toLowerCase(),!f){for(var U=this.hostname.split("."),O=[],c=0;c<U.length;++c){var L=U[c];O.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+d.encode(L):L)}this.hostname=O.join(".")}var F=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+F,this.href+=this.host,f&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==r[0]&&(r="/"+r))}if(!x[i])for(var c=0,R=v.length;R>c;c++){var V=v[c],j=encodeURIComponent(V);j===V&&(j=escape(V)),r=r.split(V).join(j)}var H=r.indexOf("#");-1!==H&&(this.hash=r.substr(H),r=r.slice(0,H));var W=r.indexOf("?");if(-1!==W?(this.search=r.substr(W),this.query=r.substr(W+1),t&&(this.query=T.parse(this.query)),r=r.slice(0,W)):t&&(this.search="",this.query={}),r&&(this.pathname=r),S[i]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",L=this.search||"";this.path=F+L}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&c(this.query)&&Object.keys(this.query).length&&(i=T.stringify(this.query));var s=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||S[t])&&o!==!1?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+o+n+s+r},r.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(l(e)){var t=new r;t.parse(e,!1,!0),e=t}var n=new r;if(Object.keys(this).forEach(function(e){n[e]=this[e]},this),n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){
"protocol"!==t&&(n[t]=e[t])}),S[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(e.protocol&&e.protocol!==n.protocol){if(!S[e.protocol])return Object.keys(e).forEach(function(t){n[t]=e[t]}),n.href=n.format(),n;if(n.protocol=e.protocol,e.host||w[e.protocol])n.pathname=e.pathname;else{for(var o=(e.pathname||"").split("/");o.length&&!(e.host=o.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),n.pathname=o.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var i=n.pathname||"",s=n.search||"";n.path=i+s}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var a=n.pathname&&"/"===n.pathname.charAt(0),c=e.host||e.pathname&&"/"===e.pathname.charAt(0),d=c||a||n.host&&e.pathname,h=d,m=n.pathname&&n.pathname.split("/")||[],o=e.pathname&&e.pathname.split("/")||[],f=n.protocol&&!S[n.protocol];if(f&&(n.hostname="",n.port=null,n.host&&(""===m[0]?m[0]=n.host:m.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===o[0]?o[0]=e.host:o.unshift(e.host)),e.host=null),d=d&&(""===o[0]||""===m[0])),c)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,m=o;else if(o.length)m||(m=[]),m.pop(),m=m.concat(o),n.search=e.search,n.query=e.query;else if(!p(e.search)){if(f){n.hostname=n.host=m.shift();var g=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;g&&(n.auth=g.shift(),n.host=n.hostname=g.shift())}return n.search=e.search,n.query=e.query,u(n.pathname)&&u(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!m.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var v=m.slice(-1)[0],y=(n.host||e.host)&&("."===v||".."===v)||""===v,_=0,E=m.length;E>=0;E--)v=m[E],"."==v?m.splice(E,1):".."===v?(m.splice(E,1),_++):_&&(m.splice(E,1),_--);if(!d&&!h)for(;_--;_)m.unshift("..");!d||""===m[0]||m[0]&&"/"===m[0].charAt(0)||m.unshift(""),y&&"/"!==m.join("/").substr(-1)&&m.push("");var b=""===m[0]||m[0]&&"/"===m[0].charAt(0);if(f){n.hostname=n.host=b?"":m.length?m.shift():"";var g=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;g&&(n.auth=g.shift(),n.host=n.hostname=g.shift())}return d=d||n.host&&m.length,d&&!b&&m.unshift(""),m.length?n.pathname=m.join("/"):(n.pathname=null,n.path=null),u(n.pathname)&&u(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=m.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}}]);
//# sourceMappingURL=bundle.js.map